##Univariate Analysis - Tentative Prognostic Transcripts

#Written By: Jarrett Eshima
#For: Dr. Barbara Smith Lab
#Date: September 27th 2021

library(ggplot2)

#Read in Top 1000 All Combined (Classifier Matrix)
wd = "C:/Users/jeshima/Documents/Smith Lab/Summer 2021/ALS Subtyping/Prognostic Biomarkers"
setwd(wd)

PrognosticBM = read.csv("Supervised_Classifier_CombinedPlatform_All_1000.csv")
rownames(PrognosticBM) = PrognosticBM[,1]
PrognosticBM = PrognosticBM[,-1]

##Get feature names from classifier matrix
Transcripts = rownames(PrognosticBM)
Transcripts = c(Transcripts,"TARDBP","TXN","OXR1","UBQLN1","UBQLN2","BECN1","BECN2") #Add a few genes previously associated with ALS
#Many of the added transcripts were considered during unsupervised clustering (MAD10k) but fell below the "Top 1000" genes threshold for supervised classification
###############################################################################################################################

##Read in files

#Read in raw count values for NovaSeq and HiSeq cohorts - generated by Differential Expression R Code
HiSeqCounts = read.csv("HiSeq_RawCounts_ENSG_ALS451.csv")
rownames(HiSeqCounts) = HiSeqCounts[,1]
HiSeqCounts = HiSeqCounts[,-1]

NovaSeqCounts = read.csv("NovaSeq_RawCounts_ENSG_ALS451.csv")
rownames(NovaSeqCounts) = NovaSeqCounts[,1]
NovaSeqCounts = NovaSeqCounts[,-1]

ControlCounts = read.csv("Control_RawCounts_ENSG.csv") #File generated in Control DESeq2 script
rownames(ControlCounts) = ControlCounts[,1]
ControlCounts = ControlCounts[,-1]

###############################################################################################################################

#Convert ENSMBL ID to Gene Symbol for the classifier feature set
setwd('D:/Jarrett/Research/Fall 2020/ALS/GSE153960')
first = read.table(gzfile("GSE153960_Gene_counts_matrix_RSEM_Prudencio_et_al_2020.txt.gz"),sep="\t")
dim(first)

GSE15_RawCounts = first
rownames(GSE15_RawCounts) = first[,1]
GSE15_RawCounts = GSE15_RawCounts[,-1]

ensembl.genes = rownames(GSE15_RawCounts)
newEG = sub("\\..*","",ensembl.genes) #Keep text to the left of the dot

ensembl_version = "https://dec2016.archive.ensembl.org"
species="human"
ensembl = biomaRt::useMart(biomart = "ENSEMBL_MART_ENSEMBL", dataset = "hsapiens_gene_ensembl", host=ensembl_version)
gene_positions <- biomaRt::getBM(filters = 'ensembl_gene_id',attributes=c('ensembl_gene_id','hgnc_symbol'), values = newEG, mart = ensembl)

#Lookup table for gene symbols used in the supervised classifiers
prog_gene_positions = gene_positions[gene_positions$hgnc_symbol %in% Transcripts,]

#Which symbols are missing?
test = Transcripts[! Transcripts %in% gene_positions$hgnc_symbol] #Only the ENSEMBL IDs and TEs are not included

###################################### Convert HiSeq ENSG

#This only takes 10-20 minutes
blank = rep(NA,nrow(HiSeqCounts))
HiSeqCounts2 = cbind(blank,HiSeqCounts)
HiSeqCounts2[,1] = rownames(HiSeqCounts)

DONE = F
for(i in 1:nrow(HiSeqCounts2)){
  for(j in 1:nrow(prog_gene_positions)){
    if(DONE == F){
      if(sub("\\..*","",HiSeqCounts2[i,1]) == prog_gene_positions$ensembl_gene_id[j]){
        HiSeqCounts2[i,1] = prog_gene_positions$hgnc_symbol[j]
        DONE = T
      }
    }
  }
  DONE = F
  if((i %% 500) == 0) cat("% Done:",i/nrow(HiSeqCounts2)*100,"\n")
}

#Replace missing gene symbol with original ENSEMBL ID
for(i in 1:nrow(HiSeqCounts2)){
  if(HiSeqCounts2[i,1] == ""){
    HiSeqCounts2[i,1] = rownames(HiSeqCounts2)[i]
  }
}

#Note to self: double check the index below
HiSeqCounts3 = HiSeqCounts2
rownames(HiSeqCounts3) = HiSeqCounts3[,1] #Duplicate rownames: "PRICKLE4"
duprows = which(HiSeqCounts3[,1] == "PRICKLE4")
HiSeqCounts3[duprows,]

#Manually compared VST values between Classifier feature set and full feature set
#The correct index is 5555 

HiSeqCounts3[duprows[2],1] = "PRICKLE4paralog"
rownames(HiSeqCounts3) = HiSeqCounts3[,1]
HiSeqCounts3 = HiSeqCounts3[,-1]

rownames(HiSeqCounts3) = make.unique(gsub('\\..*','',rownames(HiSeqCounts3)))

HiSeqUnivariate = HiSeqCounts3[rownames(HiSeqCounts3) %in% Transcripts,] #Correct dimensions

###################################### Convert NovaSeq ENSG

blank = rep(NA,nrow(NovaSeqCounts))
NovaSeqCounts2 = cbind(blank,NovaSeqCounts)
NovaSeqCounts2[,1] = rownames(NovaSeqCounts)

DONE = F
for(i in 1:nrow(NovaSeqCounts2)){
  for(j in 1:nrow(prog_gene_positions)){
    if(DONE == F){
      if(sub("\\..*","",NovaSeqCounts2[i,1]) == prog_gene_positions$ensembl_gene_id[j]){
        NovaSeqCounts2[i,1] = prog_gene_positions$hgnc_symbol[j]
        DONE = T
      }
    }
  }
  DONE = F
  if((i %% 500) == 0) cat("% Done:",i/nrow(NovaSeqCounts2)*100,"\n")
}

#Replace missing gene symbol with original ENSEMBL ID
for(i in 1:nrow(NovaSeqCounts2)){
  if(NovaSeqCounts2[i,1] == ""){
    NovaSeqCounts2[i,1] = rownames(NovaSeqCounts2)[i]
  }
}

NovaSeqCounts3 = NovaSeqCounts2
rownames(NovaSeqCounts3) = NovaSeqCounts3[,1]

duprows2 = which(NovaSeqCounts3[,1] == "PRICKLE4")
NovaSeqCounts3[duprows2,]

NovaSeqCounts3[duprows2[2],1] = "PRICKLE4paralog"
rownames(NovaSeqCounts3) = NovaSeqCounts3[,1]
NovaSeqCounts3 = NovaSeqCounts3[,-1]

rownames(NovaSeqCounts3) = make.unique(gsub('\\..*','',rownames(NovaSeqCounts3)))

NovaSeqUnivariate = NovaSeqCounts3[rownames(NovaSeqCounts3) %in% Transcripts,]


###################################### Convert Control ENSG

blank = rep(NA,nrow(ControlCounts))
ControlCounts2 = cbind(blank,ControlCounts)
ControlCounts2[,1] = rownames(ControlCounts)

DONE = F
for(i in 1:nrow(ControlCounts2)){
  for(j in 1:nrow(prog_gene_positions)){
    if(DONE == F){
      if(sub("\\..*","",ControlCounts2[i,1]) == prog_gene_positions$ensembl_gene_id[j]){
        ControlCounts2[i,1] = prog_gene_positions$hgnc_symbol[j]
        DONE = T
      }
    }
  }
  DONE = F
  if((i %% 500) == 0) cat("% Done:",i/nrow(ControlCounts2)*100,"\n")
}

#Replace missing gene symbol with original ENSEMBL ID
for(i in 1:nrow(ControlCounts2)){
  if(ControlCounts2[i,1] == ""){
    ControlCounts2[i,1] = rownames(ControlCounts2)[i]
  }
}

ControlCounts3 = ControlCounts2
rownames(ControlCounts3) = ControlCounts3[,1]

duprows3 = which(ControlCounts3[,1] == "PRICKLE4")
ControlCounts3[duprows3,]

ControlCounts3[duprows3[2],1] = "PRICKLE4paralog"
rownames(ControlCounts3) = ControlCounts3[,1]
ControlCounts3 = ControlCounts3[,-1]

rownames(ControlCounts3) = make.unique(gsub('\\..*','',rownames(ControlCounts3)))

ControlUnivariate = ControlCounts3[rownames(ControlCounts3) %in% Transcripts,]

#Save the output so you don't have to reconvert ENSEMBL IDs
#save.image("ALSPatientStratification_UnivariateDatasets.RData")
#load("C:/Users/jeshima/Documents/Smith Lab/Summer 2021/ALS Subtyping/Prognostic Biomarkers/ALSPatientStratification_UnivariateDatasets.RData")
###############################################################################################################################
wd = "C:/Users/jeshima/Documents/Smith Lab/Summer 2021/ALS Subtyping/Prognostic Biomarkers"
setwd(wd)

##Determine significance using DESeq2 DE
library(DESeq2)

#Parse phenotype file
pheno = read.csv("AllSubjects_coldata_SUBTYPES.csv") #File generated in previous script
tmp = which(pheno$Factor != 4)
ALSPheno = pheno[tmp,]
tmp = which(pheno$Factor == 4)
ControlPheno = pheno[tmp,]

tmp = which(ALSPheno$sequencing_platform == "NovaSeq")
ALSPheno_Hi = ALSPheno[-tmp,]
ALSPheno_Nova = ALSPheno[tmp,]
tmp = which(ControlPheno$sequencing_platform == "NovaSeq")
ControlPheno_Hi = ControlPheno[-tmp,]
ControlPheno_Nova = ControlPheno[tmp,]

#Get HC and OND sample names from supplemental tables
HCnames = colnames(read.csv("C:/Users/jeshima/Documents/Smith Lab/Summer 2021/ALS Subtyping/Prognostic Biomarkers/HC_TECounts.csv"))
HCnames = HCnames[-1] #correct number of samples
ONDnames = colnames(read.csv("C:/Users/jeshima/Documents/Smith Lab/Summer 2021/ALS Subtyping/Prognostic Biomarkers/OND_TECounts.csv"))
ONDnames = ONDnames[-1] #correct number of samples

#Get control subsets (HC and OND)
HCPheno_Hi = ControlPheno_Hi[ControlPheno_Hi$Subject %in% HCnames,]
HCPheno_Nova = ControlPheno_Nova[ControlPheno_Nova$Subject %in% HCnames,]
#ONDPheno_Hi = ControlPheno_Hi[ControlPheno_Hi$Subject %in% ONDnames,] #No OND samples processed by HiSeq
ONDPheno_Nova = ControlPheno_Nova[ControlPheno_Nova$Subject %in% ONDnames,]

#Consider OND and HC groups separately
ONDPheno_Nova$Subtype = "OND"
ONDPheno_Nova$Factor = 5

#Subject Order: ALS, Healthy Control, Other Neurological Diseases (FTD)
HiSeqPheno = rbind(ALSPheno_Hi,HCPheno_Hi)
NovaSeqPheno = rbind(ALSPheno_Nova,HCPheno_Nova,ONDPheno_Nova)

#Parase Control Count Matrix
HCUnivariate = ControlUnivariate[,colnames(ControlUnivariate) %in% HCnames]
ONDUnivariate = ControlUnivariate[,colnames(ControlUnivariate) %in% ONDnames]

HCUnivariate_Nova = HCUnivariate[,colnames(HCUnivariate) %in% HCPheno_Nova$Subject]
HCUnivariate_Hi = HCUnivariate[,colnames(HCUnivariate) %in% HCPheno_Hi$Subject]
ONDUnivariate_Nova = ONDUnivariate[,colnames(ONDUnivariate) %in% ONDPheno_Nova$Subject] #Not really necessary

rownames(HiSeqPheno) = HiSeqPheno$Subject
rownames(NovaSeqPheno) = NovaSeqPheno$Subject


############# WITH ALL
table(rownames(NovaSeqUnivariate) == rownames(HCUnivariate))
AllNovaSeqUnivar = cbind(NovaSeqUnivariate,HCUnivariate_Nova,ONDUnivariate_Nova)
AllHiSeqUnivar = cbind(HiSeqUnivariate,HCUnivariate_Hi)

#Check that sample rownames and colnames are in the same order (required for DESeq2)
table(colnames(AllNovaSeqUnivar) == NovaSeqPheno$Subject)
table(colnames(AllHiSeqUnivar) == HiSeqPheno$Subject)
table(rownames(AllNovaSeqUnivar) == rownames(AllHiSeqUnivar))

############ WITH HC ONLY
HCNovaSeqUnivar = cbind(NovaSeqUnivariate,HCUnivariate_Nova)
HCHiSeqUnivar = cbind(HiSeqUnivariate,HCUnivariate_Hi)
HC_HiSeqPheno = rbind(ALSPheno_Hi,HCPheno_Hi)
HC_NovaSeqPheno = rbind(ALSPheno_Nova,HCPheno_Nova)

table(colnames(HCNovaSeqUnivar) == HC_NovaSeqPheno$Subject)
table(colnames(HCHiSeqUnivar) == HC_HiSeqPheno$Subject)
table(rownames(HCNovaSeqUnivar) == rownames(HCHiSeqUnivar))

############# WITH OND ONLY (Differential expression between controls and ALS subtypes not possible for HiSeq cohort using this dataset)
ONDNovaSeqUnivar = cbind(NovaSeqUnivariate,ONDUnivariate_Nova)
ONDHiSeqUnivar = HiSeqUnivariate #No OND subjects were processed on HiSeq
OND_NovaSeqPheno = rbind(ALSPheno_Nova,ONDPheno_Nova)
OND_HiSeqPheno = ALSPheno_Hi

table(colnames(ONDNovaSeqUnivar) == OND_NovaSeqPheno$Subject)
table(colnames(ONDHiSeqUnivar) == OND_HiSeqPheno$Subject)
table(rownames(ONDNovaSeqUnivar) == rownames(ONDHiSeqUnivar))

#####################################################################################################################
########### DESeq2 for identification of subtype-specific significant genes ####################################################
#####################################################################################################################
wd = "D:/Jarrett/Research/Fall 2021/ProgBM"
setwd(wd)
#Using only the 1681 features considered during supervised classification

##################### DE separated by Sequencing platform ###########################################################

rCountData = round(HCNovaSeqUnivar,0)

dds = DESeqDataSetFromMatrix(countData = rCountData, colData = HC_NovaSeqPheno, design= ~ Subtype, tidy=F)
dds$Subtype = relevel(dds$Subtype,ref = "Control")
dseq = DESeq(dds,betaPrior=T)
res = results(dseq)
sig = res[! is.na(res$padj) & res$padj<0.05,]
write.csv(sig,"NOVASEQ_ALS_HC_SubtypeSigGenes_11-26-21.csv")


rCountData2 = round(HCHiSeqUnivar,0)

dds2 = DESeqDataSetFromMatrix(countData = rCountData2, colData = HC_HiSeqPheno, design= ~ Subtype, tidy=F)
dds2$SubjectSex = relevel(dds2$Subtype,ref = "Control")
dseq2 = DESeq(dds2,betaPrior=T)
res2 = results(dseq2)
sig2 = res2[! is.na(res2$padj) & res2$padj<0.05,]
write.csv(sig2,"HISEQ_ALS_HC_SubtypeSigGenes_11-26-21.csv")


######## Multi-factor design equation (SUBTYPE, sequencing platform) ##################################

AllUnivariate = cbind(AllNovaSeqUnivar,AllHiSeqUnivar)
AllPheno = rbind(NovaSeqPheno,HiSeqPheno)

table(colnames(AllUnivariate) == AllPheno$Subject)
colnames(AllPheno)[4] = "platform"

for(i in 1:nrow(AllPheno)){
  if(AllPheno$platform[i] == "NovaSeq"){
    
  }else{
    AllPheno$platform[i] = "HiSeq"
  }
}


rCountData3 = round(AllUnivariate,0)

dds3 = DESeqDataSetFromMatrix(countData = rCountData3, colData = AllPheno, design= ~ platform + Subtype, tidy=F) #Subtype must be second (DESeq2 vignette)
dds3$SubjectSex = relevel(dds3$Subtype,ref = "Control")
dseq3 = DESeq(dds3,betaPrior=T)
res3 = results(dseq3)
sig3 = res3[! is.na(res3$padj) & res3$padj<0.05,]
write.csv(sig3,"BothPlatform_ALL_SubtypeSigGenes_11-26-21.csv")

tmp = estimateSizeFactors(dds3)
DESeq_NormalizedCounts_1681 = counts(tmp,normalized = T)

#This is Table_S12

################################################################################################################################
######## With All Genes (60k) and Multi-factor design equation (SUBTYPE, sequencing platform) ##################################

HCControlCounts = ControlCounts3[,colnames(ControlCounts3) %in% HCnames]
ONDControlCounts = ControlCounts3[,colnames(ControlCounts3) %in% ONDnames]
HCControlCounts_Nova = HCControlCounts[,colnames(HCControlCounts) %in% HCPheno_Nova$Subject]
HCControlCounts_Hi = HCControlCounts[,colnames(HCControlCounts) %in% HCPheno_Hi$Subject]
ONDControlCounts_Nova = ONDControlCounts[,colnames(ONDControlCounts) %in% ONDPheno_Nova$Subject] #Not really necessary

FullPheno = rbind(ALSPheno_Nova,ALSPheno_Hi,HCPheno_Nova,HCPheno_Hi,ONDPheno_Nova)
FullCount = cbind(NovaSeqCounts3,HiSeqCounts3,HCControlCounts_Nova,HCControlCounts_Hi,ONDControlCounts_Nova)
table(FullPheno$Subject == colnames(FullCount))

colnames(FullPheno)[4] = "platform"

for(i in 1:nrow(FullPheno)){
  if(FullPheno$platform[i] == "NovaSeq"){
    
  }else{
    FullPheno$platform[i] = "HiSeq"
  }
}


#Contrast all subtype pairs using DESeq2

rCountData4 = round(FullCount,0)

dds4 = DESeqDataSetFromMatrix(countData = rCountData4, colData = FullPheno, design= ~ platform + Subtype, tidy=F) #Subtype must be second (DESeq2 vignette)
dds4$SubjectSex = relevel(dds4$Subtype,ref = "Control")
dseq4 = DESeq(dds4,betaPrior=T)

glia.res = results(dseq4,contrast = c("Subtype","GLIA","Control"))
glia.sig = glia.res[! is.na(glia.res$padj) & glia.res$padj<0.05,]
filt.glia.sig = glia.sig[rownames(glia.sig) %in% Transcripts,]
write.csv(filt.glia.sig,"BothPlatform_AllSubjects_AllGenes_SubtypeSigGenes_11-26-21_GliaControl.csv")

ox.res = results(dseq4,contrast = c("Subtype","OX","Control"))
ox.sig = ox.res[! is.na(ox.res$padj) & ox.res$padj<0.05,]
filt.ox.sig = ox.sig[rownames(ox.sig) %in% Transcripts,]
write.csv(filt.ox.sig,"BothPlatform_AllSubjects_AllGenes_SubtypeSigGenes_11-26-21_OxControl.csv")

TE.res = results(dseq4,contrast = c("Subtype","TE","Control"))
TE.sig = TE.res[! is.na(TE.res$padj) & TE.res$padj<0.05,]
filt.TE.sig = TE.sig[rownames(TE.sig) %in% Transcripts,]
write.csv(filt.TE.sig,"BothPlatform_AllSubjects_AllGenes_SubtypeSigGenes_11-26-21_TEControl.csv")

GT.res = results(dseq4,contrast = c("Subtype","GLIA","TE"))
GT.sig = GT.res[! is.na(GT.res$padj) & GT.res$padj<0.05,]
filt.GT.sig = GT.res[rownames(GT.res) %in% Transcripts,]
write.csv(filt.GT.sig,"BothPlatform_AllSubjects_AllGenes_SubtypeSigGenes_11-26-21_GliaTE.csv")

GO.res = results(dseq4,contrast = c("Subtype","GLIA","OX"))
GO.sig = GO.res[! is.na(GO.res$padj) & GO.res$padj<0.05,]
filt.GO.sig = GO.sig[rownames(GO.sig) %in% Transcripts,]
write.csv(filt.GO.sig,"BothPlatform_AllSubjects_AllGenes_SubtypeSigGenes_11-26-21_GliaOX.csv")

TO.res = results(dseq4,contrast = c("Subtype","TE","OX"))
TO.sig = TO.res[! is.na(TO.res$padj) & TO.res$padj<0.05,]
filt.TO.sig = TO.sig[rownames(TO.sig) %in% Transcripts,]
write.csv(filt.TO.sig,"BothPlatform_AllSubjects_AllGenes_SubtypeSigGenes_11-26-21_TEOX.csv")


glia.res.ond = results(dseq4,contrast = c("Subtype","GLIA","OND"))
glia.sig.ond = glia.res.ond[! is.na(glia.res.ond$padj) & glia.res.ond$padj<0.05,]
filt.glia.sig.ond = glia.sig.ond[rownames(glia.sig.ond) %in% Transcripts,]
write.csv(filt.glia.sig.ond,"BothPlatform_AllSubjects_AllGenes_SubtypeSigGenes_11-26-21_GliaOND.csv")

ox.res.ond = results(dseq4,contrast = c("Subtype","OX","OND"))
ox.sig.ond = ox.res.ond[! is.na(ox.res.ond$padj) & ox.res.ond$padj<0.05,]
filt.ox.sig.ond = ox.sig.ond[rownames(ox.sig.ond) %in% Transcripts,]
write.csv(filt.ox.sig.ond,"BothPlatform_AllSubjects_AllGenes_SubtypeSigGenes_11-26-21_OxOND.csv")

TE.res.ond = results(dseq4,contrast = c("Subtype","TE","OND"))
TE.sig.ond = TE.res.ond[! is.na(TE.res.ond$padj) & TE.res.ond$padj<0.05,]
filt.TE.sig.ond = TE.sig.ond[rownames(TE.sig.ond) %in% Transcripts,]
write.csv(filt.TE.sig.ond,"BothPlatform_AllSubjects_AllGenes_SubtypeSigGenes_11-26-21_TEOND.csv")

COND.res = results(dseq4,contrast = c("Subtype","Control","OND"))
COND.sig = COND.res[! is.na(COND.res$padj) & COND.res$padj<0.05,]
filt.COND.sig = COND.sig[rownames(COND.sig) %in% Transcripts,]
write.csv(filt.COND.sig,"BothPlatform_AllSubjects_AllGenes_SubtypeSigGenes_11-26-21_ControlOND.csv")



#Pick out some interesting genes
GliaTranscripts = rownames(filt.glia.sig)
TETranscripts = rownames(filt.TE.sig)
OXTranscripts = rownames(filt.ox.sig)

GliaExclusive = GliaTranscripts[! GliaTranscripts %in% TETranscripts]
GliaExclusive = GliaExclusive[! GliaExclusive %in% OXTranscripts]

OXExclusive = OXTranscripts[! OXTranscripts %in% GliaTranscripts]
OXExclusive = OXExclusive[! OXExclusive %in% TETranscripts]

TEExclusive = TETranscripts [! TETranscripts %in% GliaTranscripts]
TEExclusive = TEExclusive [! TEExclusive %in% OXTranscripts]

#save.image("D:/Jarrett/Research/Fall 2021/ALSPatientStratification_UnivariateDatasets_v2.RData")
#load("D:/Jarrett/Research/Fall 2021/ALSPatientStratification_UnivariateDatasets_v2.RData")

################################  DESeq2 Normalization  #########################################################################

tmp = estimateSizeFactors(dds4)
DESeq_NormalizedCounts_60k = counts(tmp,normalized = T)
DESeq_NormalizedCounts_60k_filtered = DESeq_NormalizedCounts_60k[rownames(DESeq_NormalizedCounts_60k) %in% Transcripts,]
NormCounts = DESeq_NormalizedCounts_60k_filtered

#For plotting purposes (not used during statistical analysis), adjust zero count genes to 1

for(i in 1:nrow(NormCounts)){
  for(j in 1:ncol(NormCounts)){
    if(NormCounts[i,j] == 0){
      NormCounts[i,j] = 1
    }
  }
}

##Parse for plotting

#Subtype Normalized Count Matrix
GliaI = which(FullPheno$Subtype == "GLIA")
GliaSamp = colnames(NormCounts)[GliaI]
OxI = which(FullPheno$Subtype == "OX")
OxSamp = colnames(NormCounts)[OxI]
TEI = which(FullPheno$Subtype == "TE")
TESamp = colnames(NormCounts)[TEI]
ONDI = which(FullPheno$Subtype == "OND")
ONDSamp = colnames(NormCounts)[ONDI]
HCI = which(FullPheno$Subtype == "Control")
HCSamp = colnames(NormCounts)[HCI]

#save.image("D:/Jarrett/Research/Fall 2021/ProgBM/ALSPatientStratification_UnivariateDatasets_Ox.RData")
load("D:/Jarrett/Research/Fall 2021/ProgBM/ALSPatientStratification_UnivariateDatasets_Ox.RData")

################ Subtype-specific Upregulated TE Expression #####################################################################
MyTEs = rownames(NormCounts)[which(nchar(rownames(NormCounts)) >20)]
SubtypeTE.glia = SubtypeTE.ox = SubtypeTE.te = SubtypeTE.ond = SubtypeTE.hc = rep(NA,length(MyTEs))
count1 = count2 = count3 = count4 = count5 = 1
for(i in 1:length(MyTEs)){
  
  ind = which(rownames(NormCounts) == MyTEs[i])
  GliaAvg = mean(NormCounts[ind,GliaI])
  OxAvg = mean(NormCounts[ind,OxI])
  TEAvg = mean(NormCounts[ind,TEI])
  ONDAvg = mean(NormCounts[ind,ONDI])
  HCAvg = mean(NormCounts[ind,HCI])
  
  pick = max(c(GliaAvg,OxAvg,TEAvg,ONDAvg,HCAvg))
  
  if(GliaAvg == pick){
    SubtypeTE.glia[count1] = strsplit(MyTEs[i],"\\|")[[1]][4]
    count1 = count1+1
  }else if(OxAvg == pick){
    SubtypeTE.ox[count2] = strsplit(MyTEs[i],"\\|")[[1]][4]
    count2 = count2+1
  }else if(TEAvg == pick){
    SubtypeTE.te[count3] = strsplit(MyTEs[i],"\\|")[[1]][4]
    count3 = count3+1
  }else if(ONDAvg == pick){
    SubtypeTE.ond[count4] = strsplit(MyTEs[i],"\\|")[[1]][4]
    count4 = count4+1
  }else{
    SubtypeTE.hc[count5] = strsplit(MyTEs[i],"\\|")[[1]][4]
    count5 = count5+1
  }
  
}

SubtypeTE.glia = SubtypeTE.glia[! is.na(SubtypeTE.glia)]
SubtypeTE.ox = SubtypeTE.ox[! is.na(SubtypeTE.ox)]
SubtypeTE.te = SubtypeTE.te[! is.na(SubtypeTE.te)]
SubtypeTE.ond = SubtypeTE.ond[! is.na(SubtypeTE.ond)]
SubtypeTE.hc = SubtypeTE.hc[! is.na(SubtypeTE.hc)]

Subfamily = names(table(c(names(table(SubtypeTE.glia)),names(table(SubtypeTE.ox)),names(table(SubtypeTE.te)),names(table(SubtypeTE.ond)),names(table(SubtypeTE.hc)))))
SubfamilyDF = matrix(NA,nrow=length(Subfamily),ncol=5)
rownames(SubfamilyDF) = Subfamily
colnames(SubfamilyDF) = c("ALS-TD","ALS-Ox","ALS-Glia","FTLD",'HC')

for(i in 1:nrow(SubfamilyDF)){
  
  TEcount = length(which(SubtypeTE.te == rownames(SubfamilyDF)[i]))
  Oxcount = length(which(SubtypeTE.ox == rownames(SubfamilyDF)[i]))
  Gliacount = length(which(SubtypeTE.glia == rownames(SubfamilyDF)[i]))
  ONDcount = length(which(SubtypeTE.ond == rownames(SubfamilyDF)[i]))
  HCcount = length(which(SubtypeTE.hc == rownames(SubfamilyDF)[i]))
  
  SubfamilyDF[i,1] = TEcount
  SubfamilyDF[i,2] = Oxcount
  SubfamilyDF[i,3] = Gliacount
  SubfamilyDF[i,4] = ONDcount
  SubfamilyDF[i,5] = HCcount
  
}

#Quick Plot
par(mar = c(6.1, 5.1, 4.1, 2.1)) 
mycols = rainbow(nrow(SubfamilyDF))
barplot(SubfamilyDF,ylim = c(0,300),ylab = "Number of Discriminatory TEs",xlab="Subtype",col = mycols,cex.axis = 1.2,cex.names = 1.5,cex.lab=1.5)
#legend(5.5,300,legend = rownames(SubfamilyDF),col = mycols,lty = 1,lwd=3,cex = 0.2)

#Legend without plot
plot(NULL ,xaxt='n',yaxt='n',bty='n',ylab='',xlab='', xlim=0:1, ylim=0:1)
legend("topleft",legend = rownames(SubfamilyDF),col = mycols,lty = 1,lwd=3,cex = 0.8,ncol=4)



#Pie chart version
par(mar = c(0, 1, 2, 1))
tmp1 = which(SubfamilyDF[,1] == 0)
SubfamilyDF2 = SubfamilyDF[-tmp1,]
mycols2 = mycols[-tmp1]
pct = SubfamilyDF2[,1]/sum(SubfamilyDF2[,1])
pie(SubfamilyDF2[,1],labels =  paste(rownames(SubfamilyDF2)," (",round(pct*100,1),"%)",sep=""),col=mycols2,main="ALS-TD Transposable Element Feature Breakdown",cex=0.5)

tmp1 = which(SubfamilyDF[,2] == 0)
SubfamilyDF2 = SubfamilyDF[-tmp1,]
mycols2 = mycols[-tmp1]
pct = SubfamilyDF2[,2]/sum(SubfamilyDF2[,2])
pie(SubfamilyDF2[,2],labels =  paste(rownames(SubfamilyDF2)," (",round(pct*100,1),"%)",sep=""),col=mycols2,main="ALS-Ox Transposable Element Feature Breakdown",cex=0.5)

tmp1 = which(SubfamilyDF[,3] == 0)
SubfamilyDF2 = SubfamilyDF[-tmp1,]
mycols2 = mycols[-tmp1]
pct = SubfamilyDF2[,3]/sum(SubfamilyDF2[,3])
pie(SubfamilyDF2[,3],labels =  paste(rownames(SubfamilyDF2)," (",round(pct*100,1),"%)",sep=""),col=mycols2,main="ALS-Glia Transposable Element Feature Breakdown",cex=1)



#ggplot2 - doesn't like the legend size
# library(ggplot2)
# mycols2 = rep(mycols,5)
# conditions = rep(rownames(SubfamilyDF),5)
# subt = c(rep("ALS-TD",nrow(SubfamilyDF)),rep("ALS-Ox",nrow(SubfamilyDF)),rep("ALS-Glia",nrow(SubfamilyDF)),rep("OND",nrow(SubfamilyDF)),rep("HC",nrow(SubfamilyDF)))
# subt = factor(subt,levels = c("ALS-TD","ALS-Ox","ALS-Glia","FTLD","HC"))
# val = c(SubfamilyDF[,1],SubfamilyDF[,2],SubfamilyDF[,3],SubfamilyDF[,4],SubfamilyDF[,5])
# data = data.frame(subt,conditions,val)
# p = ggplot(data, aes(x=subt,y=val,fill = conditions)) + geom_bar(stat="identity",position = "stack")#,fill = mycols2)
# p = p+theme(legend.text = element_text(size=4),legend.title = element_text(size=4),legend.spacing.x = -5)#element_text(hjust = -5))
# p = p + xlab("Patient Subset") + ylab("Number of Discriminatory TEs")
# p = p +scale_y_continuous(limits = c(0,300))
# p = p+theme_bw()
# p

###################### Chromosome TE Pie Chart #####################################################################

a = table(substr(MyTEs,1,5))
for(i in 1:length(a)){
  if(substr(names(a)[i],5,5) == "|"){
    names(a)[i] = substr(names(a)[i],1,4)
  }
}
plot(a)

chroms = data.frame(matrix(NA,nrow=length(a),ncol = 2))
colnames(chroms) = c("chr","TEfeatures")
chroms$chr = paste("chr",seq(1,23),sep="")
chroms$chr[23] = "chrX"

for(i in 1:nrow(chroms)){
  for(j in 1:length(a)){
    if(chroms$chr[i] == names(a)[j]){
      chroms$TEfeatures[i] = a[[j]]
    }
    
  }
}

library(RColorBrewer)
mycols = colorRampPalette(c("cyan","dodgerblue4"))
#mycols = colorRampPalette(c("white","gray30"))
mycols = mycols(23)
chroms$pct = chroms$TEfeatures / sum(chroms$TEfeatures)
chroms$pct = chroms$pct * 100 
chroms$chr = factor(chroms$chr,levels = c("chr1","chr2","chr3","chr4","chr5","chr6","chr7","chr8","chr9","chr10","chr11","chr12","chr13","chr14","chr15","chr16","chr17","chr18","chr19","chr20","chr21","chr22","chrX"))
pie(chroms$TEfeatures,labels = paste(chroms$chr," (",round(chroms$pct,1),"%)",sep=""),col = mycols,main="chromosome vs number of discriminatory TE features")

################################### PLOTS #####################################################################

#Grab Tan and Magenta EigenGene features
Tan = read.csv("TanEigenGene.csv")
Tan = names(table(Tan$One))
Magenta = read.csv("MagentaEigenGene.csv")
Magenta = names(table(Magenta$One))

ExtraTEfeat = c("ENSG00000243679","ENSG00000279764","ENSG00000225032","ENSG00000280214","ENSG00000262580","ENSG00000265690","ZGLP1","ENSG00000279283","ENSG00000228434","ENSG00000223855","ENSG00000268670","CHKB-CPT1B","ENSG00000278434","ENSG00000279179","ACTBP7","ENSG00000285596","CHMP4BP1","ENSG00000262312","CEL","ENSG00000279233","CEP295NL","ENSG00000205041","ADAT3","FGF17","SLX1B-SULT1A4","ENSG00000274251","ENSG00000280332","ENSG00000280073","ENSG00000279861","SAP25","TGM1","CCDC154","ENSG00000258559","ENSG00000260198","LINC01347","EGLN1P1","ENSG00000278872","ENSG00000229657","TNFRSF25","ENSG00000279759","ENSG00000274272","ENSG00000260417","ENSG00000269318","ENSG00000258674","ENSG00000230715","ENSG00000261067","ENSG00000267749","ENSG00000285581","ENSG00000279801","FAM3C","ENSG00000257607","C1D","ENSG00000279839","ENSG00000280163","STH","AMH","UNC13D","SLFNL1","MLKL","HSD17B1","HSD17B3")

Subtype = FullPheno$Subtype

for(i in 1:length(Subtype)){
  if(Subtype[i] == "GLIA"){
    Subtype[i] = "ALS-Glia"
  }else if(Subtype[i] == "OX"){
    Subtype[i] = "ALS-Ox"
  }else if(Subtype[i] == "TE"){
    Subtype[i] = "ALS-TD"
  }else if(Subtype[i] == "OND"){
    Subtype[i] = "FTLD"
  }
}

Subtype = factor(Subtype,levels = c("Control","FTLD","ALS-Glia","ALS-Ox","ALS-TD"))


### AutoPlot

#Provide a specific feature or list of features to plot
PlotGene = "chrX|54815877|54816014|MER117:hAT-Charlie:DNA|248|-"

#Pick the reference subtype to add DE p-values contrasted with other groups 
#Options: Glia, Ox, TE, HC, All (case sensitive; note that 'All' option automatically selects the reference group... all comparisons are NOT performed)
Focus = "All"

#Autoplot
for(i in 1:length(PlotGene)){
  
  #Grab the index
  tmpindex = which(rownames(NormCounts) == PlotGene[i])
  
  ##Boxplots
  
  #On the Normalized Count Scale
  PlotCounts = NormCounts[tmpindex,]
  dat = data.frame(Subtype,PlotCounts)
  p = ggplot(dat,aes(x=Subtype,y=PlotCounts,fill=Subtype)) + geom_boxplot()
  ttl = paste(PlotGene[i])
  p = p +ggtitle(ttl) + xlab("Subtype") + ylab("Median-of-Ratios Counts")
  p = p+scale_x_discrete(limits=c("Control","OND","ALS-Glia","ALS-Ox","ALS-TE"))
  p = p+scale_fill_manual(values = c("gray50","gray30","goldenrod1","navy","firebrick"))
  p = p+theme(axis.text = element_text(size=16), axis.title = element_text(size=18),plot.title = element_text(size=18),legend.text = element_text(size=14),legend.title = element_text(size=14))
  p = p+theme(axis.title.x=element_text(vjust=-2))
  p = p+theme(axis.title.y=element_text(angle=90, vjust=6))
  p = p+ theme(plot.margin = unit(c(1,1,1,1), "cm"))
  p = p+theme(plot.title = element_text(hjust = 0.5))
  upperlim = max(PlotCounts)+max(PlotCounts)*0.65
  tmplim = min(PlotCounts)-min(PlotCounts)*0.15
  if(round(tmplim,0)==0){
    lowerlim = 0
  }else{
    lowerlim = tmplim
  }
  #Add p-values
  if(Focus == "Glia"){
    Controlp = filt.glia.sig #vs Control
    tmpindex2 = which(rownames(Controlp) == PlotGene[i])
    Controlp = Controlp$padj[tmpindex2]
    Controlp = formatC(Controlp,format = "e",digits = 2)
    if(Controlp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.1),size=0.8)
      p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=1,yend=max(PlotCounts)+max(PlotCounts)*0.05),size=0.8)
      p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.05),size=0.8)
      pstat = paste("FDR p-value:",Controlp)
      p = p+annotate("text",label=pstat,x=2,y=max(PlotCounts)+max(PlotCounts)*0.15)
    }
    
    ONDp = filt.glia.sig.ond #vs OND
    tmpindex3 = which(rownames(ONDp) == PlotGene[i])
    ONDp = ONDp$padj[tmpindex3]
    ONDp = formatC(ONDp,format = "e",digits = 2)
    if(ONDp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=2,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.25),size=0.8)
      p = p+geom_segment(aes(x=2,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=2,yend=max(PlotCounts)+max(PlotCounts)*0.2),size=0.8)
      p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.2),size=0.8)
      pstat = paste("FDR p-value:",ONDp)
      p = p+annotate("text",label=pstat,x=2.5,y=max(PlotCounts)+max(PlotCounts)*0.3)
    }
    
    OXp = filt.GO.sig #vs OX
    tmpindex4 = which(rownames(OXp) == PlotGene[i])
    OXp = OXp$padj[tmpindex4]
    OXp = formatC(OXp,format = "e",digits = 2)
    if(OXp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.40,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.40),size=0.8)
      p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.40,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.35),size=0.8)
      p = p+geom_segment(aes(x=4,y=max(PlotCounts)+max(PlotCounts)*0.40,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.35),size=0.8)
      pstat = paste("FDR p-value:",OXp)
      p = p+annotate("text",label=pstat,x=3.5,y=max(PlotCounts)+max(PlotCounts)*0.45)
    }
    
    TEp = filt.GT.sig #vs TE
    tmpindex5 = which(rownames(TEp) == PlotGene[i])
    TEp = TEp$padj[tmpindex5]
    TEp = formatC(TEp,format = "e",digits = 2)
    if(TEp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.55),size=0.8)
      p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.50),size=0.8)
      p = p+geom_segment(aes(x=5,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.50),size=0.8)
      pstat = paste("FDR p-value:",TEp)
      p = p+annotate("text",label=pstat,x=4,y=max(PlotCounts)+max(PlotCounts)*0.6)
    }
    
  }else if(Focus == "Ox"){
    Controlp = filt.ox.sig #vs Control
    tmpindex2 = which(rownames(Controlp) == PlotGene[i])
    Controlp = Controlp$padj[tmpindex2]
    Controlp = formatC(Controlp,format = "e",digits = 2)
    if(Controlp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.1),size=0.8)
      p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=1,yend=max(PlotCounts)+max(PlotCounts)*0.05),size=0.8)
      p = p+geom_segment(aes(x=4,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.05),size=0.8)
      pstat = paste("FDR p-value:",Controlp)
      p = p+annotate("text",label=pstat,x=2.5,y=max(PlotCounts)+max(PlotCounts)*0.15)
    }
    
    ONDp = filt.ox.sig.ond #vs OND
    tmpindex3 = which(rownames(ONDp) == PlotGene[i])
    ONDp = ONDp$padj[tmpindex3]
    ONDp = formatC(ONDp,format = "e",digits = 2)
    if(ONDp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=2,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.25),size=0.8)
      p = p+geom_segment(aes(x=2,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=2,yend=max(PlotCounts)+max(PlotCounts)*0.2),size=0.8)
      p = p+geom_segment(aes(x=4,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.2),size=0.8)
      pstat = paste("FDR p-value:",ONDp)
      p = p+annotate("text",label=pstat,x=3,y=max(PlotCounts)+max(PlotCounts)*0.3)
    }
    
    OXp = filt.GO.sig #vs OX
    tmpindex4 = which(rownames(OXp) == PlotGene[i])
    OXp = OXp$padj[tmpindex4]
    OXp = formatC(OXp,format = "e",digits = 2)
    if(OXp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.40,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.40),size=0.8)
      p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.40,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.35),size=0.8)
      p = p+geom_segment(aes(x=4,y=max(PlotCounts)+max(PlotCounts)*0.40,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.35),size=0.8)
      pstat = paste("FDR p-value:",OXp)
      p = p+annotate("text",label=pstat,x=3.5,y=max(PlotCounts)+max(PlotCounts)*0.45)
    }
    
    TEp = filt.TO.sig #vs TE
    tmpindex5 = which(rownames(TEp) == PlotGene[i])
    TEp = TEp$padj[tmpindex5]
    TEp = formatC(TEp,format = "e",digits = 2)
    if(TEp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=4,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.55),size=0.8)
      p = p+geom_segment(aes(x=4,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.50),size=0.8)
      p = p+geom_segment(aes(x=5,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.50),size=0.8)
      pstat = paste("FDR p-value:",TEp)
      p = p+annotate("text",label=pstat,x=4.5,y=max(PlotCounts)+max(PlotCounts)*0.6)
    }
    
  }else if(Focus == "TE"){
    Controlp = filt.TE.sig#vs Control
    tmpindex2 = which(rownames(Controlp) == PlotGene[i])
    Controlp = Controlp$padj[tmpindex2]
    Controlp = formatC(Controlp,format = "e",digits = 2)
    if(Controlp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.1),size=0.8)
      p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=1,yend=max(PlotCounts)+max(PlotCounts)*0.05),size=0.8)
      p = p+geom_segment(aes(x=5,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.05),size=0.8)
      pstat = paste("FDR p-value:",Controlp)
      p = p+annotate("text",label=pstat,x=3,y=max(PlotCounts)+max(PlotCounts)*0.15)
    }
    
    ONDp = filt.TE.sig.ond #vs OND
    tmpindex3 = which(rownames(ONDp) == PlotGene[i])
    ONDp = ONDp$padj[tmpindex3]
    ONDp = formatC(ONDp,format = "e",digits = 2)
    if(ONDp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=2,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.25),size=0.8)
      p = p+geom_segment(aes(x=2,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=2,yend=max(PlotCounts)+max(PlotCounts)*0.2),size=0.8)
      p = p+geom_segment(aes(x=5,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.2),size=0.8)
      pstat = paste("FDR p-value:",ONDp)
      p = p+annotate("text",label=pstat,x=3.5,y=max(PlotCounts)+max(PlotCounts)*0.3)
    }
    
    Gliap = filt.GT.sig #vs Glia
    tmpindex4 = which(rownames(Gliap) == PlotGene[i])
    Gliap = Gliap$padj[tmpindex4]
    Gliap = formatC(Gliap,format = "e",digits = 2)
    if(Gliap>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.40,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.40),size=0.8)
      p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.40,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.35),size=0.8)
      p = p+geom_segment(aes(x=5,y=max(PlotCounts)+max(PlotCounts)*0.40,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.35),size=0.8)
      pstat = paste("FDR p-value:",Gliap)
      p = p+annotate("text",label=pstat,x=4,y=max(PlotCounts)+max(PlotCounts)*0.45)
    }
    
    TEp = filt.TO.sig #vs OX
    tmpindex5 = which(rownames(TEp) == PlotGene[i])
    TEp = TEp$padj[tmpindex5]
    TEp = formatC(TEp,format = "e",digits = 2)
    if(TEp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=4,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.55),size=0.8)
      p = p+geom_segment(aes(x=4,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.50),size=0.8)
      p = p+geom_segment(aes(x=5,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.50),size=0.8)
      pstat = paste("FDR p-value:",TEp)
      p = p+annotate("text",label=pstat,x=4.5,y=max(PlotCounts)+max(PlotCounts)*0.6)
    }
    
    }else if(Focus == "HC"){
      Controlp = filt.COND.sig #vs OND
      tmpindex2 = which(rownames(Controlp) == PlotGene[i])
      Controlp = Controlp$padj[tmpindex2]
      Controlp = formatC(Controlp,format = "e",digits = 2)
      if(Controlp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.1),size=0.8)
        p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=1,yend=max(PlotCounts)+max(PlotCounts)*0.05),size=0.8)
        p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.05),size=0.8)
        pstat = paste("FDR p-value:",Controlp)
        p = p+annotate("text",label=pstat,x=2,y=max(PlotCounts)+max(PlotCounts)*0.15)
      }
      
      Gliap = filt.glia.sig #vs Glia
      tmpindex3 = which(rownames(ONDp) == PlotGene[i])
      ONDp = ONDp$padj[tmpindex3]
      ONDp = formatC(ONDp,format = "e",digits = 2)
      if(ONDp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=2,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.25),size=0.8)
        p = p+geom_segment(aes(x=2,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=2,yend=max(PlotCounts)+max(PlotCounts)*0.2),size=0.8)
        p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.2),size=0.8)
        pstat = paste("FDR p-value:",ONDp)
        p = p+annotate("text",label=pstat,x=2.5,y=max(PlotCounts)+max(PlotCounts)*0.3)
      }
      
      OXp = filt.ox.sig #vs OX
      tmpindex4 = which(rownames(OXp) == PlotGene[i])
      OXp = OXp$padj[tmpindex4]
      OXp = formatC(OXp,format = "e",digits = 2)
      if(OXp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.40,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.40),size=0.8)
        p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.40,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.35),size=0.8)
        p = p+geom_segment(aes(x=4,y=max(PlotCounts)+max(PlotCounts)*0.40,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.35),size=0.8)
        pstat = paste("FDR p-value:",OXp)
        p = p+annotate("text",label=pstat,x=3.5,y=max(PlotCounts)+max(PlotCounts)*0.45)
      }
      
      TEp = filt.TE.sig #vs TE
      tmpindex5 = which(rownames(TEp) == PlotGene[i])
      TEp = TEp$padj[tmpindex5]
      TEp = formatC(TEp,format = "e",digits = 2)
      if(TEp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.55),size=0.8)
        p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.50),size=0.8)
        p = p+geom_segment(aes(x=5,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.50),size=0.8)
        pstat = paste("FDR p-value:",TEp)
        p = p+annotate("text",label=pstat,x=4,y=max(PlotCounts)+max(PlotCounts)*0.6)
      }
    
  }else if(Focus == "All"){
    
    #Reset axis limits
    upperlim = max(PlotCounts)+max(PlotCounts)*0.65
    tmplim = min(PlotCounts)-min(PlotCounts)*0.15
    if(round(tmplim,0)==0){
      lowerlim = 0
    }else{
      lowerlim = tmplim
    }
    
    #Get Subtype with max counts as reference level - all comparisons is too busy
    GCounts = NormCounts[,GliaI]
    OCounts = NormCounts[,OxI]
    TCounts = NormCounts[,TEI]
    HCounts = NormCounts[,HCI]
    ONDCounts = NormCounts[,ONDI]
    
    Gavg = mean(GCounts[tmpindex,])
    Oavg = mean(OCounts[tmpindex,])
    Tavg = mean(TCounts[tmpindex,])
    Havg = mean(HCounts[tmpindex,])
    ONDavg = mean(ONDCounts[tmpindex,])
    
    reflev = max(c(Gavg,Oavg,Tavg,Havg,ONDavg))
    
    if(Gavg == reflev){
      
      Controlp = filt.glia.sig #vs Control
      tmpindex2 = which(rownames(Controlp) == PlotGene[i])
      Controlp = Controlp$padj[tmpindex2]
      Controlp = formatC(Controlp,format = "e",digits = 2)
      if(Controlp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.1),size=0.8)
        p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=1,yend=max(PlotCounts)+max(PlotCounts)*0.05),size=0.8)
        p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.05),size=0.8)
        pstat = paste("FDR p-value:",Controlp)
        p = p+annotate("text",label=pstat,x=2,y=max(PlotCounts)+max(PlotCounts)*0.15)
      }
      
      ONDp = filt.glia.sig.ond #vs OND
      tmpindex3 = which(rownames(ONDp) == PlotGene[i])
      ONDp = ONDp$padj[tmpindex3]
      ONDp = formatC(ONDp,format = "e",digits = 2)
      if(ONDp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=2,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.25),size=0.8)
        p = p+geom_segment(aes(x=2,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=2,yend=max(PlotCounts)+max(PlotCounts)*0.2),size=0.8)
        p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.2),size=0.8)
        pstat = paste("FDR p-value:",ONDp)
        p = p+annotate("text",label=pstat,x=2.5,y=max(PlotCounts)+max(PlotCounts)*0.3)
      }
      
      OXp = filt.GO.sig #vs OX
      tmpindex4 = which(rownames(OXp) == PlotGene[i])
      OXp = OXp$padj[tmpindex4]
      OXp = formatC(OXp,format = "e",digits = 2)
      if(OXp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.40,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.40),size=0.8)
        p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.40,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.35),size=0.8)
        p = p+geom_segment(aes(x=4,y=max(PlotCounts)+max(PlotCounts)*0.40,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.35),size=0.8)
        pstat = paste("FDR p-value:",OXp)
        p = p+annotate("text",label=pstat,x=3.5,y=max(PlotCounts)+max(PlotCounts)*0.45)
      }
      
      TEp = filt.GT.sig #vs TE
      tmpindex5 = which(rownames(TEp) == PlotGene[i])
      TEp = TEp$padj[tmpindex5]
      TEp = formatC(TEp,format = "e",digits = 2)
      if(TEp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.55),size=0.8)
        p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.50),size=0.8)
        p = p+geom_segment(aes(x=5,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.50),size=0.8)
        pstat = paste("FDR p-value:",TEp)
        p = p+annotate("text",label=pstat,x=4,y=max(PlotCounts)+max(PlotCounts)*0.6)
      }
      
      
    }else if(Oavg == reflev){
      
      Controlp = filt.ox.sig #vs Control
      tmpindex2 = which(rownames(Controlp) == PlotGene[i])
      Controlp = Controlp$padj[tmpindex2]
      Controlp = formatC(Controlp,format = "e",digits = 2)
      if(Controlp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.1),size=0.8)
        p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=1,yend=max(PlotCounts)+max(PlotCounts)*0.05),size=0.8)
        p = p+geom_segment(aes(x=4,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.05),size=0.8)
        pstat = paste("FDR p-value:",Controlp)
        p = p+annotate("text",label=pstat,x=2.5,y=max(PlotCounts)+max(PlotCounts)*0.15)
      }
      
      ONDp = filt.ox.sig.ond #vs OND
      tmpindex3 = which(rownames(ONDp) == PlotGene[i])
      ONDp = ONDp$padj[tmpindex3]
      ONDp = formatC(ONDp,format = "e",digits = 2)
      if(ONDp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=2,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.25),size=0.8)
        p = p+geom_segment(aes(x=2,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=2,yend=max(PlotCounts)+max(PlotCounts)*0.2),size=0.8)
        p = p+geom_segment(aes(x=4,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.2),size=0.8)
        pstat = paste("FDR p-value:",ONDp)
        p = p+annotate("text",label=pstat,x=3,y=max(PlotCounts)+max(PlotCounts)*0.3)
      }
      
      Gliap = filt.GO.sig #vs Glia
      tmpindex4 = which(rownames(Gliap) == PlotGene[i])
      Gliap = Gliap$padj[tmpindex4]
      Gliap = formatC(Gliap,format = "e",digits = 2)
      if(Gliap>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.40,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.40),size=0.8)
        p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.40,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.35),size=0.8)
        p = p+geom_segment(aes(x=4,y=max(PlotCounts)+max(PlotCounts)*0.40,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.35),size=0.8)
        pstat = paste("FDR p-value:",Gliap)
        p = p+annotate("text",label=pstat,x=3.5,y=max(PlotCounts)+max(PlotCounts)*0.45)
      }
      
      TEp = filt.TO.sig #vs TE
      tmpindex5 = which(rownames(TEp) == PlotGene[i])
      TEp = TEp$padj[tmpindex5]
      TEp = formatC(TEp,format = "e",digits = 2)
      if(TEp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=4,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.55),size=0.8)
        p = p+geom_segment(aes(x=4,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.50),size=0.8)
        p = p+geom_segment(aes(x=5,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.50),size=0.8)
        pstat = paste("FDR p-value:",TEp)
        p = p+annotate("text",label=pstat,x=4.5,y=max(PlotCounts)+max(PlotCounts)*0.6)
      }
      
    }else if(Tavg == reflev){
      
      Controlp = filt.TE.sig #vs Control
      tmpindex2 = which(rownames(Controlp) == PlotGene[i])
      Controlp = Controlp$padj[tmpindex2]
      Controlp = formatC(Controlp,format = "e",digits = 2)
      if(Controlp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.1),size=0.8)
        p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=1,yend=max(PlotCounts)+max(PlotCounts)*0.05),size=0.8)
        p = p+geom_segment(aes(x=5,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.05),size=0.8)
        pstat = paste("FDR p-value:",Controlp)
        p = p+annotate("text",label=pstat,x=3,y=max(PlotCounts)+max(PlotCounts)*0.15)
      }
      
      ONDp = filt.TE.sig.ond #vs OND
      tmpindex3 = which(rownames(ONDp) == PlotGene[i])
      ONDp = ONDp$padj[tmpindex3]
      ONDp = formatC(ONDp,format = "e",digits = 2)
      if(ONDp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=2,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.25),size=0.8)
        p = p+geom_segment(aes(x=2,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=2,yend=max(PlotCounts)+max(PlotCounts)*0.2),size=0.8)
        p = p+geom_segment(aes(x=5,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.2),size=0.8)
        pstat = paste("FDR p-value:",ONDp)
        p = p+annotate("text",label=pstat,x=3.5,y=max(PlotCounts)+max(PlotCounts)*0.3)
      }
      
      Gliap = filt.GT.sig #vs Glia
      tmpindex4 = which(rownames(Gliap) == PlotGene[i])
      Gliap = Gliap$padj[tmpindex4]
      Gliap = formatC(Gliap,format = "e",digits = 2)
      if(Gliap>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.40,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.40),size=0.8)
        p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.40,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.35),size=0.8)
        p = p+geom_segment(aes(x=5,y=max(PlotCounts)+max(PlotCounts)*0.40,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.35),size=0.8)
        pstat = paste("FDR p-value:",Gliap)
        p = p+annotate("text",label=pstat,x=4,y=max(PlotCounts)+max(PlotCounts)*0.45)
      }
      
      TEp = filt.TO.sig #vs OX
      tmpindex5 = which(rownames(TEp) == PlotGene[i])
      TEp = TEp$padj[tmpindex5]
      TEp = formatC(TEp,format = "e",digits = 2)
      if(TEp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=4,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.55),size=0.8)
        p = p+geom_segment(aes(x=4,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.50),size=0.8)
        p = p+geom_segment(aes(x=5,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.50),size=0.8)
        pstat = paste("FDR p-value:",TEp)
        p = p+annotate("text",label=pstat,x=4.5,y=max(PlotCounts)+max(PlotCounts)*0.6)
      }
      
    }else if(Havg == reflev){
      
      ONDp = filt.COND.sig #vs OND
      tmpindex3 = which(rownames(ONDp) == PlotGene[i])
      ONDp = ONDp$padj[tmpindex3]
      ONDp = formatC(ONDp,format = "e",digits = 2)
      if(ONDp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=2,yend=max(PlotCounts)+max(PlotCounts)*0.1),size=0.8)
        p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=1,yend=max(PlotCounts)+max(PlotCounts)*0.05),size=0.8)
        p = p+geom_segment(aes(x=2,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=2,yend=max(PlotCounts)+max(PlotCounts)*0.05),size=0.8)
        pstat = paste("FDR p-value:",ONDp)
        p = p+annotate("text",label=pstat,x=1.5,y=max(PlotCounts)+max(PlotCounts)*0.15)
      }
      
      Gliap = filt.glia.sig #vs Control
      tmpindex2 = which(rownames(Gliap) == PlotGene[i])
      Gliap = Gliap$padj[tmpindex2]
      Gliap = formatC(Gliap,format = "e",digits = 2)
      if(Gliap>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.25),size=0.8)
        p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=1,yend=max(PlotCounts)+max(PlotCounts)*0.2),size=0.8)
        p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.2),size=0.8)
        pstat = paste("FDR p-value:",Gliap)
        p = p+annotate("text",label=pstat,x=2,y=max(PlotCounts)+max(PlotCounts)*0.3)
      }
      
      OXp = filt.ox.sig #vs Control
      tmpindex2 = which(rownames(OXp) == PlotGene[i])
      OXp = OXp$padj[tmpindex2]
      OXp = formatC(OXp,format = "e",digits = 2)
      if(OXp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.4,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.4),size=0.8)
        p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.4,xend=1,yend=max(PlotCounts)+max(PlotCounts)*0.35),size=0.8)
        p = p+geom_segment(aes(x=4,y=max(PlotCounts)+max(PlotCounts)*0.4,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.35),size=0.8)
        pstat = paste("FDR p-value:",OXp)
        p = p+annotate("text",label=pstat,x=2.5,y=max(PlotCounts)+max(PlotCounts)*0.45)
      }
      
      TEp = filt.TE.sig#vs Control
      tmpindex2 = which(rownames(TEp) == PlotGene[i])
      TEp = TEp$padj[tmpindex2]
      TEp = formatC(TEp,format = "e",digits = 2)
      if(TEp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.55),size=0.8)
        p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=1,yend=max(PlotCounts)+max(PlotCounts)*0.5),size=0.8)
        p = p+geom_segment(aes(x=5,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.5),size=0.8)
        pstat = paste("FDR p-value:",TEp)
        p = p+annotate("text",label=pstat,x=3,y=max(PlotCounts)+max(PlotCounts)*0.6)
      }
      
    }else if(ONDavg == reflev){
      
      Controlp = filt.COND.sig #vs OND
      tmpindex3 = which(rownames(Controlp) == PlotGene[i])
      Controlp = Controlp$padj[tmpindex3]
      Controlp = formatC(Controlp,format = "e",digits = 2)
      if(Controlp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=2,yend=max(PlotCounts)+max(PlotCounts)*0.1),size=0.8)
        p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=1,yend=max(PlotCounts)+max(PlotCounts)*0.05),size=0.8)
        p = p+geom_segment(aes(x=2,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=2,yend=max(PlotCounts)+max(PlotCounts)*0.05),size=0.8)
        pstat = paste("FDR p-value:",Controlp)
        p = p+annotate("text",label=pstat,x=1.5,y=max(PlotCounts)+max(PlotCounts)*0.15)
      }
      
      Gliap = filt.glia.sig.ond #vs Control
      tmpindex2 = which(rownames(Gliap) == PlotGene[i])
      Gliap = Gliap$padj[tmpindex2]
      Gliap = formatC(Gliap,format = "e",digits = 2)
      if(Gliap>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=2,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.25),size=0.8)
        p = p+geom_segment(aes(x=2,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=2,yend=max(PlotCounts)+max(PlotCounts)*0.2),size=0.8)
        p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.2),size=0.8)
        pstat = paste("FDR p-value:",Gliap)
        p = p+annotate("text",label=pstat,x=2.5,y=max(PlotCounts)+max(PlotCounts)*0.30)
      }
      
      OXp = filt.ox.sig.ond #vs Control
      tmpindex2 = which(rownames(OXp) == PlotGene[i])
      OXp = OXp$padj[tmpindex2]
      OXp = formatC(OXp,format = "e",digits = 2)
      if(OXp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=2,y=max(PlotCounts)+max(PlotCounts)*0.4,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.4),size=0.8)
        p = p+geom_segment(aes(x=2,y=max(PlotCounts)+max(PlotCounts)*0.4,xend=2,yend=max(PlotCounts)+max(PlotCounts)*0.35),size=0.8)
        p = p+geom_segment(aes(x=4,y=max(PlotCounts)+max(PlotCounts)*0.4,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.35),size=0.8)
        pstat = paste("FDR p-value:",OXp)
        p = p+annotate("text",label=pstat,x=3,y=max(PlotCounts)+max(PlotCounts)*0.45)
      }
      
      TEp = filt.TE.sig.ond #vs Control
      tmpindex2 = which(rownames(TEp) == PlotGene[i])
      TEp = TEp$padj[tmpindex2]
      TEp = formatC(TEp,format = "e",digits = 2)
      if(TEp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=2,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.55),size=0.8)
        p = p+geom_segment(aes(x=2,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=2,yend=max(PlotCounts)+max(PlotCounts)*0.5),size=0.8)
        p = p+geom_segment(aes(x=5,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.5),size=0.8)
        pstat = paste("FDR p-value:",TEp)
        p = p+annotate("text",label=pstat,x=3.5,y=max(PlotCounts)+max(PlotCounts)*0.6)
      }
      
    }else(
      cat("Unknown Error")
    )
    
    
  }else{
    cat("Focus not specified, p-values not added to the plot")
  }
  print(p)
  
  #On the Log2 Normalized Count Scale
  LogPlotCounts = log2(PlotCounts)
  logdat = data.frame(Subtype,LogPlotCounts)
  p = ggplot(logdat,aes(x=Subtype,y=LogPlotCounts,fill=Subtype)) + geom_boxplot()
  ttl = paste(PlotGene[i])
  p = p +ggtitle(ttl) + xlab("Subtype") + ylab("log2 Median-of-Ratios Counts")
  p = p+scale_x_discrete(limits=c("Control","OND","ALS-Glia","ALS-Ox","ALS-TE"))
  p = p+scale_fill_manual(values = c("gray50","gray30","goldenrod1","navy","firebrick"))
  p = p+theme(axis.text = element_text(size=16), axis.title = element_text(size=18),plot.title = element_text(size=18),legend.text = element_text(size=14),legend.title = element_text(size=14))
  p = p+theme(axis.title.x=element_text(vjust=-2))
  p = p+theme(axis.title.y=element_text(angle=90, vjust=6))
  p = p+ theme(plot.margin = unit(c(1,1,1,1), "cm"))
  p = p+theme(plot.title = element_text(hjust = 0.5))
  upperlim = max(LogPlotCounts)+max(LogPlotCounts)*0.65
  tmplim = min(LogPlotCounts)-min(LogPlotCounts)*0.15
  if(round(tmplim,0)==0){
    lowerlim = 0
  }else{
    lowerlim = tmplim
  }
  #Add p-values
  if(Focus == "Glia"){
    Controlp = filt.glia.sig #vs Control
    tmpindex2 = which(rownames(Controlp) == PlotGene[i])
    Controlp = Controlp$padj[tmpindex2]
    Controlp = formatC(Controlp,format = "e",digits = 2)
    if(Controlp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.1),size=0.8)
      p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=1,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.05),size=0.8)
      p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.05),size=0.8)
      pstat = paste("FDR p-value:",Controlp)
      p = p+annotate("text",label=pstat,x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.15)
    }
    
    ONDp = filt.glia.sig.ond #vs OND
    tmpindex3 = which(rownames(ONDp) == PlotGene[i])
    ONDp = ONDp$padj[tmpindex3]
    ONDp = formatC(ONDp,format = "e",digits = 2)
    if(ONDp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.25),size=0.8)
      p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=2,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.2),size=0.8)
      p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.2),size=0.8)
      pstat = paste("FDR p-value:",ONDp)
      p = p+annotate("text",label=pstat,x=2.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.3)
    }
    
    OXp = filt.GO.sig #vs OX
    tmpindex4 = which(rownames(OXp) == PlotGene[i])
    OXp = OXp$padj[tmpindex4]
    OXp = formatC(OXp,format = "e",digits = 2)
    if(OXp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.40,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.40),size=0.8)
      p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.40,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.35),size=0.8)
      p = p+geom_segment(aes(x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.40,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.35),size=0.8)
      pstat = paste("FDR p-value:",OXp)
      p = p+annotate("text",label=pstat,x=3.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.45)
    }
    
    TEp = filt.GT.sig #vs TE
    tmpindex5 = which(rownames(TEp) == PlotGene[i])
    TEp = TEp$padj[tmpindex5]
    TEp = formatC(TEp,format = "e",digits = 2)
    if(TEp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.55),size=0.8)
      p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.50),size=0.8)
      p = p+geom_segment(aes(x=5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.50),size=0.8)
      pstat = paste("FDR p-value:",TEp)
      p = p+annotate("text",label=pstat,x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.6)
    }
    
  }else if(Focus == "Ox"){
    Controlp = filt.ox.sig #vs Control
    tmpindex2 = which(rownames(Controlp) == PlotGene[i])
    Controlp = Controlp$padj[tmpindex2]
    Controlp = formatC(Controlp,format = "e",digits = 2)
    if(Controlp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.1),size=0.8)
      p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=1,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.05),size=0.8)
      p = p+geom_segment(aes(x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.05),size=0.8)
      pstat = paste("FDR p-value:",Controlp)
      p = p+annotate("text",label=pstat,x=2.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.15)
    }
    
    ONDp = filt.ox.sig.ond #vs OND
    tmpindex3 = which(rownames(ONDp) == PlotGene[i])
    ONDp = ONDp$padj[tmpindex3]
    ONDp = formatC(ONDp,format = "e",digits = 2)
    if(ONDp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.25),size=0.8)
      p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=2,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.2),size=0.8)
      p = p+geom_segment(aes(x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.2),size=0.8)
      pstat = paste("FDR p-value:",ONDp)
      p = p+annotate("text",label=pstat,x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.3)
    }
    
    OXp = filt.GO.sig #vs OX
    tmpindex4 = which(rownames(OXp) == PlotGene[i])
    OXp = OXp$padj[tmpindex4]
    OXp = formatC(OXp,format = "e",digits = 2)
    if(OXp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.40,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.40),size=0.8)
      p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.40,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.35),size=0.8)
      p = p+geom_segment(aes(x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.40,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.35),size=0.8)
      pstat = paste("FDR p-value:",OXp)
      p = p+annotate("text",label=pstat,x=3.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.45)
    }
    
    TEp = filt.TO.sig #vs TE
    tmpindex5 = which(rownames(TEp) == PlotGene[i])
    TEp = TEp$padj[tmpindex5]
    TEp = formatC(TEp,format = "e",digits = 2)
    if(TEp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.55),size=0.8)
      p = p+geom_segment(aes(x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.50),size=0.8)
      p = p+geom_segment(aes(x=5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.50),size=0.8)
      pstat = paste("FDR p-value:",TEp)
      p = p+annotate("text",label=pstat,x=4.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.6)
    }
    
  }else if(Focus == "TE"){
    Controlp = filt.TE.sig#vs Control
    tmpindex2 = which(rownames(Controlp) == PlotGene[i])
    Controlp = Controlp$padj[tmpindex2]
    Controlp = formatC(Controlp,format = "e",digits = 2)
    if(Controlp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.1),size=0.8)
      p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=1,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.05),size=0.8)
      p = p+geom_segment(aes(x=5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.05),size=0.8)
      pstat = paste("FDR p-value:",Controlp)
      p = p+annotate("text",label=pstat,x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.15)
    }
    
    ONDp = filt.TE.sig.ond #vs OND
    tmpindex3 = which(rownames(ONDp) == PlotGene[i])
    ONDp = ONDp$padj[tmpindex3]
    ONDp = formatC(ONDp,format = "e",digits = 2)
    if(ONDp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.25),size=0.8)
      p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=2,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.2),size=0.8)
      p = p+geom_segment(aes(x=5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.2),size=0.8)
      pstat = paste("FDR p-value:",ONDp)
      p = p+annotate("text",label=pstat,x=3.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.3)
    }
    
    Gliap = filt.GT.sig #vs Glia
    tmpindex4 = which(rownames(Gliap) == PlotGene[i])
    Gliap = Gliap$padj[tmpindex4]
    Gliap = formatC(Gliap,format = "e",digits = 2)
    if(Gliap>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.40,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.40),size=0.8)
      p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.40,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.35),size=0.8)
      p = p+geom_segment(aes(x=5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.40,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.35),size=0.8)
      pstat = paste("FDR p-value:",Gliap)
      p = p+annotate("text",label=pstat,x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.45)
    }
    
    TEp = filt.TO.sig #vs OX
    tmpindex5 = which(rownames(TEp) == PlotGene[i])
    TEp = TEp$padj[tmpindex5]
    TEp = formatC(TEp,format = "e",digits = 2)
    if(TEp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=4,y=max(PlotCounts)+max(LogPlotCounts)*0.55,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.55),size=0.8)
      p = p+geom_segment(aes(x=4,y=max(PlotCounts)+max(LogPlotCounts)*0.55,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.50),size=0.8)
      p = p+geom_segment(aes(x=5,y=max(PlotCounts)+max(LogPlotCounts)*0.55,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.50),size=0.8)
      pstat = paste("FDR p-value:",TEp)
      p = p+annotate("text",label=pstat,x=4.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.6)
    }
    
  }else if(Focus == "HC"){
    Controlp = filt.COND.sig #vs OND
    tmpindex2 = which(rownames(Controlp) == PlotGene[i])
    Controlp = Controlp$padj[tmpindex2]
    Controlp = formatC(Controlp,format = "e",digits = 2)
    if(Controlp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.1),size=0.8)
      p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=1,yend=max(PlotCounts)+max(PlotCounts)*0.05),size=0.8)
      p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.05),size=0.8)
      pstat = paste("FDR p-value:",Controlp)
      p = p+annotate("text",label=pstat,x=2,y=max(PlotCounts)+max(PlotCounts)*0.15)
    }
    
    Gliap = filt.glia.sig #vs Glia
    tmpindex3 = which(rownames(ONDp) == PlotGene[i])
    ONDp = ONDp$padj[tmpindex3]
    ONDp = formatC(ONDp,format = "e",digits = 2)
    if(ONDp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=2,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.25),size=0.8)
      p = p+geom_segment(aes(x=2,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=2,yend=max(PlotCounts)+max(PlotCounts)*0.2),size=0.8)
      p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.2),size=0.8)
      pstat = paste("FDR p-value:",ONDp)
      p = p+annotate("text",label=pstat,x=2.5,y=max(PlotCounts)+max(PlotCounts)*0.3)
    }
    
    OXp = filt.ox.sig #vs OX
    tmpindex4 = which(rownames(OXp) == PlotGene[i])
    OXp = OXp$padj[tmpindex4]
    OXp = formatC(OXp,format = "e",digits = 2)
    if(OXp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.40,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.40),size=0.8)
      p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.40,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.35),size=0.8)
      p = p+geom_segment(aes(x=4,y=max(PlotCounts)+max(PlotCounts)*0.40,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.35),size=0.8)
      pstat = paste("FDR p-value:",OXp)
      p = p+annotate("text",label=pstat,x=3.5,y=max(PlotCounts)+max(PlotCounts)*0.45)
    }
    
    TEp = filt.TE.sig #vs TE
    tmpindex5 = which(rownames(TEp) == PlotGene[i])
    TEp = TEp$padj[tmpindex5]
    TEp = formatC(TEp,format = "e",digits = 2)
    if(TEp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.55),size=0.8)
      p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.50),size=0.8)
      p = p+geom_segment(aes(x=5,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.50),size=0.8)
      pstat = paste("FDR p-value:",TEp)
      p = p+annotate("text",label=pstat,x=4,y=max(PlotCounts)+max(PlotCounts)*0.6)
    }
    
  }else if(Focus == "All"){
    
    #Reset axis limits
    upperlim = max(LogPlotCounts)+max(LogPlotCounts)*0.65
    tmplim = min(LogPlotCounts)-min(LogPlotCounts)*0.15
    if(round(tmplim,0)==0){
      lowerlim = 0
    }else{
      lowerlim = tmplim
    }
    
    #Get Subtype with max counts as reference level - all comparisons is too busy
    GCounts = NormCounts[,GliaI]
    OCounts = NormCounts[,OxI]
    TCounts = NormCounts[,TEI]
    HCounts = NormCounts[,HCI]
    ONDCounts = NormCounts[,ONDI]
    
    Gavg = mean(GCounts[tmpindex,])
    Oavg = mean(OCounts[tmpindex,])
    Tavg = mean(TCounts[tmpindex,])
    Havg = mean(HCounts[tmpindex,])
    ONDavg = mean(ONDCounts[tmpindex,])
    
    reflev = max(c(Gavg,Oavg,Tavg,Havg,ONDavg))
    
    if(Gavg == reflev){
      
      Controlp = filt.glia.sig #vs Control
      tmpindex2 = which(rownames(Controlp) == PlotGene[i])
      Controlp = Controlp$padj[tmpindex2]
      Controlp = formatC(Controlp,format = "e",digits = 2)
      if(Controlp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.1),size=0.8)
        p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=1,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.05),size=0.8)
        p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.05),size=0.8)
        pstat = paste("FDR p-value:",Controlp)
        p = p+annotate("text",label=pstat,x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.15)
      }
      
      ONDp = filt.glia.sig.ond #vs OND
      tmpindex3 = which(rownames(ONDp) == PlotGene[i])
      ONDp = ONDp$padj[tmpindex3]
      ONDp = formatC(ONDp,format = "e",digits = 2)
      if(ONDp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.25),size=0.8)
        p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=2,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.2),size=0.8)
        p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.2),size=0.8)
        pstat = paste("FDR p-value:",ONDp)
        p = p+annotate("text",label=pstat,x=2.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.3)
      }
      
      OXp = filt.GO.sig #vs OX
      tmpindex4 = which(rownames(OXp) == PlotGene[i])
      OXp = OXp$padj[tmpindex4]
      OXp = formatC(OXp,format = "e",digits = 2)
      if(OXp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.40,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.40),size=0.8)
        p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.40,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.35),size=0.8)
        p = p+geom_segment(aes(x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.40,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.35),size=0.8)
        pstat = paste("FDR p-value:",OXp)
        p = p+annotate("text",label=pstat,x=3.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.45)
      }
      
      TEp = filt.GT.sig #vs TE
      tmpindex5 = which(rownames(TEp) == PlotGene[i])
      TEp = TEp$padj[tmpindex5]
      TEp = formatC(TEp,format = "e",digits = 2)
      if(TEp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.55),size=0.8)
        p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.50),size=0.8)
        p = p+geom_segment(aes(x=5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.50),size=0.8)
        pstat = paste("FDR p-value:",TEp)
        p = p+annotate("text",label=pstat,x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.6)
      }
      
      
    }else if(Oavg == reflev){
      
      Controlp = filt.ox.sig #vs Control
      tmpindex2 = which(rownames(Controlp) == PlotGene[i])
      Controlp = Controlp$padj[tmpindex2]
      Controlp = formatC(Controlp,format = "e",digits = 2)
      if(Controlp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.1),size=0.8)
        p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=1,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.05),size=0.8)
        p = p+geom_segment(aes(x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.05),size=0.8)
        pstat = paste("FDR p-value:",Controlp)
        p = p+annotate("text",label=pstat,x=2.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.15)
      }
      
      ONDp = filt.ox.sig.ond #vs OND
      tmpindex3 = which(rownames(ONDp) == PlotGene[i])
      ONDp = ONDp$padj[tmpindex3]
      ONDp = formatC(ONDp,format = "e",digits = 2)
      if(ONDp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.25),size=0.8)
        p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=2,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.2),size=0.8)
        p = p+geom_segment(aes(x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.2),size=0.8)
        pstat = paste("FDR p-value:",ONDp)
        p = p+annotate("text",label=pstat,x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.3)
      }
      
      Gliap = filt.GO.sig #vs Glia
      tmpindex4 = which(rownames(Gliap) == PlotGene[i])
      Gliap = Gliap$padj[tmpindex4]
      Gliap = formatC(Gliap,format = "e",digits = 2)
      if(Gliap>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.40,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.40),size=0.8)
        p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.40,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.35),size=0.8)
        p = p+geom_segment(aes(x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.40,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.35),size=0.8)
        pstat = paste("FDR p-value:",Gliap)
        p = p+annotate("text",label=pstat,x=3.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.45)
      }
      
      TEp = filt.TO.sig #vs TE
      tmpindex5 = which(rownames(TEp) == PlotGene[i])
      TEp = TEp$padj[tmpindex5]
      TEp = formatC(TEp,format = "e",digits = 2)
      if(TEp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.55),size=0.8)
        p = p+geom_segment(aes(x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.50),size=0.8)
        p = p+geom_segment(aes(x=5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.50),size=0.8)
        pstat = paste("FDR p-value:",TEp)
        p = p+annotate("text",label=pstat,x=4.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.6)
      }
      
    }else if(Tavg == reflev){
      
      Controlp = filt.TE.sig #vs Control
      tmpindex2 = which(rownames(Controlp) == PlotGene[i])
      Controlp = Controlp$padj[tmpindex2]
      Controlp = formatC(Controlp,format = "e",digits = 2)
      if(Controlp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.1),size=0.8)
        p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=1,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.05),size=0.8)
        p = p+geom_segment(aes(x=5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.05),size=0.8)
        pstat = paste("FDR p-value:",Controlp)
        p = p+annotate("text",label=pstat,x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.15)
      }
      
      ONDp = filt.TE.sig.ond #vs OND
      tmpindex3 = which(rownames(ONDp) == PlotGene[i])
      ONDp = ONDp$padj[tmpindex3]
      ONDp = formatC(ONDp,format = "e",digits = 2)
      if(ONDp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.25),size=0.8)
        p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=2,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.2),size=0.8)
        p = p+geom_segment(aes(x=5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.2),size=0.8)
        pstat = paste("FDR p-value:",ONDp)
        p = p+annotate("text",label=pstat,x=3.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.3)
      }
      
      Gliap = filt.GT.sig #vs Glia
      tmpindex4 = which(rownames(Gliap) == PlotGene[i])
      Gliap = Gliap$padj[tmpindex4]
      Gliap = formatC(Gliap,format = "e",digits = 2)
      if(Gliap>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.40,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.40),size=0.8)
        p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.40,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.35),size=0.8)
        p = p+geom_segment(aes(x=5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.40,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.35),size=0.8)
        pstat = paste("FDR p-value:",Gliap)
        p = p+annotate("text",label=pstat,x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.45)
      }
      
      TEp = filt.TO.sig #vs OX
      tmpindex5 = which(rownames(TEp) == PlotGene[i])
      TEp = TEp$padj[tmpindex5]
      TEp = formatC(TEp,format = "e",digits = 2)
      if(TEp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.55),size=0.8)
        p = p+geom_segment(aes(x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.50),size=0.8)
        p = p+geom_segment(aes(x=5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.50),size=0.8)
        pstat = paste("FDR p-value:",TEp)
        p = p+annotate("text",label=pstat,x=4.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.6)
      }
      
    }else if(Havg == reflev){
      
      ONDp = filt.COND.sig #vs OND
      tmpindex3 = which(rownames(ONDp) == PlotGene[i])
      ONDp = ONDp$padj[tmpindex3]
      ONDp = formatC(ONDp,format = "e",digits = 2)
      if(ONDp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=2,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.1),size=0.8)
        p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=1,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.05),size=0.8)
        p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=2,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.05),size=0.8)
        pstat = paste("FDR p-value:",ONDp)
        p = p+annotate("text",label=pstat,x=1.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.15)
      }
      
      Gliap = filt.glia.sig #vs Control
      tmpindex2 = which(rownames(Gliap) == PlotGene[i])
      Gliap = Gliap$padj[tmpindex2]
      Gliap = formatC(Gliap,format = "e",digits = 2)
      if(Gliap>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.25),size=0.8)
        p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=1,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.2),size=0.8)
        p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.2),size=0.8)
        pstat = paste("FDR p-value:",Gliap)
        p = p+annotate("text",label=pstat,x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.3)
      }
      
      OXp = filt.ox.sig #vs Control
      tmpindex2 = which(rownames(OXp) == PlotGene[i])
      OXp = OXp$padj[tmpindex2]
      OXp = formatC(OXp,format = "e",digits = 2)
      if(OXp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.4,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.4),size=0.8)
        p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.4,xend=1,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.35),size=0.8)
        p = p+geom_segment(aes(x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.4,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.35),size=0.8)
        pstat = paste("FDR p-value:",OXp)
        p = p+annotate("text",label=pstat,x=2.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.45)
      }
      
      TEp = filt.TE.sig#vs Control
      tmpindex2 = which(rownames(TEp) == PlotGene[i])
      TEp = TEp$padj[tmpindex2]
      TEp = formatC(TEp,format = "e",digits = 2)
      if(TEp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.55),size=0.8)
        p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=1,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.5),size=0.8)
        p = p+geom_segment(aes(x=5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.5),size=0.8)
        pstat = paste("FDR p-value:",TEp)
        p = p+annotate("text",label=pstat,x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.6)
      }
      
    }else if(ONDavg == reflev){
      
      Controlp = filt.COND.sig #vs OND
      tmpindex3 = which(rownames(Controlp) == PlotGene[i])
      Controlp = Controlp$padj[tmpindex3]
      Controlp = formatC(Controlp,format = "e",digits = 2)
      if(Controlp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=2,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.1),size=0.8)
        p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=1,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.05),size=0.8)
        p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=2,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.05),size=0.8)
        pstat = paste("FDR p-value:",Controlp)
        p = p+annotate("text",label=pstat,x=1.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.15)
      }
      
      Gliap = filt.glia.sig.ond #vs Control
      tmpindex2 = which(rownames(Gliap) == PlotGene[i])
      Gliap = Gliap$padj[tmpindex2]
      Gliap = formatC(Gliap,format = "e",digits = 2)
      if(Gliap>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.25),size=0.8)
        p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=2,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.2),size=0.8)
        p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.2),size=0.8)
        pstat = paste("FDR p-value:",Gliap)
        p = p+annotate("text",label=pstat,x=2.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.30)
      }
      
      OXp = filt.ox.sig.ond #vs Control
      tmpindex2 = which(rownames(OXp) == PlotGene[i])
      OXp = OXp$padj[tmpindex2]
      OXp = formatC(OXp,format = "e",digits = 2)
      if(OXp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.4,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.4),size=0.8)
        p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.4,xend=2,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.35),size=0.8)
        p = p+geom_segment(aes(x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.4,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.35),size=0.8)
        pstat = paste("FDR p-value:",OXp)
        p = p+annotate("text",label=pstat,x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.45)
      }
      
      TEp = filt.TE.sig.ond #vs Control
      tmpindex2 = which(rownames(TEp) == PlotGene[i])
      TEp = TEp$padj[tmpindex2]
      TEp = formatC(TEp,format = "e",digits = 2)
      if(TEp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.55),size=0.8)
        p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=2,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.5),size=0.8)
        p = p+geom_segment(aes(x=5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.5),size=0.8)
        pstat = paste("FDR p-value:",TEp)
        p = p+annotate("text",label=pstat,x=3.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.6)
      }
      
    }else(
      cat("Unknown Error")
    )
    
    
  }else{
    cat("Focus not specified, p-values not added to the plot")
  }
  print(p)
  
  ##Violin
  
  #Norm Count Scale
  p = ggplot(dat,aes(x=Subtype,y=PlotCounts,fill=Subtype)) + geom_violin()
  ttl = paste(PlotGene[i])
  p = p +ggtitle(ttl) + xlab("Subtype") + ylab("Median-of-Ratios Counts")
  p = p+scale_x_discrete(limits=c("Control","OND","ALS-Glia","ALS-Ox","ALS-TE"))
  p = p+scale_fill_manual(values = c("gray50","gray30","goldenrod1","navy","firebrick"))
  p = p+theme(axis.text = element_text(size=16), axis.title = element_text(size=18),plot.title = element_text(size=18),legend.text = element_text(size=14),legend.title = element_text(size=14))
  p = p+theme(panel.background = element_rect(fill = "gray90",colour = "gray80",size = 0.5,linetype = "solid"),panel.grid.major = element_line(size = 0.35,linetype = "solid",colour = "gray80"),panel.grid.minor = element_line(size = 0.15,linetype = "solid",colour = "gray80"))
  p = p+geom_dotplot(binaxis = 'y',stackdir = 'center',dotsize = 0.25,fill="white",stackratio = 0.75)
  p = p+theme(axis.title.x=element_text(vjust=-2))
  p = p+theme(axis.title.y=element_text(angle=90, vjust=6))
  p = p+ theme(plot.margin = unit(c(1,1,1,1), "cm"))
  p = p+theme(plot.title = element_text(hjust = 0.5))
  upperlim = max(PlotCounts)+max(PlotCounts)*0.65
  tmplim = min(PlotCounts)-min(PlotCounts)*0.15
  if(round(tmplim,0)==0){
    lowerlim = 0
  }else{
    lowerlim = tmplim
  }
  #Add p-values
  if(Focus == "Glia"){
    Controlp = filt.glia.sig #vs Control
    tmpindex2 = which(rownames(Controlp) == PlotGene[i])
    Controlp = Controlp$padj[tmpindex2]
    Controlp = formatC(Controlp,format = "e",digits = 2)
    if(Controlp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.1),size=0.8)
      p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=1,yend=max(PlotCounts)+max(PlotCounts)*0.05),size=0.8)
      p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.05),size=0.8)
      pstat = paste("FDR p-value:",Controlp)
      p = p+annotate("text",label=pstat,x=2,y=max(PlotCounts)+max(PlotCounts)*0.15)
    }
    
    ONDp = filt.glia.sig.ond #vs OND
    tmpindex3 = which(rownames(ONDp) == PlotGene[i])
    ONDp = ONDp$padj[tmpindex3]
    ONDp = formatC(ONDp,format = "e",digits = 2)
    if(ONDp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=2,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.25),size=0.8)
      p = p+geom_segment(aes(x=2,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=2,yend=max(PlotCounts)+max(PlotCounts)*0.2),size=0.8)
      p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.2),size=0.8)
      pstat = paste("FDR p-value:",ONDp)
      p = p+annotate("text",label=pstat,x=2.5,y=max(PlotCounts)+max(PlotCounts)*0.3)
    }
    
    OXp = filt.GO.sig #vs OX
    tmpindex4 = which(rownames(OXp) == PlotGene[i])
    OXp = OXp$padj[tmpindex4]
    OXp = formatC(OXp,format = "e",digits = 2)
    if(OXp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.40,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.40),size=0.8)
      p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.40,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.35),size=0.8)
      p = p+geom_segment(aes(x=4,y=max(PlotCounts)+max(PlotCounts)*0.40,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.35),size=0.8)
      pstat = paste("FDR p-value:",OXp)
      p = p+annotate("text",label=pstat,x=3.5,y=max(PlotCounts)+max(PlotCounts)*0.45)
    }
    
    TEp = filt.GT.sig #vs TE
    tmpindex5 = which(rownames(TEp) == PlotGene[i])
    TEp = TEp$padj[tmpindex5]
    TEp = formatC(TEp,format = "e",digits = 2)
    if(TEp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.55),size=0.8)
      p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.50),size=0.8)
      p = p+geom_segment(aes(x=5,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.50),size=0.8)
      pstat = paste("FDR p-value:",TEp)
      p = p+annotate("text",label=pstat,x=4,y=max(PlotCounts)+max(PlotCounts)*0.6)
    }
    
  }else if(Focus == "Ox"){
    Controlp = filt.ox.sig #vs Control
    tmpindex2 = which(rownames(Controlp) == PlotGene[i])
    Controlp = Controlp$padj[tmpindex2]
    Controlp = formatC(Controlp,format = "e",digits = 2)
    if(Controlp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.1),size=0.8)
      p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=1,yend=max(PlotCounts)+max(PlotCounts)*0.05),size=0.8)
      p = p+geom_segment(aes(x=4,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.05),size=0.8)
      pstat = paste("FDR p-value:",Controlp)
      p = p+annotate("text",label=pstat,x=2.5,y=max(PlotCounts)+max(PlotCounts)*0.15)
    }
    
    ONDp = filt.ox.sig.ond #vs OND
    tmpindex3 = which(rownames(ONDp) == PlotGene[i])
    ONDp = ONDp$padj[tmpindex3]
    ONDp = formatC(ONDp,format = "e",digits = 2)
    if(ONDp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=2,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.25),size=0.8)
      p = p+geom_segment(aes(x=2,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=2,yend=max(PlotCounts)+max(PlotCounts)*0.2),size=0.8)
      p = p+geom_segment(aes(x=4,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.2),size=0.8)
      pstat = paste("FDR p-value:",ONDp)
      p = p+annotate("text",label=pstat,x=3,y=max(PlotCounts)+max(PlotCounts)*0.3)
    }
    
    OXp = filt.GO.sig #vs OX
    tmpindex4 = which(rownames(OXp) == PlotGene[i])
    OXp = OXp$padj[tmpindex4]
    OXp = formatC(OXp,format = "e",digits = 2)
    if(OXp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.40,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.40),size=0.8)
      p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.40,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.35),size=0.8)
      p = p+geom_segment(aes(x=4,y=max(PlotCounts)+max(PlotCounts)*0.40,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.35),size=0.8)
      pstat = paste("FDR p-value:",OXp)
      p = p+annotate("text",label=pstat,x=3.5,y=max(PlotCounts)+max(PlotCounts)*0.45)
    }
    
    TEp = filt.TO.sig #vs TE
    tmpindex5 = which(rownames(TEp) == PlotGene[i])
    TEp = TEp$padj[tmpindex5]
    TEp = formatC(TEp,format = "e",digits = 2)
    if(TEp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=4,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.55),size=0.8)
      p = p+geom_segment(aes(x=4,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.50),size=0.8)
      p = p+geom_segment(aes(x=5,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.50),size=0.8)
      pstat = paste("FDR p-value:",TEp)
      p = p+annotate("text",label=pstat,x=4.5,y=max(PlotCounts)+max(PlotCounts)*0.6)
    }
    
  }else if(Focus == "TE"){
    Controlp = filt.TE.sig#vs Control
    tmpindex2 = which(rownames(Controlp) == PlotGene[i])
    Controlp = Controlp$padj[tmpindex2]
    Controlp = formatC(Controlp,format = "e",digits = 2)
    if(Controlp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.1),size=0.8)
      p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=1,yend=max(PlotCounts)+max(PlotCounts)*0.05),size=0.8)
      p = p+geom_segment(aes(x=5,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.05),size=0.8)
      pstat = paste("FDR p-value:",Controlp)
      p = p+annotate("text",label=pstat,x=3,y=max(PlotCounts)+max(PlotCounts)*0.15)
    }
    
    ONDp = filt.TE.sig.ond #vs OND
    tmpindex3 = which(rownames(ONDp) == PlotGene[i])
    ONDp = ONDp$padj[tmpindex3]
    ONDp = formatC(ONDp,format = "e",digits = 2)
    if(ONDp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=2,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.25),size=0.8)
      p = p+geom_segment(aes(x=2,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=2,yend=max(PlotCounts)+max(PlotCounts)*0.2),size=0.8)
      p = p+geom_segment(aes(x=5,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.2),size=0.8)
      pstat = paste("FDR p-value:",ONDp)
      p = p+annotate("text",label=pstat,x=3.5,y=max(PlotCounts)+max(PlotCounts)*0.3)
    }
    
    Gliap = filt.GT.sig #vs Glia
    tmpindex4 = which(rownames(Gliap) == PlotGene[i])
    Gliap = Gliap$padj[tmpindex4]
    Gliap = formatC(Gliap,format = "e",digits = 2)
    if(Gliap>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.40,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.40),size=0.8)
      p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.40,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.35),size=0.8)
      p = p+geom_segment(aes(x=5,y=max(PlotCounts)+max(PlotCounts)*0.40,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.35),size=0.8)
      pstat = paste("FDR p-value:",Gliap)
      p = p+annotate("text",label=pstat,x=4,y=max(PlotCounts)+max(PlotCounts)*0.45)
    }
    
    TEp = filt.TO.sig #vs OX
    tmpindex5 = which(rownames(TEp) == PlotGene[i])
    TEp = TEp$padj[tmpindex5]
    TEp = formatC(TEp,format = "e",digits = 2)
    if(TEp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=4,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.55),size=0.8)
      p = p+geom_segment(aes(x=4,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.50),size=0.8)
      p = p+geom_segment(aes(x=5,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.50),size=0.8)
      pstat = paste("FDR p-value:",TEp)
      p = p+annotate("text",label=pstat,x=4.5,y=max(PlotCounts)+max(PlotCounts)*0.6)
    }
  
  }else if(Focus == "HC"){
    Controlp = filt.COND.sig #vs OND
    tmpindex2 = which(rownames(Controlp) == PlotGene[i])
    Controlp = Controlp$padj[tmpindex2]
    Controlp = formatC(Controlp,format = "e",digits = 2)
    if(Controlp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.1),size=0.8)
      p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=1,yend=max(PlotCounts)+max(PlotCounts)*0.05),size=0.8)
      p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.05),size=0.8)
      pstat = paste("FDR p-value:",Controlp)
      p = p+annotate("text",label=pstat,x=2,y=max(PlotCounts)+max(PlotCounts)*0.15)
    }
    
    Gliap = filt.glia.sig #vs Glia
    tmpindex3 = which(rownames(ONDp) == PlotGene[i])
    ONDp = ONDp$padj[tmpindex3]
    ONDp = formatC(ONDp,format = "e",digits = 2)
    if(ONDp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=2,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.25),size=0.8)
      p = p+geom_segment(aes(x=2,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=2,yend=max(PlotCounts)+max(PlotCounts)*0.2),size=0.8)
      p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.2),size=0.8)
      pstat = paste("FDR p-value:",ONDp)
      p = p+annotate("text",label=pstat,x=2.5,y=max(PlotCounts)+max(PlotCounts)*0.3)
    }
    
    OXp = filt.ox.sig #vs OX
    tmpindex4 = which(rownames(OXp) == PlotGene[i])
    OXp = OXp$padj[tmpindex4]
    OXp = formatC(OXp,format = "e",digits = 2)
    if(OXp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.40,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.40),size=0.8)
      p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.40,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.35),size=0.8)
      p = p+geom_segment(aes(x=4,y=max(PlotCounts)+max(PlotCounts)*0.40,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.35),size=0.8)
      pstat = paste("FDR p-value:",OXp)
      p = p+annotate("text",label=pstat,x=3.5,y=max(PlotCounts)+max(PlotCounts)*0.45)
    }
    
    TEp = filt.TE.sig #vs TE
    tmpindex5 = which(rownames(TEp) == PlotGene[i])
    TEp = TEp$padj[tmpindex5]
    TEp = formatC(TEp,format = "e",digits = 2)
    if(TEp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.55),size=0.8)
      p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.50),size=0.8)
      p = p+geom_segment(aes(x=5,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.50),size=0.8)
      pstat = paste("FDR p-value:",TEp)
      p = p+annotate("text",label=pstat,x=4,y=max(PlotCounts)+max(PlotCounts)*0.6)
    }
    
  }else if(Focus == "All"){
    
    #Reset axis limits
    upperlim = max(PlotCounts)+max(PlotCounts)*0.65
    tmplim = min(PlotCounts)-min(PlotCounts)*0.15
    if(round(tmplim,0)==0){
      lowerlim = 0
    }else{
      lowerlim = tmplim
    }
    
    #Get Subtype with max counts as reference level - all comparisons is too busy
    GCounts = NormCounts[,GliaI]
    OCounts = NormCounts[,OxI]
    TCounts = NormCounts[,TEI]
    HCounts = NormCounts[,HCI]
    ONDCounts = NormCounts[,ONDI]
    
    Gavg = mean(GCounts[tmpindex,])
    Oavg = mean(OCounts[tmpindex,])
    Tavg = mean(TCounts[tmpindex,])
    Havg = mean(HCounts[tmpindex,])
    ONDavg = mean(ONDCounts[tmpindex,])
    
    reflev = max(c(Gavg,Oavg,Tavg,Havg,ONDavg))
    
    if(Gavg == reflev){
      
      Controlp = filt.glia.sig #vs Control
      tmpindex2 = which(rownames(Controlp) == PlotGene[i])
      Controlp = Controlp$padj[tmpindex2]
      Controlp = formatC(Controlp,format = "e",digits = 2)
      if(Controlp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.1),size=0.8)
        p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=1,yend=max(PlotCounts)+max(PlotCounts)*0.05),size=0.8)
        p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.05),size=0.8)
        pstat = paste("FDR p-value:",Controlp)
        p = p+annotate("text",label=pstat,x=2,y=max(PlotCounts)+max(PlotCounts)*0.15)
      }
      
      ONDp = filt.glia.sig.ond #vs OND
      tmpindex3 = which(rownames(ONDp) == PlotGene[i])
      ONDp = ONDp$padj[tmpindex3]
      ONDp = formatC(ONDp,format = "e",digits = 2)
      if(ONDp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=2,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.25),size=0.8)
        p = p+geom_segment(aes(x=2,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=2,yend=max(PlotCounts)+max(PlotCounts)*0.2),size=0.8)
        p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.2),size=0.8)
        pstat = paste("FDR p-value:",ONDp)
        p = p+annotate("text",label=pstat,x=2.5,y=max(PlotCounts)+max(PlotCounts)*0.3)
      }
      
      OXp = filt.GO.sig #vs OX
      tmpindex4 = which(rownames(OXp) == PlotGene[i])
      OXp = OXp$padj[tmpindex4]
      OXp = formatC(OXp,format = "e",digits = 2)
      if(OXp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.40,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.40),size=0.8)
        p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.40,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.35),size=0.8)
        p = p+geom_segment(aes(x=4,y=max(PlotCounts)+max(PlotCounts)*0.40,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.35),size=0.8)
        pstat = paste("FDR p-value:",OXp)
        p = p+annotate("text",label=pstat,x=3.5,y=max(PlotCounts)+max(PlotCounts)*0.45)
      }
      
      TEp = filt.GT.sig #vs TE
      tmpindex5 = which(rownames(TEp) == PlotGene[i])
      TEp = TEp$padj[tmpindex5]
      TEp = formatC(TEp,format = "e",digits = 2)
      if(TEp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.55),size=0.8)
        p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.50),size=0.8)
        p = p+geom_segment(aes(x=5,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.50),size=0.8)
        pstat = paste("FDR p-value:",TEp)
        p = p+annotate("text",label=pstat,x=4,y=max(PlotCounts)+max(PlotCounts)*0.6)
      }
      
      
    }else if(Oavg == reflev){
      
      Controlp = filt.ox.sig #vs Control
      tmpindex2 = which(rownames(Controlp) == PlotGene[i])
      Controlp = Controlp$padj[tmpindex2]
      Controlp = formatC(Controlp,format = "e",digits = 2)
      if(Controlp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.1),size=0.8)
        p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=1,yend=max(PlotCounts)+max(PlotCounts)*0.05),size=0.8)
        p = p+geom_segment(aes(x=4,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.05),size=0.8)
        pstat = paste("FDR p-value:",Controlp)
        p = p+annotate("text",label=pstat,x=2.5,y=max(PlotCounts)+max(PlotCounts)*0.15)
      }
      
      ONDp = filt.ox.sig.ond #vs OND
      tmpindex3 = which(rownames(ONDp) == PlotGene[i])
      ONDp = ONDp$padj[tmpindex3]
      ONDp = formatC(ONDp,format = "e",digits = 2)
      if(ONDp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=2,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.25),size=0.8)
        p = p+geom_segment(aes(x=2,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=2,yend=max(PlotCounts)+max(PlotCounts)*0.2),size=0.8)
        p = p+geom_segment(aes(x=4,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.2),size=0.8)
        pstat = paste("FDR p-value:",ONDp)
        p = p+annotate("text",label=pstat,x=3,y=max(PlotCounts)+max(PlotCounts)*0.3)
      }
      
      Gliap = filt.GO.sig #vs Glia
      tmpindex4 = which(rownames(Gliap) == PlotGene[i])
      Gliap = Gliap$padj[tmpindex4]
      Gliap = formatC(Gliap,format = "e",digits = 2)
      if(Gliap>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.40,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.40),size=0.8)
        p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.40,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.35),size=0.8)
        p = p+geom_segment(aes(x=4,y=max(PlotCounts)+max(PlotCounts)*0.40,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.35),size=0.8)
        pstat = paste("FDR p-value:",Gliap)
        p = p+annotate("text",label=pstat,x=3.5,y=max(PlotCounts)+max(PlotCounts)*0.45)
      }
      
      TEp = filt.TO.sig #vs TE
      tmpindex5 = which(rownames(TEp) == PlotGene[i])
      TEp = TEp$padj[tmpindex5]
      TEp = formatC(TEp,format = "e",digits = 2)
      if(TEp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=4,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.55),size=0.8)
        p = p+geom_segment(aes(x=4,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.50),size=0.8)
        p = p+geom_segment(aes(x=5,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.50),size=0.8)
        pstat = paste("FDR p-value:",TEp)
        p = p+annotate("text",label=pstat,x=4.5,y=max(PlotCounts)+max(PlotCounts)*0.6)
      }
      
    }else if(Tavg == reflev){
      
      Controlp = filt.TE.sig #vs Control
      tmpindex2 = which(rownames(Controlp) == PlotGene[i])
      Controlp = Controlp$padj[tmpindex2]
      Controlp = formatC(Controlp,format = "e",digits = 2)
      if(Controlp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.1),size=0.8)
        p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=1,yend=max(PlotCounts)+max(PlotCounts)*0.05),size=0.8)
        p = p+geom_segment(aes(x=5,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.05),size=0.8)
        pstat = paste("FDR p-value:",Controlp)
        p = p+annotate("text",label=pstat,x=3,y=max(PlotCounts)+max(PlotCounts)*0.15)
      }
      
      ONDp = filt.TE.sig.ond #vs OND
      tmpindex3 = which(rownames(ONDp) == PlotGene[i])
      ONDp = ONDp$padj[tmpindex3]
      ONDp = formatC(ONDp,format = "e",digits = 2)
      if(ONDp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=2,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.25),size=0.8)
        p = p+geom_segment(aes(x=2,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=2,yend=max(PlotCounts)+max(PlotCounts)*0.2),size=0.8)
        p = p+geom_segment(aes(x=5,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.2),size=0.8)
        pstat = paste("FDR p-value:",ONDp)
        p = p+annotate("text",label=pstat,x=3.5,y=max(PlotCounts)+max(PlotCounts)*0.3)
      }
      
      Gliap = filt.GT.sig #vs Glia
      tmpindex4 = which(rownames(Gliap) == PlotGene[i])
      Gliap = Gliap$padj[tmpindex4]
      Gliap = formatC(Gliap,format = "e",digits = 2)
      if(Gliap>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.40,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.40),size=0.8)
        p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.40,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.35),size=0.8)
        p = p+geom_segment(aes(x=5,y=max(PlotCounts)+max(PlotCounts)*0.40,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.35),size=0.8)
        pstat = paste("FDR p-value:",Gliap)
        p = p+annotate("text",label=pstat,x=4,y=max(PlotCounts)+max(PlotCounts)*0.45)
      }
      
      TEp = filt.TO.sig #vs OX
      tmpindex5 = which(rownames(TEp) == PlotGene[i])
      TEp = TEp$padj[tmpindex5]
      TEp = formatC(TEp,format = "e",digits = 2)
      if(TEp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=4,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.55),size=0.8)
        p = p+geom_segment(aes(x=4,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.50),size=0.8)
        p = p+geom_segment(aes(x=5,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.50),size=0.8)
        pstat = paste("FDR p-value:",TEp)
        p = p+annotate("text",label=pstat,x=4.5,y=max(PlotCounts)+max(PlotCounts)*0.6)
      }
      
    }else if(Havg == reflev){
      
      ONDp = filt.COND.sig #vs OND
      tmpindex3 = which(rownames(ONDp) == PlotGene[i])
      ONDp = ONDp$padj[tmpindex3]
      ONDp = formatC(ONDp,format = "e",digits = 2)
      if(ONDp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=2,yend=max(PlotCounts)+max(PlotCounts)*0.1),size=0.8)
        p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=1,yend=max(PlotCounts)+max(PlotCounts)*0.05),size=0.8)
        p = p+geom_segment(aes(x=2,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=2,yend=max(PlotCounts)+max(PlotCounts)*0.05),size=0.8)
        pstat = paste("FDR p-value:",ONDp)
        p = p+annotate("text",label=pstat,x=1.5,y=max(PlotCounts)+max(PlotCounts)*0.15)
      }
      
      Gliap = filt.glia.sig #vs Control
      tmpindex2 = which(rownames(Gliap) == PlotGene[i])
      Gliap = Gliap$padj[tmpindex2]
      Gliap = formatC(Gliap,format = "e",digits = 2)
      if(Gliap>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.25),size=0.8)
        p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=1,yend=max(PlotCounts)+max(PlotCounts)*0.2),size=0.8)
        p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.2),size=0.8)
        pstat = paste("FDR p-value:",Gliap)
        p = p+annotate("text",label=pstat,x=2,y=max(PlotCounts)+max(PlotCounts)*0.3)
      }
      
      OXp = filt.ox.sig #vs Control
      tmpindex2 = which(rownames(OXp) == PlotGene[i])
      OXp = OXp$padj[tmpindex2]
      OXp = formatC(OXp,format = "e",digits = 2)
      if(OXp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.4,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.4),size=0.8)
        p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.4,xend=1,yend=max(PlotCounts)+max(PlotCounts)*0.35),size=0.8)
        p = p+geom_segment(aes(x=4,y=max(PlotCounts)+max(PlotCounts)*0.4,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.35),size=0.8)
        pstat = paste("FDR p-value:",OXp)
        p = p+annotate("text",label=pstat,x=2.5,y=max(PlotCounts)+max(PlotCounts)*0.45)
      }
      
      TEp = filt.TE.sig#vs Control
      tmpindex2 = which(rownames(TEp) == PlotGene[i])
      TEp = TEp$padj[tmpindex2]
      TEp = formatC(TEp,format = "e",digits = 2)
      if(TEp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.55),size=0.8)
        p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=1,yend=max(PlotCounts)+max(PlotCounts)*0.5),size=0.8)
        p = p+geom_segment(aes(x=5,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.5),size=0.8)
        pstat = paste("FDR p-value:",TEp)
        p = p+annotate("text",label=pstat,x=3,y=max(PlotCounts)+max(PlotCounts)*0.6)
      }
      
    }else if(ONDavg == reflev){
      
      Controlp = filt.COND.sig #vs OND
      tmpindex3 = which(rownames(Controlp) == PlotGene[i])
      Controlp = Controlp$padj[tmpindex3]
      Controlp = formatC(Controlp,format = "e",digits = 2)
      if(Controlp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=2,yend=max(PlotCounts)+max(PlotCounts)*0.1),size=0.8)
        p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=1,yend=max(PlotCounts)+max(PlotCounts)*0.05),size=0.8)
        p = p+geom_segment(aes(x=2,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=2,yend=max(PlotCounts)+max(PlotCounts)*0.05),size=0.8)
        pstat = paste("FDR p-value:",Controlp)
        p = p+annotate("text",label=pstat,x=1.5,y=max(PlotCounts)+max(PlotCounts)*0.15)
      }
      
      Gliap = filt.glia.sig.ond #vs Control
      tmpindex2 = which(rownames(Gliap) == PlotGene[i])
      Gliap = Gliap$padj[tmpindex2]
      Gliap = formatC(Gliap,format = "e",digits = 2)
      if(Gliap>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=2,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.25),size=0.8)
        p = p+geom_segment(aes(x=2,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=2,yend=max(PlotCounts)+max(PlotCounts)*0.2),size=0.8)
        p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.2),size=0.8)
        pstat = paste("FDR p-value:",Gliap)
        p = p+annotate("text",label=pstat,x=2.5,y=max(PlotCounts)+max(PlotCounts)*0.30)
      }
      
      OXp = filt.ox.sig.ond #vs Control
      tmpindex2 = which(rownames(OXp) == PlotGene[i])
      OXp = OXp$padj[tmpindex2]
      OXp = formatC(OXp,format = "e",digits = 2)
      if(OXp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=2,y=max(PlotCounts)+max(PlotCounts)*0.4,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.4),size=0.8)
        p = p+geom_segment(aes(x=2,y=max(PlotCounts)+max(PlotCounts)*0.4,xend=2,yend=max(PlotCounts)+max(PlotCounts)*0.35),size=0.8)
        p = p+geom_segment(aes(x=4,y=max(PlotCounts)+max(PlotCounts)*0.4,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.35),size=0.8)
        pstat = paste("FDR p-value:",OXp)
        p = p+annotate("text",label=pstat,x=3,y=max(PlotCounts)+max(PlotCounts)*0.45)
      }
      
      TEp = filt.TE.sig.ond #vs Control
      tmpindex2 = which(rownames(TEp) == PlotGene[i])
      TEp = TEp$padj[tmpindex2]
      TEp = formatC(TEp,format = "e",digits = 2)
      if(TEp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=2,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.55),size=0.8)
        p = p+geom_segment(aes(x=2,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=2,yend=max(PlotCounts)+max(PlotCounts)*0.5),size=0.8)
        p = p+geom_segment(aes(x=5,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.5),size=0.8)
        pstat = paste("FDR p-value:",TEp)
        p = p+annotate("text",label=pstat,x=3.5,y=max(PlotCounts)+max(PlotCounts)*0.6)
      }
      
    }else(
      cat("Unknown Error")
    )
    
    
  }else{
    cat("Focus not specified, p-values not added to the plot")
  }
  print(p)
  
  #log2 scale
  p = ggplot(logdat,aes(x=Subtype,y=LogPlotCounts,fill=Subtype)) + geom_violin()
  ttl = paste(PlotGene[i])
  p = p +ggtitle(ttl) + xlab("Subtype") + ylab("log2 Median-of-Ratios Counts")
  p = p+scale_x_discrete(limits=c("Control","OND","ALS-Glia","ALS-Ox","ALS-TE"))
  p = p+scale_fill_manual(values = c("gray50","gray30","goldenrod1","navy","firebrick"))
  p = p+theme(axis.text = element_text(size=16), axis.title = element_text(size=18),plot.title = element_text(size=18),legend.text = element_text(size=14),legend.title = element_text(size=14))
  p = p+theme(panel.background = element_rect(fill = "gray90",colour = "gray80",size = 0.5,linetype = "solid"),panel.grid.major = element_line(size = 0.35,linetype = "solid",colour = "gray80"),panel.grid.minor = element_line(size = 0.15,linetype = "solid",colour = "gray80"))
  p = p+geom_dotplot(binaxis = 'y',stackdir = 'center',dotsize = 0.25,fill="white",stackratio = 0.75)
  p = p+theme(axis.title.x=element_text(vjust=-2))
  p = p+theme(axis.title.y=element_text(angle=90, vjust=6))
  p = p+theme(plot.margin = unit(c(1,1,1,1), "cm"))
  p = p+theme(plot.title = element_text(hjust = 0.5))
  upperlim = max(LogPlotCounts)+max(LogPlotCounts)*0.65
  tmplim = min(LogPlotCounts)-min(LogPlotCounts)*0.15
  if(round(tmplim,0)==0){
    lowerlim = 0
  }else{
    lowerlim = tmplim
  }
  #Add p-values
  if(Focus == "Glia"){
    Controlp = filt.glia.sig #vs Control
    tmpindex2 = which(rownames(Controlp) == PlotGene[i])
    Controlp = Controlp$padj[tmpindex2]
    Controlp = formatC(Controlp,format = "e",digits = 2)
    if(Controlp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.1),size=0.8)
      p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=1,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.05),size=0.8)
      p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.05),size=0.8)
      pstat = paste("FDR p-value:",Controlp)
      p = p+annotate("text",label=pstat,x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.15)
    }
    
    ONDp = filt.glia.sig.ond #vs OND
    tmpindex3 = which(rownames(ONDp) == PlotGene[i])
    ONDp = ONDp$padj[tmpindex3]
    ONDp = formatC(ONDp,format = "e",digits = 2)
    if(ONDp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.25),size=0.8)
      p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=2,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.2),size=0.8)
      p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.2),size=0.8)
      pstat = paste("FDR p-value:",ONDp)
      p = p+annotate("text",label=pstat,x=2.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.3)
    }
    
    OXp = filt.GO.sig #vs OX
    tmpindex4 = which(rownames(OXp) == PlotGene[i])
    OXp = OXp$padj[tmpindex4]
    OXp = formatC(OXp,format = "e",digits = 2)
    if(OXp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.40,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.40),size=0.8)
      p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.40,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.35),size=0.8)
      p = p+geom_segment(aes(x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.40,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.35),size=0.8)
      pstat = paste("FDR p-value:",OXp)
      p = p+annotate("text",label=pstat,x=3.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.45)
    }
    
    TEp = filt.GT.sig #vs TE
    tmpindex5 = which(rownames(TEp) == PlotGene[i])
    TEp = TEp$padj[tmpindex5]
    TEp = formatC(TEp,format = "e",digits = 2)
    if(TEp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.55),size=0.8)
      p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.50),size=0.8)
      p = p+geom_segment(aes(x=5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.50),size=0.8)
      pstat = paste("FDR p-value:",TEp)
      p = p+annotate("text",label=pstat,x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.6)
    }
    
  }else if(Focus == "Ox"){
    Controlp = filt.ox.sig #vs Control
    tmpindex2 = which(rownames(Controlp) == PlotGene[i])
    Controlp = Controlp$padj[tmpindex2]
    Controlp = formatC(Controlp,format = "e",digits = 2)
    if(Controlp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.1),size=0.8)
      p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=1,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.05),size=0.8)
      p = p+geom_segment(aes(x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.05),size=0.8)
      pstat = paste("FDR p-value:",Controlp)
      p = p+annotate("text",label=pstat,x=2.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.15)
    }
    
    ONDp = filt.ox.sig.ond #vs OND
    tmpindex3 = which(rownames(ONDp) == PlotGene[i])
    ONDp = ONDp$padj[tmpindex3]
    ONDp = formatC(ONDp,format = "e",digits = 2)
    if(ONDp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.25),size=0.8)
      p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=2,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.2),size=0.8)
      p = p+geom_segment(aes(x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.2),size=0.8)
      pstat = paste("FDR p-value:",ONDp)
      p = p+annotate("text",label=pstat,x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.3)
    }
    
    OXp = filt.GO.sig #vs OX
    tmpindex4 = which(rownames(OXp) == PlotGene[i])
    OXp = OXp$padj[tmpindex4]
    OXp = formatC(OXp,format = "e",digits = 2)
    if(OXp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.40,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.40),size=0.8)
      p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.40,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.35),size=0.8)
      p = p+geom_segment(aes(x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.40,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.35),size=0.8)
      pstat = paste("FDR p-value:",OXp)
      p = p+annotate("text",label=pstat,x=3.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.45)
    }
    
    TEp = filt.TO.sig #vs TE
    tmpindex5 = which(rownames(TEp) == PlotGene[i])
    TEp = TEp$padj[tmpindex5]
    TEp = formatC(TEp,format = "e",digits = 2)
    if(TEp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.55),size=0.8)
      p = p+geom_segment(aes(x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.50),size=0.8)
      p = p+geom_segment(aes(x=5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.50),size=0.8)
      pstat = paste("FDR p-value:",TEp)
      p = p+annotate("text",label=pstat,x=4.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.6)
    }
    
  }else if(Focus == "TE"){
    Controlp = filt.TE.sig#vs Control
    tmpindex2 = which(rownames(Controlp) == PlotGene[i])
    Controlp = Controlp$padj[tmpindex2]
    Controlp = formatC(Controlp,format = "e",digits = 2)
    if(Controlp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.1),size=0.8)
      p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=1,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.05),size=0.8)
      p = p+geom_segment(aes(x=5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.05),size=0.8)
      pstat = paste("FDR p-value:",Controlp)
      p = p+annotate("text",label=pstat,x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.15)
    }
    
    ONDp = filt.TE.sig.ond #vs OND
    tmpindex3 = which(rownames(ONDp) == PlotGene[i])
    ONDp = ONDp$padj[tmpindex3]
    ONDp = formatC(ONDp,format = "e",digits = 2)
    if(ONDp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.25),size=0.8)
      p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=2,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.2),size=0.8)
      p = p+geom_segment(aes(x=5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.2),size=0.8)
      pstat = paste("FDR p-value:",ONDp)
      p = p+annotate("text",label=pstat,x=3.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.3)
    }
    
    Gliap = filt.GT.sig #vs Glia
    tmpindex4 = which(rownames(Gliap) == PlotGene[i])
    Gliap = Gliap$padj[tmpindex4]
    Gliap = formatC(Gliap,format = "e",digits = 2)
    if(Gliap>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.40,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.40),size=0.8)
      p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.40,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.35),size=0.8)
      p = p+geom_segment(aes(x=5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.40,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.35),size=0.8)
      pstat = paste("FDR p-value:",Gliap)
      p = p+annotate("text",label=pstat,x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.45)
    }
    
    TEp = filt.TO.sig #vs OX
    tmpindex5 = which(rownames(TEp) == PlotGene[i])
    TEp = TEp$padj[tmpindex5]
    TEp = formatC(TEp,format = "e",digits = 2)
    if(TEp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=4,y=max(PlotCounts)+max(LogPlotCounts)*0.55,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.55),size=0.8)
      p = p+geom_segment(aes(x=4,y=max(PlotCounts)+max(LogPlotCounts)*0.55,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.50),size=0.8)
      p = p+geom_segment(aes(x=5,y=max(PlotCounts)+max(LogPlotCounts)*0.55,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.50),size=0.8)
      pstat = paste("FDR p-value:",TEp)
      p = p+annotate("text",label=pstat,x=4.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.6)
    }
    
  }else if(Focus == "HC"){
    Controlp = filt.COND.sig #vs OND
    tmpindex2 = which(rownames(Controlp) == PlotGene[i])
    Controlp = Controlp$padj[tmpindex2]
    Controlp = formatC(Controlp,format = "e",digits = 2)
    if(Controlp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.1),size=0.8)
      p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=1,yend=max(PlotCounts)+max(PlotCounts)*0.05),size=0.8)
      p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.05),size=0.8)
      pstat = paste("FDR p-value:",Controlp)
      p = p+annotate("text",label=pstat,x=2,y=max(PlotCounts)+max(PlotCounts)*0.15)
    }
    
    Gliap = filt.glia.sig #vs Glia
    tmpindex3 = which(rownames(ONDp) == PlotGene[i])
    ONDp = ONDp$padj[tmpindex3]
    ONDp = formatC(ONDp,format = "e",digits = 2)
    if(ONDp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=2,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.25),size=0.8)
      p = p+geom_segment(aes(x=2,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=2,yend=max(PlotCounts)+max(PlotCounts)*0.2),size=0.8)
      p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.2),size=0.8)
      pstat = paste("FDR p-value:",ONDp)
      p = p+annotate("text",label=pstat,x=2.5,y=max(PlotCounts)+max(PlotCounts)*0.3)
    }
    
    OXp = filt.ox.sig #vs OX
    tmpindex4 = which(rownames(OXp) == PlotGene[i])
    OXp = OXp$padj[tmpindex4]
    OXp = formatC(OXp,format = "e",digits = 2)
    if(OXp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.40,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.40),size=0.8)
      p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.40,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.35),size=0.8)
      p = p+geom_segment(aes(x=4,y=max(PlotCounts)+max(PlotCounts)*0.40,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.35),size=0.8)
      pstat = paste("FDR p-value:",OXp)
      p = p+annotate("text",label=pstat,x=3.5,y=max(PlotCounts)+max(PlotCounts)*0.45)
    }
    
    TEp = filt.TE.sig #vs TE
    tmpindex5 = which(rownames(TEp) == PlotGene[i])
    TEp = TEp$padj[tmpindex5]
    TEp = formatC(TEp,format = "e",digits = 2)
    if(TEp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.55),size=0.8)
      p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.50),size=0.8)
      p = p+geom_segment(aes(x=5,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.50),size=0.8)
      pstat = paste("FDR p-value:",TEp)
      p = p+annotate("text",label=pstat,x=4,y=max(PlotCounts)+max(PlotCounts)*0.6)
    }
    
  }else if(Focus == "All"){
    
    #Reset axis limits
    upperlim = max(LogPlotCounts)+max(LogPlotCounts)*0.65
    tmplim = min(LogPlotCounts)-min(LogPlotCounts)*0.15
    if(round(tmplim,0)==0){
      lowerlim = 0
    }else{
      lowerlim = tmplim
    }
    
    #Get Subtype with max counts as reference level - all comparisons is too busy
    GCounts = NormCounts[,GliaI]
    OCounts = NormCounts[,OxI]
    TCounts = NormCounts[,TEI]
    HCounts = NormCounts[,HCI]
    ONDCounts = NormCounts[,ONDI]
    
    Gavg = mean(GCounts[tmpindex,])
    Oavg = mean(OCounts[tmpindex,])
    Tavg = mean(TCounts[tmpindex,])
    Havg = mean(HCounts[tmpindex,])
    ONDavg = mean(ONDCounts[tmpindex,])
    
    reflev = max(c(Gavg,Oavg,Tavg,Havg,ONDavg))
    
    if(Gavg == reflev){
      
      Controlp = filt.glia.sig #vs Control
      tmpindex2 = which(rownames(Controlp) == PlotGene[i])
      Controlp = Controlp$padj[tmpindex2]
      Controlp = formatC(Controlp,format = "e",digits = 2)
      if(Controlp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.1),size=0.8)
        p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=1,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.05),size=0.8)
        p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.05),size=0.8)
        pstat = paste("FDR p-value:",Controlp)
        p = p+annotate("text",label=pstat,x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.15)
      }
      
      ONDp = filt.glia.sig.ond #vs OND
      tmpindex3 = which(rownames(ONDp) == PlotGene[i])
      ONDp = ONDp$padj[tmpindex3]
      ONDp = formatC(ONDp,format = "e",digits = 2)
      if(ONDp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.25),size=0.8)
        p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=2,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.2),size=0.8)
        p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.2),size=0.8)
        pstat = paste("FDR p-value:",ONDp)
        p = p+annotate("text",label=pstat,x=2.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.3)
      }
      
      OXp = filt.GO.sig #vs OX
      tmpindex4 = which(rownames(OXp) == PlotGene[i])
      OXp = OXp$padj[tmpindex4]
      OXp = formatC(OXp,format = "e",digits = 2)
      if(OXp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.40,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.40),size=0.8)
        p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.40,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.35),size=0.8)
        p = p+geom_segment(aes(x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.40,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.35),size=0.8)
        pstat = paste("FDR p-value:",OXp)
        p = p+annotate("text",label=pstat,x=3.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.45)
      }
      
      TEp = filt.GT.sig #vs TE
      tmpindex5 = which(rownames(TEp) == PlotGene[i])
      TEp = TEp$padj[tmpindex5]
      TEp = formatC(TEp,format = "e",digits = 2)
      if(TEp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.55),size=0.8)
        p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.50),size=0.8)
        p = p+geom_segment(aes(x=5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.50),size=0.8)
        pstat = paste("FDR p-value:",TEp)
        p = p+annotate("text",label=pstat,x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.6)
      }
      
      
    }else if(Oavg == reflev){
      
      Controlp = filt.ox.sig #vs Control
      tmpindex2 = which(rownames(Controlp) == PlotGene[i])
      Controlp = Controlp$padj[tmpindex2]
      Controlp = formatC(Controlp,format = "e",digits = 2)
      if(Controlp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.1),size=0.8)
        p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=1,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.05),size=0.8)
        p = p+geom_segment(aes(x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.05),size=0.8)
        pstat = paste("FDR p-value:",Controlp)
        p = p+annotate("text",label=pstat,x=2.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.15)
      }
      
      ONDp = filt.ox.sig.ond #vs OND
      tmpindex3 = which(rownames(ONDp) == PlotGene[i])
      ONDp = ONDp$padj[tmpindex3]
      ONDp = formatC(ONDp,format = "e",digits = 2)
      if(ONDp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.25),size=0.8)
        p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=2,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.2),size=0.8)
        p = p+geom_segment(aes(x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.2),size=0.8)
        pstat = paste("FDR p-value:",ONDp)
        p = p+annotate("text",label=pstat,x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.3)
      }
      
      Gliap = filt.GO.sig #vs Glia
      tmpindex4 = which(rownames(Gliap) == PlotGene[i])
      Gliap = Gliap$padj[tmpindex4]
      Gliap = formatC(Gliap,format = "e",digits = 2)
      if(Gliap>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.40,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.40),size=0.8)
        p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.40,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.35),size=0.8)
        p = p+geom_segment(aes(x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.40,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.35),size=0.8)
        pstat = paste("FDR p-value:",Gliap)
        p = p+annotate("text",label=pstat,x=3.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.45)
      }
      
      TEp = filt.TO.sig #vs TE
      tmpindex5 = which(rownames(TEp) == PlotGene[i])
      TEp = TEp$padj[tmpindex5]
      TEp = formatC(TEp,format = "e",digits = 2)
      if(TEp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.55),size=0.8)
        p = p+geom_segment(aes(x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.50),size=0.8)
        p = p+geom_segment(aes(x=5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.50),size=0.8)
        pstat = paste("FDR p-value:",TEp)
        p = p+annotate("text",label=pstat,x=4.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.6)
      }
      
    }else if(Tavg == reflev){
      
      Controlp = filt.TE.sig #vs Control
      tmpindex2 = which(rownames(Controlp) == PlotGene[i])
      Controlp = Controlp$padj[tmpindex2]
      Controlp = formatC(Controlp,format = "e",digits = 2)
      if(Controlp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.1),size=0.8)
        p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=1,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.05),size=0.8)
        p = p+geom_segment(aes(x=5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.05),size=0.8)
        pstat = paste("FDR p-value:",Controlp)
        p = p+annotate("text",label=pstat,x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.15)
      }
      
      ONDp = filt.TE.sig.ond #vs OND
      tmpindex3 = which(rownames(ONDp) == PlotGene[i])
      ONDp = ONDp$padj[tmpindex3]
      ONDp = formatC(ONDp,format = "e",digits = 2)
      if(ONDp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.25),size=0.8)
        p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=2,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.2),size=0.8)
        p = p+geom_segment(aes(x=5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.2),size=0.8)
        pstat = paste("FDR p-value:",ONDp)
        p = p+annotate("text",label=pstat,x=3.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.3)
      }
      
      Gliap = filt.GT.sig #vs Glia
      tmpindex4 = which(rownames(Gliap) == PlotGene[i])
      Gliap = Gliap$padj[tmpindex4]
      Gliap = formatC(Gliap,format = "e",digits = 2)
      if(Gliap>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.40,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.40),size=0.8)
        p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.40,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.35),size=0.8)
        p = p+geom_segment(aes(x=5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.40,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.35),size=0.8)
        pstat = paste("FDR p-value:",Gliap)
        p = p+annotate("text",label=pstat,x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.45)
      }
      
      TEp = filt.TO.sig #vs OX
      tmpindex5 = which(rownames(TEp) == PlotGene[i])
      TEp = TEp$padj[tmpindex5]
      TEp = formatC(TEp,format = "e",digits = 2)
      if(TEp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.55),size=0.8)
        p = p+geom_segment(aes(x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.50),size=0.8)
        p = p+geom_segment(aes(x=5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.50),size=0.8)
        pstat = paste("FDR p-value:",TEp)
        p = p+annotate("text",label=pstat,x=4.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.6)
      }
      
    }else if(Havg == reflev){
      
      ONDp = filt.COND.sig #vs OND
      tmpindex3 = which(rownames(ONDp) == PlotGene[i])
      ONDp = ONDp$padj[tmpindex3]
      ONDp = formatC(ONDp,format = "e",digits = 2)
      if(ONDp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=2,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.1),size=0.8)
        p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=1,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.05),size=0.8)
        p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=2,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.05),size=0.8)
        pstat = paste("FDR p-value:",ONDp)
        p = p+annotate("text",label=pstat,x=1.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.15)
      }
      
      Gliap = filt.glia.sig #vs Control
      tmpindex2 = which(rownames(Gliap) == PlotGene[i])
      Gliap = Gliap$padj[tmpindex2]
      Gliap = formatC(Gliap,format = "e",digits = 2)
      if(Gliap>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.25),size=0.8)
        p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=1,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.2),size=0.8)
        p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.2),size=0.8)
        pstat = paste("FDR p-value:",Gliap)
        p = p+annotate("text",label=pstat,x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.3)
      }
      
      OXp = filt.ox.sig #vs Control
      tmpindex2 = which(rownames(OXp) == PlotGene[i])
      OXp = OXp$padj[tmpindex2]
      OXp = formatC(OXp,format = "e",digits = 2)
      if(OXp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.4,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.4),size=0.8)
        p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.4,xend=1,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.35),size=0.8)
        p = p+geom_segment(aes(x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.4,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.35),size=0.8)
        pstat = paste("FDR p-value:",OXp)
        p = p+annotate("text",label=pstat,x=2.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.45)
      }
      
      TEp = filt.TE.sig#vs Control
      tmpindex2 = which(rownames(TEp) == PlotGene[i])
      TEp = TEp$padj[tmpindex2]
      TEp = formatC(TEp,format = "e",digits = 2)
      if(TEp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.55),size=0.8)
        p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=1,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.5),size=0.8)
        p = p+geom_segment(aes(x=5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.5),size=0.8)
        pstat = paste("FDR p-value:",TEp)
        p = p+annotate("text",label=pstat,x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.6)
      }
      
    }else if(ONDavg == reflev){
      
      Controlp = filt.COND.sig #vs OND
      tmpindex3 = which(rownames(Controlp) == PlotGene[i])
      Controlp = Controlp$padj[tmpindex3]
      Controlp = formatC(Controlp,format = "e",digits = 2)
      if(Controlp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=2,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.1),size=0.8)
        p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=1,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.05),size=0.8)
        p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=2,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.05),size=0.8)
        pstat = paste("FDR p-value:",Controlp)
        p = p+annotate("text",label=pstat,x=1.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.15)
      }
      
      Gliap = filt.glia.sig.ond #vs Control
      tmpindex2 = which(rownames(Gliap) == PlotGene[i])
      Gliap = Gliap$padj[tmpindex2]
      Gliap = formatC(Gliap,format = "e",digits = 2)
      if(Gliap>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.25),size=0.8)
        p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=2,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.2),size=0.8)
        p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.2),size=0.8)
        pstat = paste("FDR p-value:",Gliap)
        p = p+annotate("text",label=pstat,x=2.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.30)
      }
      
      OXp = filt.ox.sig.ond #vs Control
      tmpindex2 = which(rownames(OXp) == PlotGene[i])
      OXp = OXp$padj[tmpindex2]
      OXp = formatC(OXp,format = "e",digits = 2)
      if(OXp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.4,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.4),size=0.8)
        p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.4,xend=2,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.35),size=0.8)
        p = p+geom_segment(aes(x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.4,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.35),size=0.8)
        pstat = paste("FDR p-value:",OXp)
        p = p+annotate("text",label=pstat,x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.45)
      }
      
      TEp = filt.TE.sig.ond #vs Control
      tmpindex2 = which(rownames(TEp) == PlotGene[i])
      TEp = TEp$padj[tmpindex2]
      TEp = formatC(TEp,format = "e",digits = 2)
      if(TEp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.55),size=0.8)
        p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=2,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.5),size=0.8)
        p = p+geom_segment(aes(x=5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.5),size=0.8)
        pstat = paste("FDR p-value:",TEp)
        p = p+annotate("text",label=pstat,x=3.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.6)
      }
      
    }else(
      cat("Unknown Error")
    )
    
    
  }else{
    cat("Focus not specified, p-values not added to the plot")
  }
  print(p)
}

#Warnings can generally be ignored for this loop - there are some duplicated lines of code


#Log2 Violin Autoplot only (scale = "width")
PlotGene = "TLR9" #C1D - Ox
Focus = "All"

for(i in 1:length(PlotGene)){
  
  #Grab the index
  tmpindex = which(rownames(NormCounts) == PlotGene[i])
  
  #On the Normalized Count Scale
  PlotCounts = NormCounts[tmpindex,]
  dat = data.frame(Subtype,PlotCounts)
  
  LogPlotCounts = log2(PlotCounts)
  logdat = data.frame(Subtype,LogPlotCounts)
  
  #log2 scale
  p = ggplot(logdat,aes(x=Subtype,y=LogPlotCounts,fill=Subtype)) + geom_violin(kernel = "gaussian",scale="width")
  #p = p + stat_ydensity(adjust = 6,na.rm = T,scale = "count",bw=1)
  ttl = paste(PlotGene[i])
  p = p +ggtitle(ttl) + xlab("Subtype") + ylab("log2 Median-of-Ratios Counts")
  p = p+scale_x_discrete(limits=c("Control","OND","ALS-Glia","ALS-Ox","ALS-TE"))
  p = p+scale_fill_manual(values = c("gray50","gray30","goldenrod1","navy","firebrick"))
  p = p+theme(axis.text = element_text(size=16), axis.title = element_text(size=18),plot.title = element_text(size=18),legend.text = element_text(size=14),legend.title = element_text(size=14))
  p = p+theme(panel.background = element_rect(fill = "gray90",colour = "gray80",size = 0.5,linetype = "solid"),panel.grid.major = element_line(size = 0.35,linetype = "solid",colour = "gray80"),panel.grid.minor = element_line(size = 0.15,linetype = "solid",colour = "gray80"))
  p = p+geom_dotplot(binaxis = 'y',stackdir = 'center',dotsize = 0.25,fill="white",stackratio = 0.75)
  p = p+theme(axis.title.x=element_text(vjust=-2))
  p = p+theme(axis.title.y=element_text(angle=90, vjust=6))
  p = p+theme(plot.margin = unit(c(1,1,1,1), "cm"))
  p = p+theme(plot.title = element_text(hjust = 0.5))
  upperlim = max(LogPlotCounts)+max(LogPlotCounts)*0.65
  tmplim = min(LogPlotCounts)-min(LogPlotCounts)*0.15
  if(round(tmplim,0)==0){
    lowerlim = 0
  }else{
    lowerlim = tmplim
  }
  #Add p-values
  if(Focus == "Glia"){
    Controlp = filt.glia.sig #vs Control
    tmpindex2 = which(rownames(Controlp) == PlotGene[i])
    Controlp = Controlp$padj[tmpindex2]
    Controlp = formatC(Controlp,format = "e",digits = 2)
    if(Controlp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.1),size=0.8)
      p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=1,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.05),size=0.8)
      p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.05),size=0.8)
      pstat = paste("FDR p-value:",Controlp)
      p = p+annotate("text",label=pstat,x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.15)
    }
    
    ONDp = filt.glia.sig.ond #vs OND
    tmpindex3 = which(rownames(ONDp) == PlotGene[i])
    ONDp = ONDp$padj[tmpindex3]
    ONDp = formatC(ONDp,format = "e",digits = 2)
    if(ONDp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.25),size=0.8)
      p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=2,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.2),size=0.8)
      p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.2),size=0.8)
      pstat = paste("FDR p-value:",ONDp)
      p = p+annotate("text",label=pstat,x=2.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.3)
    }
    
    OXp = filt.GO.sig #vs OX
    tmpindex4 = which(rownames(OXp) == PlotGene[i])
    OXp = OXp$padj[tmpindex4]
    OXp = formatC(OXp,format = "e",digits = 2)
    if(OXp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.40,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.40),size=0.8)
      p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.40,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.35),size=0.8)
      p = p+geom_segment(aes(x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.40,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.35),size=0.8)
      pstat = paste("FDR p-value:",OXp)
      p = p+annotate("text",label=pstat,x=3.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.45)
    }
    
    TEp = filt.GT.sig #vs TE
    tmpindex5 = which(rownames(TEp) == PlotGene[i])
    TEp = TEp$padj[tmpindex5]
    TEp = formatC(TEp,format = "e",digits = 2)
    if(TEp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.55),size=0.8)
      p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.50),size=0.8)
      p = p+geom_segment(aes(x=5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.50),size=0.8)
      pstat = paste("FDR p-value:",TEp)
      p = p+annotate("text",label=pstat,x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.6)
    }
    
  }else if(Focus == "Ox"){
    Controlp = filt.ox.sig #vs Control
    tmpindex2 = which(rownames(Controlp) == PlotGene[i])
    Controlp = Controlp$padj[tmpindex2]
    Controlp = formatC(Controlp,format = "e",digits = 2)
    if(Controlp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.1),size=0.8)
      p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=1,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.05),size=0.8)
      p = p+geom_segment(aes(x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.05),size=0.8)
      pstat = paste("FDR p-value:",Controlp)
      p = p+annotate("text",label=pstat,x=2.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.15)
    }
    
    ONDp = filt.ox.sig.ond #vs OND
    tmpindex3 = which(rownames(ONDp) == PlotGene[i])
    ONDp = ONDp$padj[tmpindex3]
    ONDp = formatC(ONDp,format = "e",digits = 2)
    if(ONDp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.25),size=0.8)
      p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=2,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.2),size=0.8)
      p = p+geom_segment(aes(x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.2),size=0.8)
      pstat = paste("FDR p-value:",ONDp)
      p = p+annotate("text",label=pstat,x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.3)
    }
    
    OXp = filt.GO.sig #vs OX
    tmpindex4 = which(rownames(OXp) == PlotGene[i])
    OXp = OXp$padj[tmpindex4]
    OXp = formatC(OXp,format = "e",digits = 2)
    if(OXp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.40,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.40),size=0.8)
      p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.40,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.35),size=0.8)
      p = p+geom_segment(aes(x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.40,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.35),size=0.8)
      pstat = paste("FDR p-value:",OXp)
      p = p+annotate("text",label=pstat,x=3.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.45)
    }
    
    TEp = filt.TO.sig #vs TE
    tmpindex5 = which(rownames(TEp) == PlotGene[i])
    TEp = TEp$padj[tmpindex5]
    TEp = formatC(TEp,format = "e",digits = 2)
    if(TEp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.55),size=0.8)
      p = p+geom_segment(aes(x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.50),size=0.8)
      p = p+geom_segment(aes(x=5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.50),size=0.8)
      pstat = paste("FDR p-value:",TEp)
      p = p+annotate("text",label=pstat,x=4.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.6)
    }
    
  }else if(Focus == "TE"){
    Controlp = filt.TE.sig#vs Control
    tmpindex2 = which(rownames(Controlp) == PlotGene[i])
    Controlp = Controlp$padj[tmpindex2]
    Controlp = formatC(Controlp,format = "e",digits = 2)
    if(Controlp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.1),size=0.8)
      p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=1,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.05),size=0.8)
      p = p+geom_segment(aes(x=5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.05),size=0.8)
      pstat = paste("FDR p-value:",Controlp)
      p = p+annotate("text",label=pstat,x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.15)
    }
    
    ONDp = filt.TE.sig.ond #vs OND
    tmpindex3 = which(rownames(ONDp) == PlotGene[i])
    ONDp = ONDp$padj[tmpindex3]
    ONDp = formatC(ONDp,format = "e",digits = 2)
    if(ONDp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.25),size=0.8)
      p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=2,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.2),size=0.8)
      p = p+geom_segment(aes(x=5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.2),size=0.8)
      pstat = paste("FDR p-value:",ONDp)
      p = p+annotate("text",label=pstat,x=3.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.3)
    }
    
    Gliap = filt.GT.sig #vs Glia
    tmpindex4 = which(rownames(Gliap) == PlotGene[i])
    Gliap = Gliap$padj[tmpindex4]
    Gliap = formatC(Gliap,format = "e",digits = 2)
    if(Gliap>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.40,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.40),size=0.8)
      p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.40,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.35),size=0.8)
      p = p+geom_segment(aes(x=5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.40,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.35),size=0.8)
      pstat = paste("FDR p-value:",Gliap)
      p = p+annotate("text",label=pstat,x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.45)
    }
    
    TEp = filt.TO.sig #vs OX
    tmpindex5 = which(rownames(TEp) == PlotGene[i])
    TEp = TEp$padj[tmpindex5]
    TEp = formatC(TEp,format = "e",digits = 2)
    if(TEp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=4,y=max(PlotCounts)+max(LogPlotCounts)*0.55,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.55),size=0.8)
      p = p+geom_segment(aes(x=4,y=max(PlotCounts)+max(LogPlotCounts)*0.55,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.50),size=0.8)
      p = p+geom_segment(aes(x=5,y=max(PlotCounts)+max(LogPlotCounts)*0.55,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.50),size=0.8)
      pstat = paste("FDR p-value:",TEp)
      p = p+annotate("text",label=pstat,x=4.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.6)
    }
    
  }else if(Focus == "All"){
    
    #Reset axis limits
    upperlim = max(LogPlotCounts)+max(LogPlotCounts)*0.65
    tmplim = min(LogPlotCounts)-min(LogPlotCounts)*0.15
    if(round(tmplim,0)==0){
      lowerlim = 0
    }else{
      lowerlim = tmplim
    }
    
    #Get Subtype with max counts as reference level - all comparisons is too busy
    GCounts = NormCounts[,GliaI]
    OCounts = NormCounts[,OxI]
    TCounts = NormCounts[,TEI]
    HCounts = NormCounts[,HCI]
    ONDCounts = NormCounts[,ONDI]
    
    Gavg = mean(GCounts[tmpindex,])
    Oavg = mean(OCounts[tmpindex,])
    Tavg = mean(TCounts[tmpindex,])
    Havg = mean(HCounts[tmpindex,])
    ONDavg = mean(ONDCounts[tmpindex,])
    
    reflev = max(c(Gavg,Oavg,Tavg,Havg,ONDavg))
    
    if(Gavg == reflev){
      
      Controlp = filt.glia.sig #vs Control
      tmpindex2 = which(rownames(Controlp) == PlotGene[i])
      Controlp = Controlp$padj[tmpindex2]
      Controlp = formatC(Controlp,format = "e",digits = 2)
      if(Controlp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.1),size=0.8)
        p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=1,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.05),size=0.8)
        p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.05),size=0.8)
        pstat = paste("FDR p-value:",Controlp)
        p = p+annotate("text",label=pstat,x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.15)
      }
      
      ONDp = filt.glia.sig.ond #vs OND
      tmpindex3 = which(rownames(ONDp) == PlotGene[i])
      ONDp = ONDp$padj[tmpindex3]
      ONDp = formatC(ONDp,format = "e",digits = 2)
      if(ONDp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.25),size=0.8)
        p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=2,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.2),size=0.8)
        p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.2),size=0.8)
        pstat = paste("FDR p-value:",ONDp)
        p = p+annotate("text",label=pstat,x=2.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.3)
      }
      
      OXp = filt.GO.sig #vs OX
      tmpindex4 = which(rownames(OXp) == PlotGene[i])
      OXp = OXp$padj[tmpindex4]
      OXp = formatC(OXp,format = "e",digits = 2)
      if(OXp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.40,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.40),size=0.8)
        p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.40,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.35),size=0.8)
        p = p+geom_segment(aes(x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.40,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.35),size=0.8)
        pstat = paste("FDR p-value:",OXp)
        p = p+annotate("text",label=pstat,x=3.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.45)
      }
      
      TEp = filt.GT.sig #vs TE
      tmpindex5 = which(rownames(TEp) == PlotGene[i])
      TEp = TEp$padj[tmpindex5]
      TEp = formatC(TEp,format = "e",digits = 2)
      if(TEp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.55),size=0.8)
        p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.50),size=0.8)
        p = p+geom_segment(aes(x=5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.50),size=0.8)
        pstat = paste("FDR p-value:",TEp)
        p = p+annotate("text",label=pstat,x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.6)
      }
      
      
    }else if(Oavg == reflev){
      
      Controlp = filt.ox.sig #vs Control
      tmpindex2 = which(rownames(Controlp) == PlotGene[i])
      Controlp = Controlp$padj[tmpindex2]
      Controlp = formatC(Controlp,format = "e",digits = 2)
      if(Controlp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.1),size=0.8)
        p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=1,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.05),size=0.8)
        p = p+geom_segment(aes(x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.05),size=0.8)
        pstat = paste("FDR p-value:",Controlp)
        p = p+annotate("text",label=pstat,x=2.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.15)
      }
      
      ONDp = filt.ox.sig.ond #vs OND
      tmpindex3 = which(rownames(ONDp) == PlotGene[i])
      ONDp = ONDp$padj[tmpindex3]
      ONDp = formatC(ONDp,format = "e",digits = 2)
      if(ONDp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.25),size=0.8)
        p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=2,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.2),size=0.8)
        p = p+geom_segment(aes(x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.2),size=0.8)
        pstat = paste("FDR p-value:",ONDp)
        p = p+annotate("text",label=pstat,x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.3)
      }
      
      Gliap = filt.GO.sig #vs Glia
      tmpindex4 = which(rownames(Gliap) == PlotGene[i])
      Gliap = Gliap$padj[tmpindex4]
      Gliap = formatC(Gliap,format = "e",digits = 2)
      if(Gliap>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.40,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.40),size=0.8)
        p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.40,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.35),size=0.8)
        p = p+geom_segment(aes(x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.40,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.35),size=0.8)
        pstat = paste("FDR p-value:",Gliap)
        p = p+annotate("text",label=pstat,x=3.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.45)
      }
      
      TEp = filt.TO.sig #vs TE
      tmpindex5 = which(rownames(TEp) == PlotGene[i])
      TEp = TEp$padj[tmpindex5]
      TEp = formatC(TEp,format = "e",digits = 2)
      if(TEp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.55),size=0.8)
        p = p+geom_segment(aes(x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.50),size=0.8)
        p = p+geom_segment(aes(x=5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.50),size=0.8)
        pstat = paste("FDR p-value:",TEp)
        p = p+annotate("text",label=pstat,x=4.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.6)
      }
      
    }else if(Tavg == reflev){
      
      Controlp = filt.TE.sig #vs Control
      tmpindex2 = which(rownames(Controlp) == PlotGene[i])
      Controlp = Controlp$padj[tmpindex2]
      Controlp = formatC(Controlp,format = "e",digits = 2)
      if(Controlp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.1),size=0.8)
        p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=1,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.05),size=0.8)
        p = p+geom_segment(aes(x=5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.05),size=0.8)
        pstat = paste("FDR p-value:",Controlp)
        p = p+annotate("text",label=pstat,x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.15)
      }
      
      ONDp = filt.TE.sig.ond #vs OND
      tmpindex3 = which(rownames(ONDp) == PlotGene[i])
      ONDp = ONDp$padj[tmpindex3]
      ONDp = formatC(ONDp,format = "e",digits = 2)
      if(ONDp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.25),size=0.8)
        p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=2,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.2),size=0.8)
        p = p+geom_segment(aes(x=5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.2),size=0.8)
        pstat = paste("FDR p-value:",ONDp)
        p = p+annotate("text",label=pstat,x=3.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.3)
      }
      
      Gliap = filt.GT.sig #vs Glia
      tmpindex4 = which(rownames(Gliap) == PlotGene[i])
      Gliap = Gliap$padj[tmpindex4]
      Gliap = formatC(Gliap,format = "e",digits = 2)
      if(Gliap>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.40,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.40),size=0.8)
        p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.40,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.35),size=0.8)
        p = p+geom_segment(aes(x=5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.40,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.35),size=0.8)
        pstat = paste("FDR p-value:",Gliap)
        p = p+annotate("text",label=pstat,x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.45)
      }
      
      TEp = filt.TO.sig #vs OX
      tmpindex5 = which(rownames(TEp) == PlotGene[i])
      TEp = TEp$padj[tmpindex5]
      TEp = formatC(TEp,format = "e",digits = 2)
      if(TEp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.55),size=0.8)
        p = p+geom_segment(aes(x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.50),size=0.8)
        p = p+geom_segment(aes(x=5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.50),size=0.8)
        pstat = paste("FDR p-value:",TEp)
        p = p+annotate("text",label=pstat,x=4.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.6)
      }
      
    }else if(Havg == reflev){
      
      ONDp = filt.COND.sig #vs OND
      tmpindex3 = which(rownames(ONDp) == PlotGene[i])
      ONDp = ONDp$padj[tmpindex3]
      ONDp = formatC(ONDp,format = "e",digits = 2)
      if(ONDp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=2,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.1),size=0.8)
        p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=1,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.05),size=0.8)
        p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=2,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.05),size=0.8)
        pstat = paste("FDR p-value:",ONDp)
        p = p+annotate("text",label=pstat,x=1.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.15)
      }
      
      Gliap = filt.glia.sig #vs Control
      tmpindex2 = which(rownames(Gliap) == PlotGene[i])
      Gliap = Gliap$padj[tmpindex2]
      Gliap = formatC(Gliap,format = "e",digits = 2)
      if(Gliap>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.25),size=0.8)
        p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=1,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.2),size=0.8)
        p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.2),size=0.8)
        pstat = paste("FDR p-value:",Gliap)
        p = p+annotate("text",label=pstat,x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.3)
      }
      
      OXp = filt.ox.sig #vs Control
      tmpindex2 = which(rownames(OXp) == PlotGene[i])
      OXp = OXp$padj[tmpindex2]
      OXp = formatC(OXp,format = "e",digits = 2)
      if(OXp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.4,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.4),size=0.8)
        p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.4,xend=1,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.35),size=0.8)
        p = p+geom_segment(aes(x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.4,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.35),size=0.8)
        pstat = paste("FDR p-value:",OXp)
        p = p+annotate("text",label=pstat,x=2.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.45)
      }
      
      TEp = filt.TE.sig#vs Control
      tmpindex2 = which(rownames(TEp) == PlotGene[i])
      TEp = TEp$padj[tmpindex2]
      TEp = formatC(TEp,format = "e",digits = 2)
      if(TEp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.55),size=0.8)
        p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=1,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.5),size=0.8)
        p = p+geom_segment(aes(x=5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.5),size=0.8)
        pstat = paste("FDR p-value:",TEp)
        p = p+annotate("text",label=pstat,x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.6)
      }
      
    }else if(ONDavg == reflev){
      
      Controlp = filt.COND.sig #vs OND
      tmpindex3 = which(rownames(Controlp) == PlotGene[i])
      Controlp = Controlp$padj[tmpindex3]
      Controlp = formatC(Controlp,format = "e",digits = 2)
      if(Controlp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=2,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.1),size=0.8)
        p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=1,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.05),size=0.8)
        p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=2,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.05),size=0.8)
        pstat = paste("FDR p-value:",Controlp)
        p = p+annotate("text",label=pstat,x=1.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.15)
      }
      
      Gliap = filt.glia.sig.ond #vs Control
      tmpindex2 = which(rownames(Gliap) == PlotGene[i])
      Gliap = Gliap$padj[tmpindex2]
      Gliap = formatC(Gliap,format = "e",digits = 2)
      if(Gliap>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.25),size=0.8)
        p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=2,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.2),size=0.8)
        p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.2),size=0.8)
        pstat = paste("FDR p-value:",Gliap)
        p = p+annotate("text",label=pstat,x=2.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.30)
      }
      
      OXp = filt.ox.sig.ond #vs Control
      tmpindex2 = which(rownames(OXp) == PlotGene[i])
      OXp = OXp$padj[tmpindex2]
      OXp = formatC(OXp,format = "e",digits = 2)
      if(OXp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.4,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.4),size=0.8)
        p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.4,xend=2,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.35),size=0.8)
        p = p+geom_segment(aes(x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.4,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.35),size=0.8)
        pstat = paste("FDR p-value:",OXp)
        p = p+annotate("text",label=pstat,x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.45)
      }
      
      TEp = filt.TE.sig.ond #vs Control
      tmpindex2 = which(rownames(TEp) == PlotGene[i])
      TEp = TEp$padj[tmpindex2]
      TEp = formatC(TEp,format = "e",digits = 2)
      if(TEp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.55),size=0.8)
        p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=2,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.5),size=0.8)
        p = p+geom_segment(aes(x=5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.5),size=0.8)
        pstat = paste("FDR p-value:",TEp)
        p = p+annotate("text",label=pstat,x=3.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.6)
      }
      
    }else(
      cat("Unknown Error")
    )
    
    
  }else{
    cat("Focus not specified, p-values not added to the plot")
  }
  print(p)
}


#Reference level = minimum for Focus = "All"
for(i in 1:length(PlotGene)){
  
  #Grab the index
  tmpindex = which(rownames(NormCounts) == PlotGene[i])
  
  ##Boxplots
  
  #On the Normalized Count Scale
  PlotCounts = NormCounts[tmpindex,]
  dat = data.frame(Subtype,PlotCounts)
  p = ggplot(dat,aes(x=Subtype,y=PlotCounts,fill=Subtype)) + geom_boxplot()
  ttl = paste(PlotGene[i])
  p = p +ggtitle(ttl) + xlab("Subtype") + ylab("Median-of-Ratios Counts")
  p = p+scale_x_discrete(limits=c("Control","OND","ALS-Glia","ALS-Ox","ALS-TE"))
  p = p+scale_fill_manual(values = c("gray50","gray30","goldenrod1","navy","firebrick"))
  p = p+theme(axis.text = element_text(size=16), axis.title = element_text(size=18),plot.title = element_text(size=18),legend.text = element_text(size=14),legend.title = element_text(size=14))
  p = p+theme(axis.title.x=element_text(vjust=-2))
  p = p+theme(axis.title.y=element_text(angle=90, vjust=6))
  p = p+ theme(plot.margin = unit(c(1,1,1,1), "cm"))
  p = p+theme(plot.title = element_text(hjust = 0.5))
  upperlim = max(PlotCounts)+max(PlotCounts)*0.65
  tmplim = min(PlotCounts)-min(PlotCounts)*0.15
  if(round(tmplim,0)==0){
    lowerlim = 0
  }else{
    lowerlim = tmplim
  }
  #Add p-values
  if(Focus == "Glia"){
    Controlp = filt.glia.sig #vs Control
    tmpindex2 = which(rownames(Controlp) == PlotGene[i])
    Controlp = Controlp$padj[tmpindex2]
    Controlp = formatC(Controlp,format = "e",digits = 2)
    if(Controlp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.1),size=0.8)
      p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=1,yend=max(PlotCounts)+max(PlotCounts)*0.05),size=0.8)
      p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.05),size=0.8)
      pstat = paste("FDR p-value:",Controlp)
      p = p+annotate("text",label=pstat,x=2,y=max(PlotCounts)+max(PlotCounts)*0.15)
    }
    
    ONDp = filt.glia.sig.ond #vs OND
    tmpindex3 = which(rownames(ONDp) == PlotGene[i])
    ONDp = ONDp$padj[tmpindex3]
    ONDp = formatC(ONDp,format = "e",digits = 2)
    if(ONDp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=2,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.25),size=0.8)
      p = p+geom_segment(aes(x=2,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=2,yend=max(PlotCounts)+max(PlotCounts)*0.2),size=0.8)
      p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.2),size=0.8)
      pstat = paste("FDR p-value:",ONDp)
      p = p+annotate("text",label=pstat,x=2.5,y=max(PlotCounts)+max(PlotCounts)*0.3)
    }
    
    OXp = filt.GO.sig #vs OX
    tmpindex4 = which(rownames(OXp) == PlotGene[i])
    OXp = OXp$padj[tmpindex4]
    OXp = formatC(OXp,format = "e",digits = 2)
    if(OXp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.40,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.40),size=0.8)
      p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.40,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.35),size=0.8)
      p = p+geom_segment(aes(x=4,y=max(PlotCounts)+max(PlotCounts)*0.40,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.35),size=0.8)
      pstat = paste("FDR p-value:",OXp)
      p = p+annotate("text",label=pstat,x=3.5,y=max(PlotCounts)+max(PlotCounts)*0.45)
    }
    
    TEp = filt.GT.sig #vs TE
    tmpindex5 = which(rownames(TEp) == PlotGene[i])
    TEp = TEp$padj[tmpindex5]
    TEp = formatC(TEp,format = "e",digits = 2)
    if(TEp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.55),size=0.8)
      p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.50),size=0.8)
      p = p+geom_segment(aes(x=5,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.50),size=0.8)
      pstat = paste("FDR p-value:",TEp)
      p = p+annotate("text",label=pstat,x=4,y=max(PlotCounts)+max(PlotCounts)*0.6)
    }
    
  }else if(Focus == "Ox"){
    Controlp = filt.ox.sig #vs Control
    tmpindex2 = which(rownames(Controlp) == PlotGene[i])
    Controlp = Controlp$padj[tmpindex2]
    Controlp = formatC(Controlp,format = "e",digits = 2)
    if(Controlp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.1),size=0.8)
      p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=1,yend=max(PlotCounts)+max(PlotCounts)*0.05),size=0.8)
      p = p+geom_segment(aes(x=4,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.05),size=0.8)
      pstat = paste("FDR p-value:",Controlp)
      p = p+annotate("text",label=pstat,x=2.5,y=max(PlotCounts)+max(PlotCounts)*0.15)
    }
    
    ONDp = filt.ox.sig.ond #vs OND
    tmpindex3 = which(rownames(ONDp) == PlotGene[i])
    ONDp = ONDp$padj[tmpindex3]
    ONDp = formatC(ONDp,format = "e",digits = 2)
    if(ONDp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=2,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.25),size=0.8)
      p = p+geom_segment(aes(x=2,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=2,yend=max(PlotCounts)+max(PlotCounts)*0.2),size=0.8)
      p = p+geom_segment(aes(x=4,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.2),size=0.8)
      pstat = paste("FDR p-value:",ONDp)
      p = p+annotate("text",label=pstat,x=3,y=max(PlotCounts)+max(PlotCounts)*0.3)
    }
    
    OXp = filt.GO.sig #vs OX
    tmpindex4 = which(rownames(OXp) == PlotGene[i])
    OXp = OXp$padj[tmpindex4]
    OXp = formatC(OXp,format = "e",digits = 2)
    if(OXp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.40,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.40),size=0.8)
      p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.40,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.35),size=0.8)
      p = p+geom_segment(aes(x=4,y=max(PlotCounts)+max(PlotCounts)*0.40,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.35),size=0.8)
      pstat = paste("FDR p-value:",OXp)
      p = p+annotate("text",label=pstat,x=3.5,y=max(PlotCounts)+max(PlotCounts)*0.45)
    }
    
    TEp = filt.TO.sig #vs TE
    tmpindex5 = which(rownames(TEp) == PlotGene[i])
    TEp = TEp$padj[tmpindex5]
    TEp = formatC(TEp,format = "e",digits = 2)
    if(TEp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=4,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.55),size=0.8)
      p = p+geom_segment(aes(x=4,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.50),size=0.8)
      p = p+geom_segment(aes(x=5,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.50),size=0.8)
      pstat = paste("FDR p-value:",TEp)
      p = p+annotate("text",label=pstat,x=4.5,y=max(PlotCounts)+max(PlotCounts)*0.6)
    }
    
  }else if(Focus == "TE"){
    Controlp = filt.TE.sig#vs Control
    tmpindex2 = which(rownames(Controlp) == PlotGene[i])
    Controlp = Controlp$padj[tmpindex2]
    Controlp = formatC(Controlp,format = "e",digits = 2)
    if(Controlp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.1),size=0.8)
      p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=1,yend=max(PlotCounts)+max(PlotCounts)*0.05),size=0.8)
      p = p+geom_segment(aes(x=5,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.05),size=0.8)
      pstat = paste("FDR p-value:",Controlp)
      p = p+annotate("text",label=pstat,x=3,y=max(PlotCounts)+max(PlotCounts)*0.15)
    }
    
    ONDp = filt.TE.sig.ond #vs OND
    tmpindex3 = which(rownames(ONDp) == PlotGene[i])
    ONDp = ONDp$padj[tmpindex3]
    ONDp = formatC(ONDp,format = "e",digits = 2)
    if(ONDp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=2,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.25),size=0.8)
      p = p+geom_segment(aes(x=2,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=2,yend=max(PlotCounts)+max(PlotCounts)*0.2),size=0.8)
      p = p+geom_segment(aes(x=5,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.2),size=0.8)
      pstat = paste("FDR p-value:",ONDp)
      p = p+annotate("text",label=pstat,x=3.5,y=max(PlotCounts)+max(PlotCounts)*0.3)
    }
    
    Gliap = filt.GT.sig #vs Glia
    tmpindex4 = which(rownames(Gliap) == PlotGene[i])
    Gliap = Gliap$padj[tmpindex4]
    Gliap = formatC(Gliap,format = "e",digits = 2)
    if(Gliap>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.40,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.40),size=0.8)
      p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.40,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.35),size=0.8)
      p = p+geom_segment(aes(x=5,y=max(PlotCounts)+max(PlotCounts)*0.40,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.35),size=0.8)
      pstat = paste("FDR p-value:",Gliap)
      p = p+annotate("text",label=pstat,x=4,y=max(PlotCounts)+max(PlotCounts)*0.45)
    }
    
    TEp = filt.TO.sig #vs OX
    tmpindex5 = which(rownames(TEp) == PlotGene[i])
    TEp = TEp$padj[tmpindex5]
    TEp = formatC(TEp,format = "e",digits = 2)
    if(TEp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=4,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.55),size=0.8)
      p = p+geom_segment(aes(x=4,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.50),size=0.8)
      p = p+geom_segment(aes(x=5,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.50),size=0.8)
      pstat = paste("FDR p-value:",TEp)
      p = p+annotate("text",label=pstat,x=4.5,y=max(PlotCounts)+max(PlotCounts)*0.6)
    }
    
  }else if(Focus == "All"){
    
    #Reset axis limits
    upperlim = max(PlotCounts)+max(PlotCounts)*0.65
    tmplim = min(PlotCounts)-min(PlotCounts)*0.15
    if(round(tmplim,0)==0){
      lowerlim = 0
    }else{
      lowerlim = tmplim
    }
    
    #Get Subtype with max counts as reference level - all comparisons is too busy
    GCounts = NormCounts[,GliaI]
    OCounts = NormCounts[,OxI]
    TCounts = NormCounts[,TEI]
    HCounts = NormCounts[,HCI]
    ONDCounts = NormCounts[,ONDI]
    
    Gavg = mean(GCounts[tmpindex,])
    Oavg = mean(OCounts[tmpindex,])
    Tavg = mean(TCounts[tmpindex,])
    Havg = mean(HCounts[tmpindex,])
    ONDavg = mean(ONDCounts[tmpindex,])
    
    reflev = min(c(Gavg,Oavg,Tavg,Havg,ONDavg))
    
    if(Gavg == reflev){
      
      Controlp = filt.glia.sig #vs Control
      tmpindex2 = which(rownames(Controlp) == PlotGene[i])
      Controlp = Controlp$padj[tmpindex2]
      Controlp = formatC(Controlp,format = "e",digits = 2)
      if(Controlp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.1),size=0.8)
        p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=1,yend=max(PlotCounts)+max(PlotCounts)*0.05),size=0.8)
        p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.05),size=0.8)
        pstat = paste("FDR p-value:",Controlp)
        p = p+annotate("text",label=pstat,x=2,y=max(PlotCounts)+max(PlotCounts)*0.15)
      }
      
      ONDp = filt.glia.sig.ond #vs OND
      tmpindex3 = which(rownames(ONDp) == PlotGene[i])
      ONDp = ONDp$padj[tmpindex3]
      ONDp = formatC(ONDp,format = "e",digits = 2)
      if(ONDp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=2,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.25),size=0.8)
        p = p+geom_segment(aes(x=2,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=2,yend=max(PlotCounts)+max(PlotCounts)*0.2),size=0.8)
        p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.2),size=0.8)
        pstat = paste("FDR p-value:",ONDp)
        p = p+annotate("text",label=pstat,x=2.5,y=max(PlotCounts)+max(PlotCounts)*0.3)
      }
      
      OXp = filt.GO.sig #vs OX
      tmpindex4 = which(rownames(OXp) == PlotGene[i])
      OXp = OXp$padj[tmpindex4]
      OXp = formatC(OXp,format = "e",digits = 2)
      if(OXp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.40,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.40),size=0.8)
        p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.40,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.35),size=0.8)
        p = p+geom_segment(aes(x=4,y=max(PlotCounts)+max(PlotCounts)*0.40,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.35),size=0.8)
        pstat = paste("FDR p-value:",OXp)
        p = p+annotate("text",label=pstat,x=3.5,y=max(PlotCounts)+max(PlotCounts)*0.45)
      }
      
      TEp = filt.GT.sig #vs TE
      tmpindex5 = which(rownames(TEp) == PlotGene[i])
      TEp = TEp$padj[tmpindex5]
      TEp = formatC(TEp,format = "e",digits = 2)
      if(TEp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.55),size=0.8)
        p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.50),size=0.8)
        p = p+geom_segment(aes(x=5,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.50),size=0.8)
        pstat = paste("FDR p-value:",TEp)
        p = p+annotate("text",label=pstat,x=4,y=max(PlotCounts)+max(PlotCounts)*0.6)
      }
      
      
    }else if(Oavg == reflev){
      
      Controlp = filt.ox.sig #vs Control
      tmpindex2 = which(rownames(Controlp) == PlotGene[i])
      Controlp = Controlp$padj[tmpindex2]
      Controlp = formatC(Controlp,format = "e",digits = 2)
      if(Controlp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.1),size=0.8)
        p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=1,yend=max(PlotCounts)+max(PlotCounts)*0.05),size=0.8)
        p = p+geom_segment(aes(x=4,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.05),size=0.8)
        pstat = paste("FDR p-value:",Controlp)
        p = p+annotate("text",label=pstat,x=2.5,y=max(PlotCounts)+max(PlotCounts)*0.15)
      }
      
      ONDp = filt.ox.sig.ond #vs OND
      tmpindex3 = which(rownames(ONDp) == PlotGene[i])
      ONDp = ONDp$padj[tmpindex3]
      ONDp = formatC(ONDp,format = "e",digits = 2)
      if(ONDp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=2,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.25),size=0.8)
        p = p+geom_segment(aes(x=2,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=2,yend=max(PlotCounts)+max(PlotCounts)*0.2),size=0.8)
        p = p+geom_segment(aes(x=4,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.2),size=0.8)
        pstat = paste("FDR p-value:",ONDp)
        p = p+annotate("text",label=pstat,x=3,y=max(PlotCounts)+max(PlotCounts)*0.3)
      }
      
      Gliap = filt.GO.sig #vs Glia
      tmpindex4 = which(rownames(Gliap) == PlotGene[i])
      Gliap = Gliap$padj[tmpindex4]
      Gliap = formatC(Gliap,format = "e",digits = 2)
      if(Gliap>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.40,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.40),size=0.8)
        p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.40,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.35),size=0.8)
        p = p+geom_segment(aes(x=4,y=max(PlotCounts)+max(PlotCounts)*0.40,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.35),size=0.8)
        pstat = paste("FDR p-value:",Gliap)
        p = p+annotate("text",label=pstat,x=3.5,y=max(PlotCounts)+max(PlotCounts)*0.45)
      }
      
      TEp = filt.TO.sig #vs TE
      tmpindex5 = which(rownames(TEp) == PlotGene[i])
      TEp = TEp$padj[tmpindex5]
      TEp = formatC(TEp,format = "e",digits = 2)
      if(TEp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=4,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.55),size=0.8)
        p = p+geom_segment(aes(x=4,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.50),size=0.8)
        p = p+geom_segment(aes(x=5,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.50),size=0.8)
        pstat = paste("FDR p-value:",TEp)
        p = p+annotate("text",label=pstat,x=4.5,y=max(PlotCounts)+max(PlotCounts)*0.6)
      }
      
    }else if(Tavg == reflev){
      
      Controlp = filt.TE.sig #vs Control
      tmpindex2 = which(rownames(Controlp) == PlotGene[i])
      Controlp = Controlp$padj[tmpindex2]
      Controlp = formatC(Controlp,format = "e",digits = 2)
      if(Controlp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.1),size=0.8)
        p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=1,yend=max(PlotCounts)+max(PlotCounts)*0.05),size=0.8)
        p = p+geom_segment(aes(x=5,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.05),size=0.8)
        pstat = paste("FDR p-value:",Controlp)
        p = p+annotate("text",label=pstat,x=3,y=max(PlotCounts)+max(PlotCounts)*0.15)
      }
      
      ONDp = filt.TE.sig.ond #vs OND
      tmpindex3 = which(rownames(ONDp) == PlotGene[i])
      ONDp = ONDp$padj[tmpindex3]
      ONDp = formatC(ONDp,format = "e",digits = 2)
      if(ONDp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=2,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.25),size=0.8)
        p = p+geom_segment(aes(x=2,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=2,yend=max(PlotCounts)+max(PlotCounts)*0.2),size=0.8)
        p = p+geom_segment(aes(x=5,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.2),size=0.8)
        pstat = paste("FDR p-value:",ONDp)
        p = p+annotate("text",label=pstat,x=3.5,y=max(PlotCounts)+max(PlotCounts)*0.3)
      }
      
      Gliap = filt.GT.sig #vs Glia
      tmpindex4 = which(rownames(Gliap) == PlotGene[i])
      Gliap = Gliap$padj[tmpindex4]
      Gliap = formatC(Gliap,format = "e",digits = 2)
      if(Gliap>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.40,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.40),size=0.8)
        p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.40,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.35),size=0.8)
        p = p+geom_segment(aes(x=5,y=max(PlotCounts)+max(PlotCounts)*0.40,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.35),size=0.8)
        pstat = paste("FDR p-value:",Gliap)
        p = p+annotate("text",label=pstat,x=4,y=max(PlotCounts)+max(PlotCounts)*0.45)
      }
      
      TEp = filt.TO.sig #vs OX
      tmpindex5 = which(rownames(TEp) == PlotGene[i])
      TEp = TEp$padj[tmpindex5]
      TEp = formatC(TEp,format = "e",digits = 2)
      if(TEp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=4,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.55),size=0.8)
        p = p+geom_segment(aes(x=4,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.50),size=0.8)
        p = p+geom_segment(aes(x=5,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.50),size=0.8)
        pstat = paste("FDR p-value:",TEp)
        p = p+annotate("text",label=pstat,x=4.5,y=max(PlotCounts)+max(PlotCounts)*0.6)
      }
      
    }else if(Havg == reflev){
      
      ONDp = filt.COND.sig #vs OND
      tmpindex3 = which(rownames(ONDp) == PlotGene[i])
      ONDp = ONDp$padj[tmpindex3]
      ONDp = formatC(ONDp,format = "e",digits = 2)
      if(ONDp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=2,yend=max(PlotCounts)+max(PlotCounts)*0.1),size=0.8)
        p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=1,yend=max(PlotCounts)+max(PlotCounts)*0.05),size=0.8)
        p = p+geom_segment(aes(x=2,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=2,yend=max(PlotCounts)+max(PlotCounts)*0.05),size=0.8)
        pstat = paste("FDR p-value:",ONDp)
        p = p+annotate("text",label=pstat,x=1.5,y=max(PlotCounts)+max(PlotCounts)*0.15)
      }
      
      Gliap = filt.glia.sig #vs Control
      tmpindex2 = which(rownames(Gliap) == PlotGene[i])
      Gliap = Gliap$padj[tmpindex2]
      Gliap = formatC(Gliap,format = "e",digits = 2)
      if(Gliap>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.25),size=0.8)
        p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=1,yend=max(PlotCounts)+max(PlotCounts)*0.2),size=0.8)
        p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.2),size=0.8)
        pstat = paste("FDR p-value:",Gliap)
        p = p+annotate("text",label=pstat,x=2,y=max(PlotCounts)+max(PlotCounts)*0.3)
      }
      
      OXp = filt.ox.sig #vs Control
      tmpindex2 = which(rownames(OXp) == PlotGene[i])
      OXp = OXp$padj[tmpindex2]
      OXp = formatC(OXp,format = "e",digits = 2)
      if(OXp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.4,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.4),size=0.8)
        p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.4,xend=1,yend=max(PlotCounts)+max(PlotCounts)*0.35),size=0.8)
        p = p+geom_segment(aes(x=4,y=max(PlotCounts)+max(PlotCounts)*0.4,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.35),size=0.8)
        pstat = paste("FDR p-value:",OXp)
        p = p+annotate("text",label=pstat,x=2.5,y=max(PlotCounts)+max(PlotCounts)*0.45)
      }
      
      TEp = filt.TE.sig#vs Control
      tmpindex2 = which(rownames(TEp) == PlotGene[i])
      TEp = TEp$padj[tmpindex2]
      TEp = formatC(TEp,format = "e",digits = 2)
      if(TEp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.55),size=0.8)
        p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=1,yend=max(PlotCounts)+max(PlotCounts)*0.5),size=0.8)
        p = p+geom_segment(aes(x=5,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.5),size=0.8)
        pstat = paste("FDR p-value:",TEp)
        p = p+annotate("text",label=pstat,x=3,y=max(PlotCounts)+max(PlotCounts)*0.6)
      }
      
    }else if(ONDavg == reflev){
      
      Controlp = filt.COND.sig #vs OND
      tmpindex3 = which(rownames(Controlp) == PlotGene[i])
      Controlp = Controlp$padj[tmpindex3]
      Controlp = formatC(Controlp,format = "e",digits = 2)
      if(Controlp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=2,yend=max(PlotCounts)+max(PlotCounts)*0.1),size=0.8)
        p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=1,yend=max(PlotCounts)+max(PlotCounts)*0.05),size=0.8)
        p = p+geom_segment(aes(x=2,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=2,yend=max(PlotCounts)+max(PlotCounts)*0.05),size=0.8)
        pstat = paste("FDR p-value:",Controlp)
        p = p+annotate("text",label=pstat,x=1.5,y=max(PlotCounts)+max(PlotCounts)*0.15)
      }
      
      Gliap = filt.glia.sig.ond #vs Control
      tmpindex2 = which(rownames(Gliap) == PlotGene[i])
      Gliap = Gliap$padj[tmpindex2]
      Gliap = formatC(Gliap,format = "e",digits = 2)
      if(Gliap>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=2,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.25),size=0.8)
        p = p+geom_segment(aes(x=2,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=2,yend=max(PlotCounts)+max(PlotCounts)*0.2),size=0.8)
        p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.2),size=0.8)
        pstat = paste("FDR p-value:",Gliap)
        p = p+annotate("text",label=pstat,x=2.5,y=max(PlotCounts)+max(PlotCounts)*0.30)
      }
      
      OXp = filt.ox.sig.ond #vs Control
      tmpindex2 = which(rownames(OXp) == PlotGene[i])
      OXp = OXp$padj[tmpindex2]
      OXp = formatC(OXp,format = "e",digits = 2)
      if(OXp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=2,y=max(PlotCounts)+max(PlotCounts)*0.4,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.4),size=0.8)
        p = p+geom_segment(aes(x=2,y=max(PlotCounts)+max(PlotCounts)*0.4,xend=2,yend=max(PlotCounts)+max(PlotCounts)*0.35),size=0.8)
        p = p+geom_segment(aes(x=4,y=max(PlotCounts)+max(PlotCounts)*0.4,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.35),size=0.8)
        pstat = paste("FDR p-value:",OXp)
        p = p+annotate("text",label=pstat,x=3,y=max(PlotCounts)+max(PlotCounts)*0.45)
      }
      
      TEp = filt.TE.sig.ond #vs Control
      tmpindex2 = which(rownames(TEp) == PlotGene[i])
      TEp = TEp$padj[tmpindex2]
      TEp = formatC(TEp,format = "e",digits = 2)
      if(TEp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=2,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.55),size=0.8)
        p = p+geom_segment(aes(x=2,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=2,yend=max(PlotCounts)+max(PlotCounts)*0.5),size=0.8)
        p = p+geom_segment(aes(x=5,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.5),size=0.8)
        pstat = paste("FDR p-value:",TEp)
        p = p+annotate("text",label=pstat,x=3.5,y=max(PlotCounts)+max(PlotCounts)*0.6)
      }
      
    }else(
      cat("Unknown Error")
    )
    
    
  }else{
    cat("Focus not specified, p-values not added to the plot")
  }
  print(p)
  
  #On the Log2 Normalized Count Scale
  LogPlotCounts = log2(PlotCounts)
  logdat = data.frame(Subtype,LogPlotCounts)
  p = ggplot(logdat,aes(x=Subtype,y=LogPlotCounts,fill=Subtype)) + geom_boxplot()
  ttl = paste(PlotGene[i])
  p = p +ggtitle(ttl) + xlab("Subtype") + ylab("log2 Median-of-Ratios Counts")
  p = p+scale_x_discrete(limits=c("Control","OND","ALS-Glia","ALS-Ox","ALS-TE"))
  p = p+scale_fill_manual(values = c("gray50","gray30","goldenrod1","navy","firebrick"))
  p = p+theme(axis.text = element_text(size=16), axis.title = element_text(size=18),plot.title = element_text(size=18),legend.text = element_text(size=14),legend.title = element_text(size=14))
  p = p+theme(axis.title.x=element_text(vjust=-2))
  p = p+theme(axis.title.y=element_text(angle=90, vjust=6))
  p = p+ theme(plot.margin = unit(c(1,1,1,1), "cm"))
  p = p+theme(plot.title = element_text(hjust = 0.5))
  upperlim = max(LogPlotCounts)+max(LogPlotCounts)*0.65
  tmplim = min(LogPlotCounts)-min(LogPlotCounts)*0.15
  if(round(tmplim,0)==0){
    lowerlim = 0
  }else{
    lowerlim = tmplim
  }
  #Add p-values
  if(Focus == "Glia"){
    Controlp = filt.glia.sig #vs Control
    tmpindex2 = which(rownames(Controlp) == PlotGene[i])
    Controlp = Controlp$padj[tmpindex2]
    Controlp = formatC(Controlp,format = "e",digits = 2)
    if(Controlp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.1),size=0.8)
      p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=1,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.05),size=0.8)
      p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.05),size=0.8)
      pstat = paste("FDR p-value:",Controlp)
      p = p+annotate("text",label=pstat,x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.15)
    }
    
    ONDp = filt.glia.sig.ond #vs OND
    tmpindex3 = which(rownames(ONDp) == PlotGene[i])
    ONDp = ONDp$padj[tmpindex3]
    ONDp = formatC(ONDp,format = "e",digits = 2)
    if(ONDp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.25),size=0.8)
      p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=2,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.2),size=0.8)
      p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.2),size=0.8)
      pstat = paste("FDR p-value:",ONDp)
      p = p+annotate("text",label=pstat,x=2.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.3)
    }
    
    OXp = filt.GO.sig #vs OX
    tmpindex4 = which(rownames(OXp) == PlotGene[i])
    OXp = OXp$padj[tmpindex4]
    OXp = formatC(OXp,format = "e",digits = 2)
    if(OXp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.40,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.40),size=0.8)
      p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.40,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.35),size=0.8)
      p = p+geom_segment(aes(x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.40,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.35),size=0.8)
      pstat = paste("FDR p-value:",OXp)
      p = p+annotate("text",label=pstat,x=3.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.45)
    }
    
    TEp = filt.GT.sig #vs TE
    tmpindex5 = which(rownames(TEp) == PlotGene[i])
    TEp = TEp$padj[tmpindex5]
    TEp = formatC(TEp,format = "e",digits = 2)
    if(TEp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.55),size=0.8)
      p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.50),size=0.8)
      p = p+geom_segment(aes(x=5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.50),size=0.8)
      pstat = paste("FDR p-value:",TEp)
      p = p+annotate("text",label=pstat,x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.6)
    }
    
  }else if(Focus == "Ox"){
    Controlp = filt.ox.sig #vs Control
    tmpindex2 = which(rownames(Controlp) == PlotGene[i])
    Controlp = Controlp$padj[tmpindex2]
    Controlp = formatC(Controlp,format = "e",digits = 2)
    if(Controlp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.1),size=0.8)
      p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=1,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.05),size=0.8)
      p = p+geom_segment(aes(x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.05),size=0.8)
      pstat = paste("FDR p-value:",Controlp)
      p = p+annotate("text",label=pstat,x=2.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.15)
    }
    
    ONDp = filt.ox.sig.ond #vs OND
    tmpindex3 = which(rownames(ONDp) == PlotGene[i])
    ONDp = ONDp$padj[tmpindex3]
    ONDp = formatC(ONDp,format = "e",digits = 2)
    if(ONDp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.25),size=0.8)
      p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=2,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.2),size=0.8)
      p = p+geom_segment(aes(x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.2),size=0.8)
      pstat = paste("FDR p-value:",ONDp)
      p = p+annotate("text",label=pstat,x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.3)
    }
    
    OXp = filt.GO.sig #vs OX
    tmpindex4 = which(rownames(OXp) == PlotGene[i])
    OXp = OXp$padj[tmpindex4]
    OXp = formatC(OXp,format = "e",digits = 2)
    if(OXp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.40,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.40),size=0.8)
      p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.40,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.35),size=0.8)
      p = p+geom_segment(aes(x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.40,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.35),size=0.8)
      pstat = paste("FDR p-value:",OXp)
      p = p+annotate("text",label=pstat,x=3.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.45)
    }
    
    TEp = filt.TO.sig #vs TE
    tmpindex5 = which(rownames(TEp) == PlotGene[i])
    TEp = TEp$padj[tmpindex5]
    TEp = formatC(TEp,format = "e",digits = 2)
    if(TEp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.55),size=0.8)
      p = p+geom_segment(aes(x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.50),size=0.8)
      p = p+geom_segment(aes(x=5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.50),size=0.8)
      pstat = paste("FDR p-value:",TEp)
      p = p+annotate("text",label=pstat,x=4.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.6)
    }
    
  }else if(Focus == "TE"){
    Controlp = filt.TE.sig#vs Control
    tmpindex2 = which(rownames(Controlp) == PlotGene[i])
    Controlp = Controlp$padj[tmpindex2]
    Controlp = formatC(Controlp,format = "e",digits = 2)
    if(Controlp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.1),size=0.8)
      p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=1,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.05),size=0.8)
      p = p+geom_segment(aes(x=5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.05),size=0.8)
      pstat = paste("FDR p-value:",Controlp)
      p = p+annotate("text",label=pstat,x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.15)
    }
    
    ONDp = filt.TE.sig.ond #vs OND
    tmpindex3 = which(rownames(ONDp) == PlotGene[i])
    ONDp = ONDp$padj[tmpindex3]
    ONDp = formatC(ONDp,format = "e",digits = 2)
    if(ONDp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.25),size=0.8)
      p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=2,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.2),size=0.8)
      p = p+geom_segment(aes(x=5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.2),size=0.8)
      pstat = paste("FDR p-value:",ONDp)
      p = p+annotate("text",label=pstat,x=3.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.3)
    }
    
    Gliap = filt.GT.sig #vs Glia
    tmpindex4 = which(rownames(Gliap) == PlotGene[i])
    Gliap = Gliap$padj[tmpindex4]
    Gliap = formatC(Gliap,format = "e",digits = 2)
    if(Gliap>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.40,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.40),size=0.8)
      p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.40,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.35),size=0.8)
      p = p+geom_segment(aes(x=5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.40,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.35),size=0.8)
      pstat = paste("FDR p-value:",Gliap)
      p = p+annotate("text",label=pstat,x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.45)
    }
    
    TEp = filt.TO.sig #vs OX
    tmpindex5 = which(rownames(TEp) == PlotGene[i])
    TEp = TEp$padj[tmpindex5]
    TEp = formatC(TEp,format = "e",digits = 2)
    if(TEp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=4,y=max(PlotCounts)+max(LogPlotCounts)*0.55,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.55),size=0.8)
      p = p+geom_segment(aes(x=4,y=max(PlotCounts)+max(LogPlotCounts)*0.55,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.50),size=0.8)
      p = p+geom_segment(aes(x=5,y=max(PlotCounts)+max(LogPlotCounts)*0.55,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.50),size=0.8)
      pstat = paste("FDR p-value:",TEp)
      p = p+annotate("text",label=pstat,x=4.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.6)
    }
    
  }else if(Focus == "All"){
    
    #Reset axis limits
    upperlim = max(LogPlotCounts)+max(LogPlotCounts)*0.65
    tmplim = min(LogPlotCounts)-min(LogPlotCounts)*0.15
    if(round(tmplim,0)==0){
      lowerlim = 0
    }else{
      lowerlim = tmplim
    }
    
    #Get Subtype with max counts as reference level - all comparisons is too busy
    GCounts = NormCounts[,GliaI]
    OCounts = NormCounts[,OxI]
    TCounts = NormCounts[,TEI]
    HCounts = NormCounts[,HCI]
    ONDCounts = NormCounts[,ONDI]
    
    Gavg = mean(GCounts[tmpindex,])
    Oavg = mean(OCounts[tmpindex,])
    Tavg = mean(TCounts[tmpindex,])
    Havg = mean(HCounts[tmpindex,])
    ONDavg = mean(ONDCounts[tmpindex,])
    
    reflev = min(c(Gavg,Oavg,Tavg,Havg,ONDavg))
    
    if(Gavg == reflev){
      
      Controlp = filt.glia.sig #vs Control
      tmpindex2 = which(rownames(Controlp) == PlotGene[i])
      Controlp = Controlp$padj[tmpindex2]
      Controlp = formatC(Controlp,format = "e",digits = 2)
      if(Controlp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.1),size=0.8)
        p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=1,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.05),size=0.8)
        p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.05),size=0.8)
        pstat = paste("FDR p-value:",Controlp)
        p = p+annotate("text",label=pstat,x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.15)
      }
      
      ONDp = filt.glia.sig.ond #vs OND
      tmpindex3 = which(rownames(ONDp) == PlotGene[i])
      ONDp = ONDp$padj[tmpindex3]
      ONDp = formatC(ONDp,format = "e",digits = 2)
      if(ONDp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.25),size=0.8)
        p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=2,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.2),size=0.8)
        p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.2),size=0.8)
        pstat = paste("FDR p-value:",ONDp)
        p = p+annotate("text",label=pstat,x=2.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.3)
      }
      
      OXp = filt.GO.sig #vs OX
      tmpindex4 = which(rownames(OXp) == PlotGene[i])
      OXp = OXp$padj[tmpindex4]
      OXp = formatC(OXp,format = "e",digits = 2)
      if(OXp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.40,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.40),size=0.8)
        p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.40,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.35),size=0.8)
        p = p+geom_segment(aes(x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.40,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.35),size=0.8)
        pstat = paste("FDR p-value:",OXp)
        p = p+annotate("text",label=pstat,x=3.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.45)
      }
      
      TEp = filt.GT.sig #vs TE
      tmpindex5 = which(rownames(TEp) == PlotGene[i])
      TEp = TEp$padj[tmpindex5]
      TEp = formatC(TEp,format = "e",digits = 2)
      if(TEp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.55),size=0.8)
        p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.50),size=0.8)
        p = p+geom_segment(aes(x=5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.50),size=0.8)
        pstat = paste("FDR p-value:",TEp)
        p = p+annotate("text",label=pstat,x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.6)
      }
      
      
    }else if(Oavg == reflev){
      
      Controlp = filt.ox.sig #vs Control
      tmpindex2 = which(rownames(Controlp) == PlotGene[i])
      Controlp = Controlp$padj[tmpindex2]
      Controlp = formatC(Controlp,format = "e",digits = 2)
      if(Controlp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.1),size=0.8)
        p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=1,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.05),size=0.8)
        p = p+geom_segment(aes(x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.05),size=0.8)
        pstat = paste("FDR p-value:",Controlp)
        p = p+annotate("text",label=pstat,x=2.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.15)
      }
      
      ONDp = filt.ox.sig.ond #vs OND
      tmpindex3 = which(rownames(ONDp) == PlotGene[i])
      ONDp = ONDp$padj[tmpindex3]
      ONDp = formatC(ONDp,format = "e",digits = 2)
      if(ONDp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.25),size=0.8)
        p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=2,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.2),size=0.8)
        p = p+geom_segment(aes(x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.2),size=0.8)
        pstat = paste("FDR p-value:",ONDp)
        p = p+annotate("text",label=pstat,x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.3)
      }
      
      Gliap = filt.GO.sig #vs Glia
      tmpindex4 = which(rownames(Gliap) == PlotGene[i])
      Gliap = Gliap$padj[tmpindex4]
      Gliap = formatC(Gliap,format = "e",digits = 2)
      if(Gliap>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.40,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.40),size=0.8)
        p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.40,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.35),size=0.8)
        p = p+geom_segment(aes(x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.40,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.35),size=0.8)
        pstat = paste("FDR p-value:",Gliap)
        p = p+annotate("text",label=pstat,x=3.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.45)
      }
      
      TEp = filt.TO.sig #vs TE
      tmpindex5 = which(rownames(TEp) == PlotGene[i])
      TEp = TEp$padj[tmpindex5]
      TEp = formatC(TEp,format = "e",digits = 2)
      if(TEp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.55),size=0.8)
        p = p+geom_segment(aes(x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.50),size=0.8)
        p = p+geom_segment(aes(x=5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.50),size=0.8)
        pstat = paste("FDR p-value:",TEp)
        p = p+annotate("text",label=pstat,x=4.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.6)
      }
      
    }else if(Tavg == reflev){
      
      Controlp = filt.TE.sig #vs Control
      tmpindex2 = which(rownames(Controlp) == PlotGene[i])
      Controlp = Controlp$padj[tmpindex2]
      Controlp = formatC(Controlp,format = "e",digits = 2)
      if(Controlp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.1),size=0.8)
        p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=1,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.05),size=0.8)
        p = p+geom_segment(aes(x=5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.05),size=0.8)
        pstat = paste("FDR p-value:",Controlp)
        p = p+annotate("text",label=pstat,x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.15)
      }
      
      ONDp = filt.TE.sig.ond #vs OND
      tmpindex3 = which(rownames(ONDp) == PlotGene[i])
      ONDp = ONDp$padj[tmpindex3]
      ONDp = formatC(ONDp,format = "e",digits = 2)
      if(ONDp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.25),size=0.8)
        p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=2,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.2),size=0.8)
        p = p+geom_segment(aes(x=5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.2),size=0.8)
        pstat = paste("FDR p-value:",ONDp)
        p = p+annotate("text",label=pstat,x=3.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.3)
      }
      
      Gliap = filt.GT.sig #vs Glia
      tmpindex4 = which(rownames(Gliap) == PlotGene[i])
      Gliap = Gliap$padj[tmpindex4]
      Gliap = formatC(Gliap,format = "e",digits = 2)
      if(Gliap>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.40,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.40),size=0.8)
        p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.40,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.35),size=0.8)
        p = p+geom_segment(aes(x=5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.40,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.35),size=0.8)
        pstat = paste("FDR p-value:",Gliap)
        p = p+annotate("text",label=pstat,x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.45)
      }
      
      TEp = filt.TO.sig #vs OX
      tmpindex5 = which(rownames(TEp) == PlotGene[i])
      TEp = TEp$padj[tmpindex5]
      TEp = formatC(TEp,format = "e",digits = 2)
      if(TEp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.55),size=0.8)
        p = p+geom_segment(aes(x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.50),size=0.8)
        p = p+geom_segment(aes(x=5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.50),size=0.8)
        pstat = paste("FDR p-value:",TEp)
        p = p+annotate("text",label=pstat,x=4.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.6)
      }
      
    }else if(Havg == reflev){
      
      ONDp = filt.COND.sig #vs OND
      tmpindex3 = which(rownames(ONDp) == PlotGene[i])
      ONDp = ONDp$padj[tmpindex3]
      ONDp = formatC(ONDp,format = "e",digits = 2)
      if(ONDp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=2,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.1),size=0.8)
        p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=1,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.05),size=0.8)
        p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=2,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.05),size=0.8)
        pstat = paste("FDR p-value:",ONDp)
        p = p+annotate("text",label=pstat,x=1.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.15)
      }
      
      Gliap = filt.glia.sig #vs Control
      tmpindex2 = which(rownames(Gliap) == PlotGene[i])
      Gliap = Gliap$padj[tmpindex2]
      Gliap = formatC(Gliap,format = "e",digits = 2)
      if(Gliap>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.25),size=0.8)
        p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=1,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.2),size=0.8)
        p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.2),size=0.8)
        pstat = paste("FDR p-value:",Gliap)
        p = p+annotate("text",label=pstat,x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.3)
      }
      
      OXp = filt.ox.sig #vs Control
      tmpindex2 = which(rownames(OXp) == PlotGene[i])
      OXp = OXp$padj[tmpindex2]
      OXp = formatC(OXp,format = "e",digits = 2)
      if(OXp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.4,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.4),size=0.8)
        p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.4,xend=1,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.35),size=0.8)
        p = p+geom_segment(aes(x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.4,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.35),size=0.8)
        pstat = paste("FDR p-value:",OXp)
        p = p+annotate("text",label=pstat,x=2.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.45)
      }
      
      TEp = filt.TE.sig#vs Control
      tmpindex2 = which(rownames(TEp) == PlotGene[i])
      TEp = TEp$padj[tmpindex2]
      TEp = formatC(TEp,format = "e",digits = 2)
      if(TEp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.55),size=0.8)
        p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=1,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.5),size=0.8)
        p = p+geom_segment(aes(x=5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.5),size=0.8)
        pstat = paste("FDR p-value:",TEp)
        p = p+annotate("text",label=pstat,x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.6)
      }
      
    }else if(ONDavg == reflev){
      
      Controlp = filt.COND.sig #vs OND
      tmpindex3 = which(rownames(Controlp) == PlotGene[i])
      Controlp = Controlp$padj[tmpindex3]
      Controlp = formatC(Controlp,format = "e",digits = 2)
      if(Controlp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=2,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.1),size=0.8)
        p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=1,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.05),size=0.8)
        p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=2,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.05),size=0.8)
        pstat = paste("FDR p-value:",Controlp)
        p = p+annotate("text",label=pstat,x=1.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.15)
      }
      
      Gliap = filt.glia.sig.ond #vs Control
      tmpindex2 = which(rownames(Gliap) == PlotGene[i])
      Gliap = Gliap$padj[tmpindex2]
      Gliap = formatC(Gliap,format = "e",digits = 2)
      if(Gliap>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.25),size=0.8)
        p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=2,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.2),size=0.8)
        p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.2),size=0.8)
        pstat = paste("FDR p-value:",Gliap)
        p = p+annotate("text",label=pstat,x=2.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.30)
      }
      
      OXp = filt.ox.sig.ond #vs Control
      tmpindex2 = which(rownames(OXp) == PlotGene[i])
      OXp = OXp$padj[tmpindex2]
      OXp = formatC(OXp,format = "e",digits = 2)
      if(OXp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.4,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.4),size=0.8)
        p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.4,xend=2,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.35),size=0.8)
        p = p+geom_segment(aes(x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.4,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.35),size=0.8)
        pstat = paste("FDR p-value:",OXp)
        p = p+annotate("text",label=pstat,x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.45)
      }
      
      TEp = filt.TE.sig.ond #vs Control
      tmpindex2 = which(rownames(TEp) == PlotGene[i])
      TEp = TEp$padj[tmpindex2]
      TEp = formatC(TEp,format = "e",digits = 2)
      if(TEp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.55),size=0.8)
        p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=2,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.5),size=0.8)
        p = p+geom_segment(aes(x=5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.5),size=0.8)
        pstat = paste("FDR p-value:",TEp)
        p = p+annotate("text",label=pstat,x=3.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.6)
      }
      
    }else(
      cat("Unknown Error")
    )
    
    
  }else{
    cat("Focus not specified, p-values not added to the plot")
  }
  print(p)
  
  ##Violin
  
  #Norm Count Scale
  p = ggplot(dat,aes(x=Subtype,y=PlotCounts,fill=Subtype)) + geom_violin()
  ttl = paste(PlotGene[i])
  p = p +ggtitle(ttl) + xlab("Subtype") + ylab("Median-of-Ratios Counts")
  p = p+scale_x_discrete(limits=c("Control","OND","ALS-Glia","ALS-Ox","ALS-TE"))
  p = p+scale_fill_manual(values = c("gray50","gray30","goldenrod1","navy","firebrick"))
  p = p+theme(axis.text = element_text(size=16), axis.title = element_text(size=18),plot.title = element_text(size=18),legend.text = element_text(size=14),legend.title = element_text(size=14))
  p = p+theme(panel.background = element_rect(fill = "gray90",colour = "gray80",size = 0.5,linetype = "solid"),panel.grid.major = element_line(size = 0.35,linetype = "solid",colour = "gray80"),panel.grid.minor = element_line(size = 0.15,linetype = "solid",colour = "gray80"))
  p = p+geom_dotplot(binaxis = 'y',stackdir = 'center',dotsize = 0.25,fill="white",stackratio = 0.75)
  p = p+theme(axis.title.x=element_text(vjust=-2))
  p = p+theme(axis.title.y=element_text(angle=90, vjust=6))
  p = p+ theme(plot.margin = unit(c(1,1,1,1), "cm"))
  p = p+theme(plot.title = element_text(hjust = 0.5))
  upperlim = max(PlotCounts)+max(PlotCounts)*0.65
  tmplim = min(PlotCounts)-min(PlotCounts)*0.15
  if(round(tmplim,0)==0){
    lowerlim = 0
  }else{
    lowerlim = tmplim
  }
  #Add p-values
  if(Focus == "Glia"){
    Controlp = filt.glia.sig #vs Control
    tmpindex2 = which(rownames(Controlp) == PlotGene[i])
    Controlp = Controlp$padj[tmpindex2]
    Controlp = formatC(Controlp,format = "e",digits = 2)
    if(Controlp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.1),size=0.8)
      p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=1,yend=max(PlotCounts)+max(PlotCounts)*0.05),size=0.8)
      p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.05),size=0.8)
      pstat = paste("FDR p-value:",Controlp)
      p = p+annotate("text",label=pstat,x=2,y=max(PlotCounts)+max(PlotCounts)*0.15)
    }
    
    ONDp = filt.glia.sig.ond #vs OND
    tmpindex3 = which(rownames(ONDp) == PlotGene[i])
    ONDp = ONDp$padj[tmpindex3]
    ONDp = formatC(ONDp,format = "e",digits = 2)
    if(ONDp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=2,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.25),size=0.8)
      p = p+geom_segment(aes(x=2,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=2,yend=max(PlotCounts)+max(PlotCounts)*0.2),size=0.8)
      p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.2),size=0.8)
      pstat = paste("FDR p-value:",ONDp)
      p = p+annotate("text",label=pstat,x=2.5,y=max(PlotCounts)+max(PlotCounts)*0.3)
    }
    
    OXp = filt.GO.sig #vs OX
    tmpindex4 = which(rownames(OXp) == PlotGene[i])
    OXp = OXp$padj[tmpindex4]
    OXp = formatC(OXp,format = "e",digits = 2)
    if(OXp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.40,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.40),size=0.8)
      p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.40,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.35),size=0.8)
      p = p+geom_segment(aes(x=4,y=max(PlotCounts)+max(PlotCounts)*0.40,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.35),size=0.8)
      pstat = paste("FDR p-value:",OXp)
      p = p+annotate("text",label=pstat,x=3.5,y=max(PlotCounts)+max(PlotCounts)*0.45)
    }
    
    TEp = filt.GT.sig #vs TE
    tmpindex5 = which(rownames(TEp) == PlotGene[i])
    TEp = TEp$padj[tmpindex5]
    TEp = formatC(TEp,format = "e",digits = 2)
    if(TEp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.55),size=0.8)
      p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.50),size=0.8)
      p = p+geom_segment(aes(x=5,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.50),size=0.8)
      pstat = paste("FDR p-value:",TEp)
      p = p+annotate("text",label=pstat,x=4,y=max(PlotCounts)+max(PlotCounts)*0.6)
    }
    
  }else if(Focus == "Ox"){
    Controlp = filt.ox.sig #vs Control
    tmpindex2 = which(rownames(Controlp) == PlotGene[i])
    Controlp = Controlp$padj[tmpindex2]
    Controlp = formatC(Controlp,format = "e",digits = 2)
    if(Controlp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.1),size=0.8)
      p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=1,yend=max(PlotCounts)+max(PlotCounts)*0.05),size=0.8)
      p = p+geom_segment(aes(x=4,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.05),size=0.8)
      pstat = paste("FDR p-value:",Controlp)
      p = p+annotate("text",label=pstat,x=2.5,y=max(PlotCounts)+max(PlotCounts)*0.15)
    }
    
    ONDp = filt.ox.sig.ond #vs OND
    tmpindex3 = which(rownames(ONDp) == PlotGene[i])
    ONDp = ONDp$padj[tmpindex3]
    ONDp = formatC(ONDp,format = "e",digits = 2)
    if(ONDp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=2,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.25),size=0.8)
      p = p+geom_segment(aes(x=2,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=2,yend=max(PlotCounts)+max(PlotCounts)*0.2),size=0.8)
      p = p+geom_segment(aes(x=4,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.2),size=0.8)
      pstat = paste("FDR p-value:",ONDp)
      p = p+annotate("text",label=pstat,x=3,y=max(PlotCounts)+max(PlotCounts)*0.3)
    }
    
    OXp = filt.GO.sig #vs OX
    tmpindex4 = which(rownames(OXp) == PlotGene[i])
    OXp = OXp$padj[tmpindex4]
    OXp = formatC(OXp,format = "e",digits = 2)
    if(OXp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.40,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.40),size=0.8)
      p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.40,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.35),size=0.8)
      p = p+geom_segment(aes(x=4,y=max(PlotCounts)+max(PlotCounts)*0.40,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.35),size=0.8)
      pstat = paste("FDR p-value:",OXp)
      p = p+annotate("text",label=pstat,x=3.5,y=max(PlotCounts)+max(PlotCounts)*0.45)
    }
    
    TEp = filt.TO.sig #vs TE
    tmpindex5 = which(rownames(TEp) == PlotGene[i])
    TEp = TEp$padj[tmpindex5]
    TEp = formatC(TEp,format = "e",digits = 2)
    if(TEp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=4,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.55),size=0.8)
      p = p+geom_segment(aes(x=4,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.50),size=0.8)
      p = p+geom_segment(aes(x=5,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.50),size=0.8)
      pstat = paste("FDR p-value:",TEp)
      p = p+annotate("text",label=pstat,x=4.5,y=max(PlotCounts)+max(PlotCounts)*0.6)
    }
    
  }else if(Focus == "TE"){
    Controlp = filt.TE.sig#vs Control
    tmpindex2 = which(rownames(Controlp) == PlotGene[i])
    Controlp = Controlp$padj[tmpindex2]
    Controlp = formatC(Controlp,format = "e",digits = 2)
    if(Controlp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.1),size=0.8)
      p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=1,yend=max(PlotCounts)+max(PlotCounts)*0.05),size=0.8)
      p = p+geom_segment(aes(x=5,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.05),size=0.8)
      pstat = paste("FDR p-value:",Controlp)
      p = p+annotate("text",label=pstat,x=3,y=max(PlotCounts)+max(PlotCounts)*0.15)
    }
    
    ONDp = filt.TE.sig.ond #vs OND
    tmpindex3 = which(rownames(ONDp) == PlotGene[i])
    ONDp = ONDp$padj[tmpindex3]
    ONDp = formatC(ONDp,format = "e",digits = 2)
    if(ONDp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=2,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.25),size=0.8)
      p = p+geom_segment(aes(x=2,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=2,yend=max(PlotCounts)+max(PlotCounts)*0.2),size=0.8)
      p = p+geom_segment(aes(x=5,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.2),size=0.8)
      pstat = paste("FDR p-value:",ONDp)
      p = p+annotate("text",label=pstat,x=3.5,y=max(PlotCounts)+max(PlotCounts)*0.3)
    }
    
    Gliap = filt.GT.sig #vs Glia
    tmpindex4 = which(rownames(Gliap) == PlotGene[i])
    Gliap = Gliap$padj[tmpindex4]
    Gliap = formatC(Gliap,format = "e",digits = 2)
    if(Gliap>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.40,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.40),size=0.8)
      p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.40,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.35),size=0.8)
      p = p+geom_segment(aes(x=5,y=max(PlotCounts)+max(PlotCounts)*0.40,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.35),size=0.8)
      pstat = paste("FDR p-value:",Gliap)
      p = p+annotate("text",label=pstat,x=4,y=max(PlotCounts)+max(PlotCounts)*0.45)
    }
    
    TEp = filt.TO.sig #vs OX
    tmpindex5 = which(rownames(TEp) == PlotGene[i])
    TEp = TEp$padj[tmpindex5]
    TEp = formatC(TEp,format = "e",digits = 2)
    if(TEp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=4,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.55),size=0.8)
      p = p+geom_segment(aes(x=4,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.50),size=0.8)
      p = p+geom_segment(aes(x=5,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.50),size=0.8)
      pstat = paste("FDR p-value:",TEp)
      p = p+annotate("text",label=pstat,x=4.5,y=max(PlotCounts)+max(PlotCounts)*0.6)
    }
    
  }else if(Focus == "All"){
    
    #Reset axis limits
    upperlim = max(PlotCounts)+max(PlotCounts)*0.65
    tmplim = min(PlotCounts)-min(PlotCounts)*0.15
    if(round(tmplim,0)==0){
      lowerlim = 0
    }else{
      lowerlim = tmplim
    }
    
    #Get Subtype with max counts as reference level - all comparisons is too busy
    GCounts = NormCounts[,GliaI]
    OCounts = NormCounts[,OxI]
    TCounts = NormCounts[,TEI]
    HCounts = NormCounts[,HCI]
    ONDCounts = NormCounts[,ONDI]
    
    Gavg = mean(GCounts[tmpindex,])
    Oavg = mean(OCounts[tmpindex,])
    Tavg = mean(TCounts[tmpindex,])
    Havg = mean(HCounts[tmpindex,])
    ONDavg = mean(ONDCounts[tmpindex,])
    
    reflev = min(c(Gavg,Oavg,Tavg,Havg,ONDavg))
    
    if(Gavg == reflev){
      
      Controlp = filt.glia.sig #vs Control
      tmpindex2 = which(rownames(Controlp) == PlotGene[i])
      Controlp = Controlp$padj[tmpindex2]
      Controlp = formatC(Controlp,format = "e",digits = 2)
      if(Controlp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.1),size=0.8)
        p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=1,yend=max(PlotCounts)+max(PlotCounts)*0.05),size=0.8)
        p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.05),size=0.8)
        pstat = paste("FDR p-value:",Controlp)
        p = p+annotate("text",label=pstat,x=2,y=max(PlotCounts)+max(PlotCounts)*0.15)
      }
      
      ONDp = filt.glia.sig.ond #vs OND
      tmpindex3 = which(rownames(ONDp) == PlotGene[i])
      ONDp = ONDp$padj[tmpindex3]
      ONDp = formatC(ONDp,format = "e",digits = 2)
      if(ONDp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=2,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.25),size=0.8)
        p = p+geom_segment(aes(x=2,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=2,yend=max(PlotCounts)+max(PlotCounts)*0.2),size=0.8)
        p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.2),size=0.8)
        pstat = paste("FDR p-value:",ONDp)
        p = p+annotate("text",label=pstat,x=2.5,y=max(PlotCounts)+max(PlotCounts)*0.3)
      }
      
      OXp = filt.GO.sig #vs OX
      tmpindex4 = which(rownames(OXp) == PlotGene[i])
      OXp = OXp$padj[tmpindex4]
      OXp = formatC(OXp,format = "e",digits = 2)
      if(OXp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.40,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.40),size=0.8)
        p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.40,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.35),size=0.8)
        p = p+geom_segment(aes(x=4,y=max(PlotCounts)+max(PlotCounts)*0.40,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.35),size=0.8)
        pstat = paste("FDR p-value:",OXp)
        p = p+annotate("text",label=pstat,x=3.5,y=max(PlotCounts)+max(PlotCounts)*0.45)
      }
      
      TEp = filt.GT.sig #vs TE
      tmpindex5 = which(rownames(TEp) == PlotGene[i])
      TEp = TEp$padj[tmpindex5]
      TEp = formatC(TEp,format = "e",digits = 2)
      if(TEp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.55),size=0.8)
        p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.50),size=0.8)
        p = p+geom_segment(aes(x=5,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.50),size=0.8)
        pstat = paste("FDR p-value:",TEp)
        p = p+annotate("text",label=pstat,x=4,y=max(PlotCounts)+max(PlotCounts)*0.6)
      }
      
      
    }else if(Oavg == reflev){
      
      Controlp = filt.ox.sig #vs Control
      tmpindex2 = which(rownames(Controlp) == PlotGene[i])
      Controlp = Controlp$padj[tmpindex2]
      Controlp = formatC(Controlp,format = "e",digits = 2)
      if(Controlp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.1),size=0.8)
        p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=1,yend=max(PlotCounts)+max(PlotCounts)*0.05),size=0.8)
        p = p+geom_segment(aes(x=4,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.05),size=0.8)
        pstat = paste("FDR p-value:",Controlp)
        p = p+annotate("text",label=pstat,x=2.5,y=max(PlotCounts)+max(PlotCounts)*0.15)
      }
      
      ONDp = filt.ox.sig.ond #vs OND
      tmpindex3 = which(rownames(ONDp) == PlotGene[i])
      ONDp = ONDp$padj[tmpindex3]
      ONDp = formatC(ONDp,format = "e",digits = 2)
      if(ONDp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=2,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.25),size=0.8)
        p = p+geom_segment(aes(x=2,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=2,yend=max(PlotCounts)+max(PlotCounts)*0.2),size=0.8)
        p = p+geom_segment(aes(x=4,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.2),size=0.8)
        pstat = paste("FDR p-value:",ONDp)
        p = p+annotate("text",label=pstat,x=3,y=max(PlotCounts)+max(PlotCounts)*0.3)
      }
      
      Gliap = filt.GO.sig #vs Glia
      tmpindex4 = which(rownames(Gliap) == PlotGene[i])
      Gliap = Gliap$padj[tmpindex4]
      Gliap = formatC(Gliap,format = "e",digits = 2)
      if(Gliap>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.40,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.40),size=0.8)
        p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.40,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.35),size=0.8)
        p = p+geom_segment(aes(x=4,y=max(PlotCounts)+max(PlotCounts)*0.40,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.35),size=0.8)
        pstat = paste("FDR p-value:",Gliap)
        p = p+annotate("text",label=pstat,x=3.5,y=max(PlotCounts)+max(PlotCounts)*0.45)
      }
      
      TEp = filt.TO.sig #vs TE
      tmpindex5 = which(rownames(TEp) == PlotGene[i])
      TEp = TEp$padj[tmpindex5]
      TEp = formatC(TEp,format = "e",digits = 2)
      if(TEp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=4,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.55),size=0.8)
        p = p+geom_segment(aes(x=4,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.50),size=0.8)
        p = p+geom_segment(aes(x=5,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.50),size=0.8)
        pstat = paste("FDR p-value:",TEp)
        p = p+annotate("text",label=pstat,x=4.5,y=max(PlotCounts)+max(PlotCounts)*0.6)
      }
      
    }else if(Tavg == reflev){
      
      Controlp = filt.TE.sig #vs Control
      tmpindex2 = which(rownames(Controlp) == PlotGene[i])
      Controlp = Controlp$padj[tmpindex2]
      Controlp = formatC(Controlp,format = "e",digits = 2)
      if(Controlp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.1),size=0.8)
        p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=1,yend=max(PlotCounts)+max(PlotCounts)*0.05),size=0.8)
        p = p+geom_segment(aes(x=5,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.05),size=0.8)
        pstat = paste("FDR p-value:",Controlp)
        p = p+annotate("text",label=pstat,x=3,y=max(PlotCounts)+max(PlotCounts)*0.15)
      }
      
      ONDp = filt.TE.sig.ond #vs OND
      tmpindex3 = which(rownames(ONDp) == PlotGene[i])
      ONDp = ONDp$padj[tmpindex3]
      ONDp = formatC(ONDp,format = "e",digits = 2)
      if(ONDp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=2,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.25),size=0.8)
        p = p+geom_segment(aes(x=2,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=2,yend=max(PlotCounts)+max(PlotCounts)*0.2),size=0.8)
        p = p+geom_segment(aes(x=5,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.2),size=0.8)
        pstat = paste("FDR p-value:",ONDp)
        p = p+annotate("text",label=pstat,x=3.5,y=max(PlotCounts)+max(PlotCounts)*0.3)
      }
      
      Gliap = filt.GT.sig #vs Glia
      tmpindex4 = which(rownames(Gliap) == PlotGene[i])
      Gliap = Gliap$padj[tmpindex4]
      Gliap = formatC(Gliap,format = "e",digits = 2)
      if(Gliap>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.40,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.40),size=0.8)
        p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.40,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.35),size=0.8)
        p = p+geom_segment(aes(x=5,y=max(PlotCounts)+max(PlotCounts)*0.40,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.35),size=0.8)
        pstat = paste("FDR p-value:",Gliap)
        p = p+annotate("text",label=pstat,x=4,y=max(PlotCounts)+max(PlotCounts)*0.45)
      }
      
      TEp = filt.TO.sig #vs OX
      tmpindex5 = which(rownames(TEp) == PlotGene[i])
      TEp = TEp$padj[tmpindex5]
      TEp = formatC(TEp,format = "e",digits = 2)
      if(TEp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=4,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.55),size=0.8)
        p = p+geom_segment(aes(x=4,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.50),size=0.8)
        p = p+geom_segment(aes(x=5,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.50),size=0.8)
        pstat = paste("FDR p-value:",TEp)
        p = p+annotate("text",label=pstat,x=4.5,y=max(PlotCounts)+max(PlotCounts)*0.6)
      }
      
    }else if(Havg == reflev){
      
      ONDp = filt.COND.sig #vs OND
      tmpindex3 = which(rownames(ONDp) == PlotGene[i])
      ONDp = ONDp$padj[tmpindex3]
      ONDp = formatC(ONDp,format = "e",digits = 2)
      if(ONDp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=2,yend=max(PlotCounts)+max(PlotCounts)*0.1),size=0.8)
        p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=1,yend=max(PlotCounts)+max(PlotCounts)*0.05),size=0.8)
        p = p+geom_segment(aes(x=2,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=2,yend=max(PlotCounts)+max(PlotCounts)*0.05),size=0.8)
        pstat = paste("FDR p-value:",ONDp)
        p = p+annotate("text",label=pstat,x=1.5,y=max(PlotCounts)+max(PlotCounts)*0.15)
      }
      
      Gliap = filt.glia.sig #vs Control
      tmpindex2 = which(rownames(Gliap) == PlotGene[i])
      Gliap = Gliap$padj[tmpindex2]
      Gliap = formatC(Gliap,format = "e",digits = 2)
      if(Gliap>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.25),size=0.8)
        p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=1,yend=max(PlotCounts)+max(PlotCounts)*0.2),size=0.8)
        p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.2),size=0.8)
        pstat = paste("FDR p-value:",Gliap)
        p = p+annotate("text",label=pstat,x=2,y=max(PlotCounts)+max(PlotCounts)*0.3)
      }
      
      OXp = filt.ox.sig #vs Control
      tmpindex2 = which(rownames(OXp) == PlotGene[i])
      OXp = OXp$padj[tmpindex2]
      OXp = formatC(OXp,format = "e",digits = 2)
      if(OXp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.4,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.4),size=0.8)
        p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.4,xend=1,yend=max(PlotCounts)+max(PlotCounts)*0.35),size=0.8)
        p = p+geom_segment(aes(x=4,y=max(PlotCounts)+max(PlotCounts)*0.4,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.35),size=0.8)
        pstat = paste("FDR p-value:",OXp)
        p = p+annotate("text",label=pstat,x=2.5,y=max(PlotCounts)+max(PlotCounts)*0.45)
      }
      
      TEp = filt.TE.sig#vs Control
      tmpindex2 = which(rownames(TEp) == PlotGene[i])
      TEp = TEp$padj[tmpindex2]
      TEp = formatC(TEp,format = "e",digits = 2)
      if(TEp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.55),size=0.8)
        p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=1,yend=max(PlotCounts)+max(PlotCounts)*0.5),size=0.8)
        p = p+geom_segment(aes(x=5,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.5),size=0.8)
        pstat = paste("FDR p-value:",TEp)
        p = p+annotate("text",label=pstat,x=3,y=max(PlotCounts)+max(PlotCounts)*0.6)
      }
      
    }else if(ONDavg == reflev){
      
      Controlp = filt.COND.sig #vs OND
      tmpindex3 = which(rownames(Controlp) == PlotGene[i])
      Controlp = Controlp$padj[tmpindex3]
      Controlp = formatC(Controlp,format = "e",digits = 2)
      if(Controlp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=2,yend=max(PlotCounts)+max(PlotCounts)*0.1),size=0.8)
        p = p+geom_segment(aes(x=1,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=1,yend=max(PlotCounts)+max(PlotCounts)*0.05),size=0.8)
        p = p+geom_segment(aes(x=2,y=max(PlotCounts)+max(PlotCounts)*0.1,xend=2,yend=max(PlotCounts)+max(PlotCounts)*0.05),size=0.8)
        pstat = paste("FDR p-value:",Controlp)
        p = p+annotate("text",label=pstat,x=1.5,y=max(PlotCounts)+max(PlotCounts)*0.15)
      }
      
      Gliap = filt.glia.sig.ond #vs Control
      tmpindex2 = which(rownames(Gliap) == PlotGene[i])
      Gliap = Gliap$padj[tmpindex2]
      Gliap = formatC(Gliap,format = "e",digits = 2)
      if(Gliap>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=2,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.25),size=0.8)
        p = p+geom_segment(aes(x=2,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=2,yend=max(PlotCounts)+max(PlotCounts)*0.2),size=0.8)
        p = p+geom_segment(aes(x=3,y=max(PlotCounts)+max(PlotCounts)*0.25,xend=3,yend=max(PlotCounts)+max(PlotCounts)*0.2),size=0.8)
        pstat = paste("FDR p-value:",Gliap)
        p = p+annotate("text",label=pstat,x=2.5,y=max(PlotCounts)+max(PlotCounts)*0.30)
      }
      
      OXp = filt.ox.sig.ond #vs Control
      tmpindex2 = which(rownames(OXp) == PlotGene[i])
      OXp = OXp$padj[tmpindex2]
      OXp = formatC(OXp,format = "e",digits = 2)
      if(OXp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=2,y=max(PlotCounts)+max(PlotCounts)*0.4,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.4),size=0.8)
        p = p+geom_segment(aes(x=2,y=max(PlotCounts)+max(PlotCounts)*0.4,xend=2,yend=max(PlotCounts)+max(PlotCounts)*0.35),size=0.8)
        p = p+geom_segment(aes(x=4,y=max(PlotCounts)+max(PlotCounts)*0.4,xend=4,yend=max(PlotCounts)+max(PlotCounts)*0.35),size=0.8)
        pstat = paste("FDR p-value:",OXp)
        p = p+annotate("text",label=pstat,x=3,y=max(PlotCounts)+max(PlotCounts)*0.45)
      }
      
      TEp = filt.TE.sig.ond #vs Control
      tmpindex2 = which(rownames(TEp) == PlotGene[i])
      TEp = TEp$padj[tmpindex2]
      TEp = formatC(TEp,format = "e",digits = 2)
      if(TEp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=2,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.55),size=0.8)
        p = p+geom_segment(aes(x=2,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=2,yend=max(PlotCounts)+max(PlotCounts)*0.5),size=0.8)
        p = p+geom_segment(aes(x=5,y=max(PlotCounts)+max(PlotCounts)*0.55,xend=5,yend=max(PlotCounts)+max(PlotCounts)*0.5),size=0.8)
        pstat = paste("FDR p-value:",TEp)
        p = p+annotate("text",label=pstat,x=3.5,y=max(PlotCounts)+max(PlotCounts)*0.6)
      }
      
    }else(
      cat("Unknown Error")
    )
    
    
  }else{
    cat("Focus not specified, p-values not added to the plot")
  }
  print(p)
  
  #log2 scale
  p = ggplot(logdat,aes(x=Subtype,y=LogPlotCounts,fill=Subtype)) + geom_violin(scale="width")
  ttl = paste(PlotGene[i])
  p = p +ggtitle(ttl) + xlab("Subtype") + ylab("log2 Median-of-Ratios Counts")
  p = p+scale_x_discrete(limits=c("Control","OND","ALS-Glia","ALS-Ox","ALS-TE"))
  p = p+scale_fill_manual(values = c("gray50","gray30","goldenrod1","navy","firebrick"))
  p = p+theme(axis.text = element_text(size=16), axis.title = element_text(size=18),plot.title = element_text(size=18),legend.text = element_text(size=14),legend.title = element_text(size=14))
  p = p+theme(panel.background = element_rect(fill = "gray90",colour = "gray80",size = 0.5,linetype = "solid"),panel.grid.major = element_line(size = 0.35,linetype = "solid",colour = "gray80"),panel.grid.minor = element_line(size = 0.15,linetype = "solid",colour = "gray80"))
  p = p+geom_dotplot(binaxis = 'y',stackdir = 'center',dotsize = 0.25,fill="white",stackratio = 0.75)
  p = p+theme(axis.title.x=element_text(vjust=-2))
  p = p+theme(axis.title.y=element_text(angle=90, vjust=6))
  p = p+theme(plot.margin = unit(c(1,1,1,1), "cm"))
  p = p+theme(plot.title = element_text(hjust = 0.5))
  upperlim = max(LogPlotCounts)+max(LogPlotCounts)*0.65
  tmplim = min(LogPlotCounts)-min(LogPlotCounts)*0.15
  if(round(tmplim,0)==0){
    lowerlim = 0
  }else{
    lowerlim = tmplim
  }
  #Add p-values
  if(Focus == "Glia"){
    Controlp = filt.glia.sig #vs Control
    tmpindex2 = which(rownames(Controlp) == PlotGene[i])
    Controlp = Controlp$padj[tmpindex2]
    Controlp = formatC(Controlp,format = "e",digits = 2)
    if(Controlp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.1),size=0.8)
      p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=1,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.05),size=0.8)
      p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.05),size=0.8)
      pstat = paste("FDR p-value:",Controlp)
      p = p+annotate("text",label=pstat,x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.15)
    }
    
    ONDp = filt.glia.sig.ond #vs OND
    tmpindex3 = which(rownames(ONDp) == PlotGene[i])
    ONDp = ONDp$padj[tmpindex3]
    ONDp = formatC(ONDp,format = "e",digits = 2)
    if(ONDp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.25),size=0.8)
      p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=2,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.2),size=0.8)
      p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.2),size=0.8)
      pstat = paste("FDR p-value:",ONDp)
      p = p+annotate("text",label=pstat,x=2.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.3)
    }
    
    OXp = filt.GO.sig #vs OX
    tmpindex4 = which(rownames(OXp) == PlotGene[i])
    OXp = OXp$padj[tmpindex4]
    OXp = formatC(OXp,format = "e",digits = 2)
    if(OXp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.40,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.40),size=0.8)
      p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.40,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.35),size=0.8)
      p = p+geom_segment(aes(x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.40,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.35),size=0.8)
      pstat = paste("FDR p-value:",OXp)
      p = p+annotate("text",label=pstat,x=3.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.45)
    }
    
    TEp = filt.GT.sig #vs TE
    tmpindex5 = which(rownames(TEp) == PlotGene[i])
    TEp = TEp$padj[tmpindex5]
    TEp = formatC(TEp,format = "e",digits = 2)
    if(TEp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.55),size=0.8)
      p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.50),size=0.8)
      p = p+geom_segment(aes(x=5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.50),size=0.8)
      pstat = paste("FDR p-value:",TEp)
      p = p+annotate("text",label=pstat,x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.6)
    }
    
  }else if(Focus == "Ox"){
    Controlp = filt.ox.sig #vs Control
    tmpindex2 = which(rownames(Controlp) == PlotGene[i])
    Controlp = Controlp$padj[tmpindex2]
    Controlp = formatC(Controlp,format = "e",digits = 2)
    if(Controlp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.1),size=0.8)
      p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=1,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.05),size=0.8)
      p = p+geom_segment(aes(x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.05),size=0.8)
      pstat = paste("FDR p-value:",Controlp)
      p = p+annotate("text",label=pstat,x=2.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.15)
    }
    
    ONDp = filt.ox.sig.ond #vs OND
    tmpindex3 = which(rownames(ONDp) == PlotGene[i])
    ONDp = ONDp$padj[tmpindex3]
    ONDp = formatC(ONDp,format = "e",digits = 2)
    if(ONDp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.25),size=0.8)
      p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=2,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.2),size=0.8)
      p = p+geom_segment(aes(x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.2),size=0.8)
      pstat = paste("FDR p-value:",ONDp)
      p = p+annotate("text",label=pstat,x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.3)
    }
    
    OXp = filt.GO.sig #vs OX
    tmpindex4 = which(rownames(OXp) == PlotGene[i])
    OXp = OXp$padj[tmpindex4]
    OXp = formatC(OXp,format = "e",digits = 2)
    if(OXp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.40,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.40),size=0.8)
      p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.40,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.35),size=0.8)
      p = p+geom_segment(aes(x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.40,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.35),size=0.8)
      pstat = paste("FDR p-value:",OXp)
      p = p+annotate("text",label=pstat,x=3.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.45)
    }
    
    TEp = filt.TO.sig #vs TE
    tmpindex5 = which(rownames(TEp) == PlotGene[i])
    TEp = TEp$padj[tmpindex5]
    TEp = formatC(TEp,format = "e",digits = 2)
    if(TEp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.55),size=0.8)
      p = p+geom_segment(aes(x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.50),size=0.8)
      p = p+geom_segment(aes(x=5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.50),size=0.8)
      pstat = paste("FDR p-value:",TEp)
      p = p+annotate("text",label=pstat,x=4.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.6)
    }
    
  }else if(Focus == "TE"){
    Controlp = filt.TE.sig#vs Control
    tmpindex2 = which(rownames(Controlp) == PlotGene[i])
    Controlp = Controlp$padj[tmpindex2]
    Controlp = formatC(Controlp,format = "e",digits = 2)
    if(Controlp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.1),size=0.8)
      p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=1,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.05),size=0.8)
      p = p+geom_segment(aes(x=5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.05),size=0.8)
      pstat = paste("FDR p-value:",Controlp)
      p = p+annotate("text",label=pstat,x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.15)
    }
    
    ONDp = filt.TE.sig.ond #vs OND
    tmpindex3 = which(rownames(ONDp) == PlotGene[i])
    ONDp = ONDp$padj[tmpindex3]
    ONDp = formatC(ONDp,format = "e",digits = 2)
    if(ONDp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.25),size=0.8)
      p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=2,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.2),size=0.8)
      p = p+geom_segment(aes(x=5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.2),size=0.8)
      pstat = paste("FDR p-value:",ONDp)
      p = p+annotate("text",label=pstat,x=3.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.3)
    }
    
    Gliap = filt.GT.sig #vs Glia
    tmpindex4 = which(rownames(Gliap) == PlotGene[i])
    Gliap = Gliap$padj[tmpindex4]
    Gliap = formatC(Gliap,format = "e",digits = 2)
    if(Gliap>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.40,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.40),size=0.8)
      p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.40,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.35),size=0.8)
      p = p+geom_segment(aes(x=5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.40,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.35),size=0.8)
      pstat = paste("FDR p-value:",Gliap)
      p = p+annotate("text",label=pstat,x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.45)
    }
    
    TEp = filt.TO.sig #vs OX
    tmpindex5 = which(rownames(TEp) == PlotGene[i])
    TEp = TEp$padj[tmpindex5]
    TEp = formatC(TEp,format = "e",digits = 2)
    if(TEp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=4,y=max(PlotCounts)+max(LogPlotCounts)*0.55,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.55),size=0.8)
      p = p+geom_segment(aes(x=4,y=max(PlotCounts)+max(LogPlotCounts)*0.55,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.50),size=0.8)
      p = p+geom_segment(aes(x=5,y=max(PlotCounts)+max(LogPlotCounts)*0.55,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.50),size=0.8)
      pstat = paste("FDR p-value:",TEp)
      p = p+annotate("text",label=pstat,x=4.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.6)
    }
    
  }else if(Focus == "All"){
    
    #Reset axis limits
    upperlim = max(LogPlotCounts)+max(LogPlotCounts)*0.65
    tmplim = min(LogPlotCounts)-min(LogPlotCounts)*0.15
    if(round(tmplim,0)==0){
      lowerlim = 0
    }else{
      lowerlim = tmplim
    }
    
    #Get Subtype with max counts as reference level - all comparisons is too busy
    GCounts = NormCounts[,GliaI]
    OCounts = NormCounts[,OxI]
    TCounts = NormCounts[,TEI]
    HCounts = NormCounts[,HCI]
    ONDCounts = NormCounts[,ONDI]
    
    Gavg = mean(GCounts[tmpindex,])
    Oavg = mean(OCounts[tmpindex,])
    Tavg = mean(TCounts[tmpindex,])
    Havg = mean(HCounts[tmpindex,])
    ONDavg = mean(ONDCounts[tmpindex,])
    
    reflev = min(c(Gavg,Oavg,Tavg,Havg,ONDavg))
    
    if(Gavg == reflev){
      
      Controlp = filt.glia.sig #vs Control
      tmpindex2 = which(rownames(Controlp) == PlotGene[i])
      Controlp = Controlp$padj[tmpindex2]
      Controlp = formatC(Controlp,format = "e",digits = 2)
      if(Controlp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.1),size=0.8)
        p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=1,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.05),size=0.8)
        p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.05),size=0.8)
        pstat = paste("FDR p-value:",Controlp)
        p = p+annotate("text",label=pstat,x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.15)
      }
      
      ONDp = filt.glia.sig.ond #vs OND
      tmpindex3 = which(rownames(ONDp) == PlotGene[i])
      ONDp = ONDp$padj[tmpindex3]
      ONDp = formatC(ONDp,format = "e",digits = 2)
      if(ONDp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.25),size=0.8)
        p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=2,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.2),size=0.8)
        p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.2),size=0.8)
        pstat = paste("FDR p-value:",ONDp)
        p = p+annotate("text",label=pstat,x=2.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.3)
      }
      
      OXp = filt.GO.sig #vs OX
      tmpindex4 = which(rownames(OXp) == PlotGene[i])
      OXp = OXp$padj[tmpindex4]
      OXp = formatC(OXp,format = "e",digits = 2)
      if(OXp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.40,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.40),size=0.8)
        p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.40,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.35),size=0.8)
        p = p+geom_segment(aes(x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.40,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.35),size=0.8)
        pstat = paste("FDR p-value:",OXp)
        p = p+annotate("text",label=pstat,x=3.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.45)
      }
      
      TEp = filt.GT.sig #vs TE
      tmpindex5 = which(rownames(TEp) == PlotGene[i])
      TEp = TEp$padj[tmpindex5]
      TEp = formatC(TEp,format = "e",digits = 2)
      if(TEp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.55),size=0.8)
        p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.50),size=0.8)
        p = p+geom_segment(aes(x=5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.50),size=0.8)
        pstat = paste("FDR p-value:",TEp)
        p = p+annotate("text",label=pstat,x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.6)
      }
      
      
    }else if(Oavg == reflev){
      
      Controlp = filt.ox.sig #vs Control
      tmpindex2 = which(rownames(Controlp) == PlotGene[i])
      Controlp = Controlp$padj[tmpindex2]
      Controlp = formatC(Controlp,format = "e",digits = 2)
      if(Controlp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.1),size=0.8)
        p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=1,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.05),size=0.8)
        p = p+geom_segment(aes(x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.05),size=0.8)
        pstat = paste("FDR p-value:",Controlp)
        p = p+annotate("text",label=pstat,x=2.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.15)
      }
      
      ONDp = filt.ox.sig.ond #vs OND
      tmpindex3 = which(rownames(ONDp) == PlotGene[i])
      ONDp = ONDp$padj[tmpindex3]
      ONDp = formatC(ONDp,format = "e",digits = 2)
      if(ONDp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.25),size=0.8)
        p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=2,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.2),size=0.8)
        p = p+geom_segment(aes(x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.2),size=0.8)
        pstat = paste("FDR p-value:",ONDp)
        p = p+annotate("text",label=pstat,x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.3)
      }
      
      Gliap = filt.GO.sig #vs Glia
      tmpindex4 = which(rownames(Gliap) == PlotGene[i])
      Gliap = Gliap$padj[tmpindex4]
      Gliap = formatC(Gliap,format = "e",digits = 2)
      if(Gliap>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.40,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.40),size=0.8)
        p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.40,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.35),size=0.8)
        p = p+geom_segment(aes(x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.40,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.35),size=0.8)
        pstat = paste("FDR p-value:",Gliap)
        p = p+annotate("text",label=pstat,x=3.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.45)
      }
      
      TEp = filt.TO.sig #vs TE
      tmpindex5 = which(rownames(TEp) == PlotGene[i])
      TEp = TEp$padj[tmpindex5]
      TEp = formatC(TEp,format = "e",digits = 2)
      if(TEp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.55),size=0.8)
        p = p+geom_segment(aes(x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.50),size=0.8)
        p = p+geom_segment(aes(x=5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.50),size=0.8)
        pstat = paste("FDR p-value:",TEp)
        p = p+annotate("text",label=pstat,x=4.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.6)
      }
      
    }else if(Tavg == reflev){
      
      Controlp = filt.TE.sig #vs Control
      tmpindex2 = which(rownames(Controlp) == PlotGene[i])
      Controlp = Controlp$padj[tmpindex2]
      Controlp = formatC(Controlp,format = "e",digits = 2)
      if(Controlp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.1),size=0.8)
        p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=1,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.05),size=0.8)
        p = p+geom_segment(aes(x=5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.05),size=0.8)
        pstat = paste("FDR p-value:",Controlp)
        p = p+annotate("text",label=pstat,x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.15)
      }
      
      ONDp = filt.TE.sig.ond #vs OND
      tmpindex3 = which(rownames(ONDp) == PlotGene[i])
      ONDp = ONDp$padj[tmpindex3]
      ONDp = formatC(ONDp,format = "e",digits = 2)
      if(ONDp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.25),size=0.8)
        p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=2,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.2),size=0.8)
        p = p+geom_segment(aes(x=5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.2),size=0.8)
        pstat = paste("FDR p-value:",ONDp)
        p = p+annotate("text",label=pstat,x=3.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.3)
      }
      
      Gliap = filt.GT.sig #vs Glia
      tmpindex4 = which(rownames(Gliap) == PlotGene[i])
      Gliap = Gliap$padj[tmpindex4]
      Gliap = formatC(Gliap,format = "e",digits = 2)
      if(Gliap>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.40,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.40),size=0.8)
        p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.40,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.35),size=0.8)
        p = p+geom_segment(aes(x=5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.40,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.35),size=0.8)
        pstat = paste("FDR p-value:",Gliap)
        p = p+annotate("text",label=pstat,x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.45)
      }
      
      TEp = filt.TO.sig #vs OX
      tmpindex5 = which(rownames(TEp) == PlotGene[i])
      TEp = TEp$padj[tmpindex5]
      TEp = formatC(TEp,format = "e",digits = 2)
      if(TEp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.55),size=0.8)
        p = p+geom_segment(aes(x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.50),size=0.8)
        p = p+geom_segment(aes(x=5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.50),size=0.8)
        pstat = paste("FDR p-value:",TEp)
        p = p+annotate("text",label=pstat,x=4.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.6)
      }
      
    }else if(Havg == reflev){
      
      ONDp = filt.COND.sig #vs OND
      tmpindex3 = which(rownames(ONDp) == PlotGene[i])
      ONDp = ONDp$padj[tmpindex3]
      ONDp = formatC(ONDp,format = "e",digits = 2)
      if(ONDp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=2,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.1),size=0.8)
        p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=1,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.05),size=0.8)
        p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=2,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.05),size=0.8)
        pstat = paste("FDR p-value:",ONDp)
        p = p+annotate("text",label=pstat,x=1.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.15)
      }
      
      Gliap = filt.glia.sig #vs Control
      tmpindex2 = which(rownames(Gliap) == PlotGene[i])
      Gliap = Gliap$padj[tmpindex2]
      Gliap = formatC(Gliap,format = "e",digits = 2)
      if(Gliap>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.25),size=0.8)
        p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=1,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.2),size=0.8)
        p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.2),size=0.8)
        pstat = paste("FDR p-value:",Gliap)
        p = p+annotate("text",label=pstat,x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.3)
      }
      
      OXp = filt.ox.sig #vs Control
      tmpindex2 = which(rownames(OXp) == PlotGene[i])
      OXp = OXp$padj[tmpindex2]
      OXp = formatC(OXp,format = "e",digits = 2)
      if(OXp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.4,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.4),size=0.8)
        p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.4,xend=1,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.35),size=0.8)
        p = p+geom_segment(aes(x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.4,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.35),size=0.8)
        pstat = paste("FDR p-value:",OXp)
        p = p+annotate("text",label=pstat,x=2.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.45)
      }
      
      TEp = filt.TE.sig#vs Control
      tmpindex2 = which(rownames(TEp) == PlotGene[i])
      TEp = TEp$padj[tmpindex2]
      TEp = formatC(TEp,format = "e",digits = 2)
      if(TEp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.55),size=0.8)
        p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=1,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.5),size=0.8)
        p = p+geom_segment(aes(x=5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.5),size=0.8)
        pstat = paste("FDR p-value:",TEp)
        p = p+annotate("text",label=pstat,x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.6)
      }
      
    }else if(ONDavg == reflev){
      
      Controlp = filt.COND.sig #vs OND
      tmpindex3 = which(rownames(Controlp) == PlotGene[i])
      Controlp = Controlp$padj[tmpindex3]
      Controlp = formatC(Controlp,format = "e",digits = 2)
      if(Controlp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=2,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.1),size=0.8)
        p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=1,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.05),size=0.8)
        p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=2,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.05),size=0.8)
        pstat = paste("FDR p-value:",Controlp)
        p = p+annotate("text",label=pstat,x=1.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.15)
      }
      
      Gliap = filt.glia.sig.ond #vs Control
      tmpindex2 = which(rownames(Gliap) == PlotGene[i])
      Gliap = Gliap$padj[tmpindex2]
      Gliap = formatC(Gliap,format = "e",digits = 2)
      if(Gliap>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.25),size=0.8)
        p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=2,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.2),size=0.8)
        p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.2),size=0.8)
        pstat = paste("FDR p-value:",Gliap)
        p = p+annotate("text",label=pstat,x=2.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.30)
      }
      
      OXp = filt.ox.sig.ond #vs Control
      tmpindex2 = which(rownames(OXp) == PlotGene[i])
      OXp = OXp$padj[tmpindex2]
      OXp = formatC(OXp,format = "e",digits = 2)
      if(OXp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.4,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.4),size=0.8)
        p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.4,xend=2,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.35),size=0.8)
        p = p+geom_segment(aes(x=4,y=max(LogPlotCounts)+max(LogPlotCounts)*0.4,xend=4,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.35),size=0.8)
        pstat = paste("FDR p-value:",OXp)
        p = p+annotate("text",label=pstat,x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.45)
      }
      
      TEp = filt.TE.sig.ond #vs Control
      tmpindex2 = which(rownames(TEp) == PlotGene[i])
      TEp = TEp$padj[tmpindex2]
      TEp = formatC(TEp,format = "e",digits = 2)
      if(TEp>""){
        p = p+ylim(lowerlim,upperlim)
        p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.55),size=0.8)
        p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=2,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.5),size=0.8)
        p = p+geom_segment(aes(x=5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.55,xend=5,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.5),size=0.8)
        pstat = paste("FDR p-value:",TEp)
        p = p+annotate("text",label=pstat,x=3.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.6)
      }
      
    }else(
      cat("Unknown Error")
    )
    
    
  }else{
    cat("Focus not specified, p-values not added to the plot")
  }
  print(p)
}



############################################ 
#univariate without subtypes

#Set factor levels
Subtype = FullPheno$Subtype

for(i in 1:length(Subtype)){
  if(Subtype[i] == "GLIA"){
    Subtype[i] = "ALS"
  }else if(Subtype[i] == "OX"){
    Subtype[i] = "ALS"
  }else if(Subtype[i] == "TE"){
    Subtype[i] = "ALS"
  }
}

FullPheno2$Subtype = Subtype

rCountData5 = round(FullCount,0)

dds_nosub = DESeqDataSetFromMatrix(countData = rCountData5, colData = FullPheno2, design= ~ platform + Subtype, tidy=F) #Subtype must be second (DESeq2 vignette)
dds_nosub$SubjectSex = relevel(dds_nosub$Subtype,ref = "Control")
dseq_nosub = DESeq(dds_nosub,betaPrior=T)

AC.res = results(dseq_nosub,contrast = c("Subtype","ALS","Control"))
AC.sig = AC.res[! is.na(AC.res$padj) & AC.res$padj<0.05,]
filt.AC.sig = AC.sig[rownames(AC.sig) %in% Transcripts,]

AO.res = results(dseq_nosub,contrast = c("Subtype","ALS","OND"))
AO.sig = AO.res[! is.na(AO.res$padj) & AO.res$padj<0.05,]
filt.AO.sig = AO.sig[rownames(AO.sig) %in% Transcripts,]

OC.res = results(dseq_nosub,contrast = c("Subtype","OND","Control"))
OC.sig = OC.res[! is.na(OC.res$padj) & OC.res$padj<0.05,]
filt.OC.sig = OC.sig[rownames(OC.sig) %in% Transcripts,]

Subtype = factor(Subtype,levels = c("Control","OND","ALS"))

PlotGene = c("ADH1B","AQP1","BECN2","SNX18P3","HLA-DRB1","IFI30","IRF7","CCDC154","LILRA6","SERPINA1","HIST1H1T","STH","SOCS3","TNRC6C-AS1","ENSG00000279759","ENSG00000260198","ENSG00000281969","ENSG00000279759","ENSG00000278434")
PlotGene = c("APOC2","FCGR3A","LILRB3")
Focus = "HC"

for(i in 1:length(PlotGene)){
  
  #Grab the index
  tmpindex = which(rownames(NormCounts) == PlotGene[i])
  
  #On the Normalized Count Scale
  PlotCounts = NormCounts[tmpindex,]
  dat = data.frame(Subtype,PlotCounts)
  
  LogPlotCounts = log2(PlotCounts)
  logdat = data.frame(Subtype,LogPlotCounts)
  
  #log2 scale
  p = ggplot(logdat,aes(x=Subtype,y=LogPlotCounts,fill=Subtype)) + geom_violin(kernel = "gaussian",scale="width")
  #p = p + stat_ydensity(adjust = 6,na.rm = T,scale = "count",bw=1)
  ttl = paste(PlotGene[i])
  p = p +ggtitle(ttl) + xlab("Disease Group") + ylab("log2 Median-of-Ratios Counts")
  p = p+scale_x_discrete(limits=c("Control","OND","ALS"))
  p = p+scale_fill_manual(values = c("blue","cyan","orange"))
  p = p+theme(axis.text = element_text(size=16), axis.title = element_text(size=18),plot.title = element_text(size=18),legend.text = element_text(size=14),legend.title = element_text(size=14))
  p = p+theme(panel.background = element_rect(fill = "gray90",colour = "gray80",size = 0.5,linetype = "solid"),panel.grid.major = element_line(size = 0.35,linetype = "solid",colour = "gray80"),panel.grid.minor = element_line(size = 0.15,linetype = "solid",colour = "gray80"))
  p = p+geom_dotplot(binaxis = 'y',stackdir = 'center',dotsize = 0.25,fill="white",stackratio = 0.75)
  p = p+theme(axis.title.x=element_text(vjust=-2))
  p = p+theme(axis.title.y=element_text(angle=90, vjust=6))
  p = p+theme(plot.margin = unit(c(1,1,1,1), "cm"))
  p = p+theme(plot.title = element_text(hjust = 0.5))
  upperlim = max(LogPlotCounts)+max(LogPlotCounts)*0.5
  tmplim = min(LogPlotCounts)-min(LogPlotCounts)*0.15
  if(round(tmplim,0)==0){
    lowerlim = 0
  }else{
    lowerlim = tmplim
  }
  #Add p-values
  if(Focus == "HC"){
    
    
    ONDp = filt.OC.sig #HC vs OND
    tmpindex3 = which(rownames(ONDp) == PlotGene[i])
    ONDp = ONDp$padj[tmpindex3]
    ONDp = formatC(ONDp,format = "e",digits = 2)
    if(ONDp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=2,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.1),size=0.8)
      p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=1,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.05),size=0.8)
      p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.1,xend=2,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.05),size=0.8)
      pstat = paste("FDR p-value:",ONDp)
      p = p+annotate("text",label=pstat,x=1.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.15)
    }
    
    OXp = filt.AO.sig #ALS vs OND
    tmpindex4 = which(rownames(OXp) == PlotGene[i])
    OXp = OXp$padj[tmpindex4]
    OXp = formatC(OXp,format = "e",digits = 2)
    if(OXp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.25),size=0.8)
      p = p+geom_segment(aes(x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=2,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.20),size=0.8)
      p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.25,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.20),size=0.8)
      pstat = paste("FDR p-value:",OXp)
      p = p+annotate("text",label=pstat,x=2.5,y=max(LogPlotCounts)+max(LogPlotCounts)*0.3)
    }
    
    ALSp = filt.AC.sig #HC vs ALS
    tmpindex2 = which(rownames(ALSp) == PlotGene[i])
    ALSp = ALSp$padj[tmpindex2]
    ALSp = formatC(ALSp,format = "e",digits = 2)
    if(ALSp>""){
      p = p+ylim(lowerlim,upperlim)
      p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.4,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.40),size=0.8)
      p = p+geom_segment(aes(x=1,y=max(LogPlotCounts)+max(LogPlotCounts)*0.4,xend=1,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.35),size=0.8)
      p = p+geom_segment(aes(x=3,y=max(LogPlotCounts)+max(LogPlotCounts)*0.4,xend=3,yend=max(LogPlotCounts)+max(LogPlotCounts)*0.35),size=0.8)
      pstat = paste("FDR p-value:",ALSp)
      p = p+annotate("text",label=pstat,x=2,y=max(LogPlotCounts)+max(LogPlotCounts)*0.45)
    }
    
  }
    
  
    
  print(p)  
}
